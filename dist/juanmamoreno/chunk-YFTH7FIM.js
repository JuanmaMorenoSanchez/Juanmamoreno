import{$ as qp,A as Ap,B as Pc,C as Rc,D as jr,E as Li,F as Cp,G as Np,H as Js,I as Tt,J as Yt,K as ze,L as Ys,M as Lp,N as Xs,O as bn,P as Dp,Q as Fp,R as jp,S as Oc,T as Di,V,W as Ze,X as gr,Y as Fi,Z as Xt,_ as qr,a as mx,aa as Mp,b as dp,ba as Up,c as gp,ca as zp,d as yp,da as $p,e as ks,ea as Hp,f as Ni,fa as Qs,g as wn,ga as Vp,h as vp,ha as Bp,i as mp,ia as kp,j as Ks,ja as ht,k as _p,ka as Kp,l as Gs,la as Gp,m as wp,ma as Wp,n as bp,na as Jp,o as Fr,oa as Tc,p as Ep,pa as Yp,q as xp,qa as Xp,r as Ip,ra as Ac,s as Ic,sa as Qp,t as Sp,ta as Cc,u as Pp,ua as Zp,v as Sc,va as En,w as Rp,x as Op,y as Ws,z as Tp}from"./chunk-JEKVK6EJ.js";import{a as ut,f as Ci,g as Pe,h as ii,i as Ot,j as Ue,k as dr,l as m}from"./chunk-M2AMYXAA.js";var Qt=Pe((IT,Nc)=>{"use strict";var ji=typeof Reflect=="object"?Reflect:null,ed=ji&&typeof ji.apply=="function"?ji.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)},Zs;ji&&typeof ji.ownKeys=="function"?Zs=ji.ownKeys:Object.getOwnPropertySymbols?Zs=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Zs=function(t){return Object.getOwnPropertyNames(t)};function _x(s){console&&console.warn&&console.warn(s)}var rd=Number.isNaN||function(t){return t!==t};function be(){be.init.call(this)}Nc.exports=be;Nc.exports.once=xx;be.EventEmitter=be;be.prototype._events=void 0;be.prototype._eventsCount=0;be.prototype._maxListeners=void 0;var td=10;function eo(s){if(typeof s!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof s)}Object.defineProperty(be,"defaultMaxListeners",{enumerable:!0,get:function(){return td},set:function(s){if(typeof s!="number"||s<0||rd(s))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+s+".");td=s}});be.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};be.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||rd(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function id(s){return s._maxListeners===void 0?be.defaultMaxListeners:s._maxListeners}be.prototype.getMaxListeners=function(){return id(this)};be.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var o=t==="error",c=this._events;if(c!==void 0)o=o&&c.error===void 0;else if(!o)return!1;if(o){var h;if(e.length>0&&(h=e[0]),h instanceof Error)throw h;var f=new Error("Unhandled error."+(h?" ("+h.message+")":""));throw f.context=h,f}var y=c[t];if(y===void 0)return!1;if(typeof y=="function")ed(y,this,e);else for(var d=y.length,w=cd(y,d),i=0;i<d;++i)ed(w[i],this,e);return!0};function nd(s,t,e,i){var o,c,h;if(eo(e),c=s._events,c===void 0?(c=s._events=Object.create(null),s._eventsCount=0):(c.newListener!==void 0&&(s.emit("newListener",t,e.listener?e.listener:e),c=s._events),h=c[t]),h===void 0)h=c[t]=e,++s._eventsCount;else if(typeof h=="function"?h=c[t]=i?[e,h]:[h,e]:i?h.unshift(e):h.push(e),o=id(s),o>0&&h.length>o&&!h.warned){h.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+h.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=s,f.type=t,f.count=h.length,_x(f)}return s}be.prototype.addListener=function(t,e){return nd(this,t,e,!1)};be.prototype.on=be.prototype.addListener;be.prototype.prependListener=function(t,e){return nd(this,t,e,!0)};function wx(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function sd(s,t,e){var i={fired:!1,wrapFn:void 0,target:s,type:t,listener:e},o=wx.bind(i);return o.listener=e,i.wrapFn=o,o}be.prototype.once=function(t,e){return eo(e),this.on(t,sd(this,t,e)),this};be.prototype.prependOnceListener=function(t,e){return eo(e),this.prependListener(t,sd(this,t,e)),this};be.prototype.removeListener=function(t,e){var i,o,c,h,f;if(eo(e),o=this._events,o===void 0)return this;if(i=o[t],i===void 0)return this;if(i===e||i.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete o[t],o.removeListener&&this.emit("removeListener",t,i.listener||e));else if(typeof i!="function"){for(c=-1,h=i.length-1;h>=0;h--)if(i[h]===e||i[h].listener===e){f=i[h].listener,c=h;break}if(c<0)return this;c===0?i.shift():bx(i,c),i.length===1&&(o[t]=i[0]),o.removeListener!==void 0&&this.emit("removeListener",t,f||e)}return this};be.prototype.off=be.prototype.removeListener;be.prototype.removeAllListeners=function(t){var e,i,o;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[t]),this;if(arguments.length===0){var c=Object.keys(i),h;for(o=0;o<c.length;++o)h=c[o],h!=="removeListener"&&this.removeAllListeners(h);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=i[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(o=e.length-1;o>=0;o--)this.removeListener(t,e[o]);return this};function od(s,t,e){var i=s._events;if(i===void 0)return[];var o=i[t];return o===void 0?[]:typeof o=="function"?e?[o.listener||o]:[o]:e?Ex(o):cd(o,o.length)}be.prototype.listeners=function(t){return od(this,t,!0)};be.prototype.rawListeners=function(t){return od(this,t,!1)};be.listenerCount=function(s,t){return typeof s.listenerCount=="function"?s.listenerCount(t):ad.call(s,t)};be.prototype.listenerCount=ad;function ad(s){var t=this._events;if(t!==void 0){var e=t[s];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}be.prototype.eventNames=function(){return this._eventsCount>0?Zs(this._events):[]};function cd(s,t){for(var e=new Array(t),i=0;i<t;++i)e[i]=s[i];return e}function bx(s,t){for(;t+1<s.length;t++)s[t]=s[t+1];s.pop()}function Ex(s){for(var t=new Array(s.length),e=0;e<t.length;++e)t[e]=s[e].listener||s[e];return t}function xx(s,t){return new Promise(function(e,i){function o(h){s.removeListener(t,c),i(h)}function c(){typeof s.removeListener=="function"&&s.removeListener("error",o),e([].slice.call(arguments))}ud(s,t,c,{once:!0}),t!=="error"&&Ix(s,o,{once:!0})})}function Ix(s,t,e){typeof s.on=="function"&&ud(s,"error",t,e)}function ud(s,t,e,i){if(typeof s.on=="function")i.once?s.once(t,e):s.on(t,e);else if(typeof s.addEventListener=="function")s.addEventListener(t,function o(c){i.once&&s.removeEventListener(t,o),e(c)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof s)}});var jc={};ii(jc,{__assign:()=>Dc,__asyncDelegator:()=>qx,__asyncGenerator:()=>jx,__asyncValues:()=>Mx,__await:()=>xn,__awaiter:()=>Ax,__classPrivateFieldGet:()=>Hx,__classPrivateFieldSet:()=>Vx,__createBinding:()=>Nx,__decorate:()=>Rx,__exportStar:()=>Lx,__extends:()=>Sx,__generator:()=>Cx,__importDefault:()=>$x,__importStar:()=>zx,__makeTemplateObject:()=>Ux,__metadata:()=>Tx,__param:()=>Ox,__read:()=>hd,__rest:()=>Px,__spread:()=>Dx,__spreadArrays:()=>Fx,__values:()=>Fc});function Sx(s,t){Lc(s,t);function e(){this.constructor=s}s.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Px(s,t){var e={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&t.indexOf(i)<0&&(e[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(s);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(s,i[o])&&(e[i[o]]=s[i[o]]);return e}function Rx(s,t,e,i){var o=arguments.length,c=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,t,e,i);else for(var f=s.length-1;f>=0;f--)(h=s[f])&&(c=(o<3?h(c):o>3?h(t,e,c):h(t,e))||c);return o>3&&c&&Object.defineProperty(t,e,c),c}function Ox(s,t){return function(e,i){t(e,i,s)}}function Tx(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}function Ax(s,t,e,i){function o(c){return c instanceof e?c:new e(function(h){h(c)})}return new(e||(e=Promise))(function(c,h){function f(w){try{d(i.next(w))}catch(S){h(S)}}function y(w){try{d(i.throw(w))}catch(S){h(S)}}function d(w){w.done?c(w.value):o(w.value).then(f,y)}d((i=i.apply(s,t||[])).next())})}function Cx(s,t){var e={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,h;return h={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function f(d){return function(w){return y([d,w])}}function y(d){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,o&&(c=d[0]&2?o.return:d[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,d[1])).done)return c;switch(o=0,c&&(d=[d[0]&2,c.value]),d[0]){case 0:case 1:c=d;break;case 4:return e.label++,{value:d[1],done:!1};case 5:e.label++,o=d[1],d=[0];continue;case 7:d=e.ops.pop(),e.trys.pop();continue;default:if(c=e.trys,!(c=c.length>0&&c[c.length-1])&&(d[0]===6||d[0]===2)){e=0;continue}if(d[0]===3&&(!c||d[1]>c[0]&&d[1]<c[3])){e.label=d[1];break}if(d[0]===6&&e.label<c[1]){e.label=c[1],c=d;break}if(c&&e.label<c[2]){e.label=c[2],e.ops.push(d);break}c[2]&&e.ops.pop(),e.trys.pop();continue}d=t.call(s,e)}catch(w){d=[6,w],o=0}finally{i=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function Nx(s,t,e,i){i===void 0&&(i=e),s[i]=t[e]}function Lx(s,t){for(var e in s)e!=="default"&&!t.hasOwnProperty(e)&&(t[e]=s[e])}function Fc(s){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&s[t],i=0;if(e)return e.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&i>=s.length&&(s=void 0),{value:s&&s[i++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function hd(s,t){var e=typeof Symbol=="function"&&s[Symbol.iterator];if(!e)return s;var i=e.call(s),o,c=[],h;try{for(;(t===void 0||t-- >0)&&!(o=i.next()).done;)c.push(o.value)}catch(f){h={error:f}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(h)throw h.error}}return c}function Dx(){for(var s=[],t=0;t<arguments.length;t++)s=s.concat(hd(arguments[t]));return s}function Fx(){for(var s=0,t=0,e=arguments.length;t<e;t++)s+=arguments[t].length;for(var i=Array(s),o=0,t=0;t<e;t++)for(var c=arguments[t],h=0,f=c.length;h<f;h++,o++)i[o]=c[h];return i}function xn(s){return this instanceof xn?(this.v=s,this):new xn(s)}function jx(s,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=e.apply(s,t||[]),o,c=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(x){i[x]&&(o[x]=function(T){return new Promise(function(A,z){c.push([x,T,A,z])>1||f(x,T)})})}function f(x,T){try{y(i[x](T))}catch(A){S(c[0][3],A)}}function y(x){x.value instanceof xn?Promise.resolve(x.value.v).then(d,w):S(c[0][2],x)}function d(x){f("next",x)}function w(x){f("throw",x)}function S(x,T){x(T),c.shift(),c.length&&f(c[0][0],c[0][1])}}function qx(s){var t,e;return t={},i("next"),i("throw",function(o){throw o}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(o,c){t[o]=s[o]?function(h){return(e=!e)?{value:xn(s[o](h)),done:o==="return"}:c?c(h):h}:c}}function Mx(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=s[Symbol.asyncIterator],e;return t?t.call(s):(s=typeof Fc=="function"?Fc(s):s[Symbol.iterator](),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(c){e[c]=s[c]&&function(h){return new Promise(function(f,y){h=s[c](h),o(f,y,h.done,h.value)})}}function o(c,h,f,y){Promise.resolve(y).then(function(d){c({value:d,done:f})},h)}}function Ux(s,t){return Object.defineProperty?Object.defineProperty(s,"raw",{value:t}):s.raw=t,s}function zx(s){if(s&&s.__esModule)return s;var t={};if(s!=null)for(var e in s)Object.hasOwnProperty.call(s,e)&&(t[e]=s[e]);return t.default=s,t}function $x(s){return s&&s.__esModule?s:{default:s}}function Hx(s,t){if(!t.has(s))throw new TypeError("attempted to get private field on non-instance");return t.get(s)}function Vx(s,t,e){if(!t.has(s))throw new TypeError("attempted to set private field on non-instance");return t.set(s,e),e}var Lc,Dc,qc=Ci(()=>{"use strict";Lc=function(s,t){return Lc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var o in i)i.hasOwnProperty(o)&&(e[o]=i[o])},Lc(s,t)};Dc=function(){return Dc=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++){e=arguments[i];for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&(t[c]=e[c])}return t},Dc.apply(this,arguments)}});var Mc=Pe(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});function Bx(s){if(typeof s!="string")throw new Error(`Cannot safe json parse value of type ${typeof s}`);try{return JSON.parse(s)}catch{return s}}to.safeJsonParse=Bx;function kx(s){return typeof s=="string"?s:JSON.stringify(s,(t,e)=>typeof e>"u"?null:e)}to.safeJsonStringify=kx});var ld=Pe((PT,ro)=>{"use strict";(function(){"use strict";let s;function t(){}s=t,s.prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},s.prototype.setItem=function(e,i){this[e]=String(i)},s.prototype.removeItem=function(e){delete this[e]},s.prototype.clear=function(){let e=this;Object.keys(e).forEach(function(i){e[i]=void 0,delete e[i]})},s.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},s.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof global<"u"&&global.localStorage?ro.exports=global.localStorage:typeof window<"u"&&window.localStorage?ro.exports=window.localStorage:ro.exports=new t})()});var fd=Pe(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});io.IKeyValueStorage=void 0;var Uc=class{};io.IKeyValueStorage=Uc});var pd=Pe(no=>{"use strict";Object.defineProperty(no,"__esModule",{value:!0});no.parseEntry=void 0;var Kx=Mc();function Gx(s){var t;return[s[0],Kx.safeJsonParse((t=s[1])!==null&&t!==void 0?t:"")]}no.parseEntry=Gx});var gd=Pe(so=>{"use strict";Object.defineProperty(so,"__esModule",{value:!0});var dd=(qc(),dr(jc));dd.__exportStar(fd(),so);dd.__exportStar(pd(),so)});var vd=Pe(In=>{"use strict";Object.defineProperty(In,"__esModule",{value:!0});In.KeyValueStorage=void 0;var qi=(qc(),dr(jc)),yd=Mc(),Wx=qi.__importDefault(ld()),Jx=gd(),oo=class{constructor(){this.localStorage=Wx.default}getKeys(){return qi.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return qi.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Jx.parseEntry)})}getItem(t){return qi.__awaiter(this,void 0,void 0,function*(){let e=this.localStorage.getItem(t);if(e!==null)return yd.safeJsonParse(e)})}setItem(t,e){return qi.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,yd.safeJsonStringify(e))})}removeItem(t){return qi.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}};In.KeyValueStorage=oo;In.default=oo});var Pn={};ii(Pn,{__assign:()=>$c,__asyncDelegator:()=>cI,__asyncGenerator:()=>aI,__asyncValues:()=>uI,__await:()=>Sn,__awaiter:()=>tI,__classPrivateFieldGet:()=>pI,__classPrivateFieldSet:()=>dI,__createBinding:()=>iI,__decorate:()=>Qx,__exportStar:()=>nI,__extends:()=>Yx,__generator:()=>rI,__importDefault:()=>fI,__importStar:()=>lI,__makeTemplateObject:()=>hI,__metadata:()=>eI,__param:()=>Zx,__read:()=>md,__rest:()=>Xx,__spread:()=>sI,__spreadArrays:()=>oI,__values:()=>Hc});function Yx(s,t){zc(s,t);function e(){this.constructor=s}s.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Xx(s,t){var e={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&t.indexOf(i)<0&&(e[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(s);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(s,i[o])&&(e[i[o]]=s[i[o]]);return e}function Qx(s,t,e,i){var o=arguments.length,c=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,t,e,i);else for(var f=s.length-1;f>=0;f--)(h=s[f])&&(c=(o<3?h(c):o>3?h(t,e,c):h(t,e))||c);return o>3&&c&&Object.defineProperty(t,e,c),c}function Zx(s,t){return function(e,i){t(e,i,s)}}function eI(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}function tI(s,t,e,i){function o(c){return c instanceof e?c:new e(function(h){h(c)})}return new(e||(e=Promise))(function(c,h){function f(w){try{d(i.next(w))}catch(S){h(S)}}function y(w){try{d(i.throw(w))}catch(S){h(S)}}function d(w){w.done?c(w.value):o(w.value).then(f,y)}d((i=i.apply(s,t||[])).next())})}function rI(s,t){var e={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,h;return h={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function f(d){return function(w){return y([d,w])}}function y(d){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,o&&(c=d[0]&2?o.return:d[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,d[1])).done)return c;switch(o=0,c&&(d=[d[0]&2,c.value]),d[0]){case 0:case 1:c=d;break;case 4:return e.label++,{value:d[1],done:!1};case 5:e.label++,o=d[1],d=[0];continue;case 7:d=e.ops.pop(),e.trys.pop();continue;default:if(c=e.trys,!(c=c.length>0&&c[c.length-1])&&(d[0]===6||d[0]===2)){e=0;continue}if(d[0]===3&&(!c||d[1]>c[0]&&d[1]<c[3])){e.label=d[1];break}if(d[0]===6&&e.label<c[1]){e.label=c[1],c=d;break}if(c&&e.label<c[2]){e.label=c[2],e.ops.push(d);break}c[2]&&e.ops.pop(),e.trys.pop();continue}d=t.call(s,e)}catch(w){d=[6,w],o=0}finally{i=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function iI(s,t,e,i){i===void 0&&(i=e),s[i]=t[e]}function nI(s,t){for(var e in s)e!=="default"&&!t.hasOwnProperty(e)&&(t[e]=s[e])}function Hc(s){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&s[t],i=0;if(e)return e.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&i>=s.length&&(s=void 0),{value:s&&s[i++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function md(s,t){var e=typeof Symbol=="function"&&s[Symbol.iterator];if(!e)return s;var i=e.call(s),o,c=[],h;try{for(;(t===void 0||t-- >0)&&!(o=i.next()).done;)c.push(o.value)}catch(f){h={error:f}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(h)throw h.error}}return c}function sI(){for(var s=[],t=0;t<arguments.length;t++)s=s.concat(md(arguments[t]));return s}function oI(){for(var s=0,t=0,e=arguments.length;t<e;t++)s+=arguments[t].length;for(var i=Array(s),o=0,t=0;t<e;t++)for(var c=arguments[t],h=0,f=c.length;h<f;h++,o++)i[o]=c[h];return i}function Sn(s){return this instanceof Sn?(this.v=s,this):new Sn(s)}function aI(s,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=e.apply(s,t||[]),o,c=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(x){i[x]&&(o[x]=function(T){return new Promise(function(A,z){c.push([x,T,A,z])>1||f(x,T)})})}function f(x,T){try{y(i[x](T))}catch(A){S(c[0][3],A)}}function y(x){x.value instanceof Sn?Promise.resolve(x.value.v).then(d,w):S(c[0][2],x)}function d(x){f("next",x)}function w(x){f("throw",x)}function S(x,T){x(T),c.shift(),c.length&&f(c[0][0],c[0][1])}}function cI(s){var t,e;return t={},i("next"),i("throw",function(o){throw o}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(o,c){t[o]=s[o]?function(h){return(e=!e)?{value:Sn(s[o](h)),done:o==="return"}:c?c(h):h}:c}}function uI(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=s[Symbol.asyncIterator],e;return t?t.call(s):(s=typeof Hc=="function"?Hc(s):s[Symbol.iterator](),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(c){e[c]=s[c]&&function(h){return new Promise(function(f,y){h=s[c](h),o(f,y,h.done,h.value)})}}function o(c,h,f,y){Promise.resolve(y).then(function(d){c({value:d,done:f})},h)}}function hI(s,t){return Object.defineProperty?Object.defineProperty(s,"raw",{value:t}):s.raw=t,s}function lI(s){if(s&&s.__esModule)return s;var t={};if(s!=null)for(var e in s)Object.hasOwnProperty.call(s,e)&&(t[e]=s[e]);return t.default=s,t}function fI(s){return s&&s.__esModule?s:{default:s}}function pI(s,t){if(!t.has(s))throw new TypeError("attempted to get private field on non-instance");return t.get(s)}function dI(s,t,e){if(!t.has(s))throw new TypeError("attempted to set private field on non-instance");return t.set(s,e),e}var zc,$c,Rn=Ci(()=>{"use strict";zc=function(s,t){return zc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var o in i)i.hasOwnProperty(o)&&(e[o]=i[o])},zc(s,t)};$c=function(){return $c=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++){e=arguments[i];for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&(t[c]=e[c])}return t},$c.apply(this,arguments)}});var Zt,_d=Ci(()=>{"use strict";Zt=class{}});var wd={};ii(wd,{IEvents:()=>Zt});var Vc=Ci(()=>{"use strict";_d()});var bd=Pe(ao=>{"use strict";Object.defineProperty(ao,"__esModule",{value:!0});ao.IHeartBeat=void 0;var gI=(Vc(),dr(wd)),Bc=class extends gI.IEvents{constructor(t){super()}};ao.IHeartBeat=Bc});var Kc=Pe(kc=>{"use strict";Object.defineProperty(kc,"__esModule",{value:!0});var yI=(Rn(),dr(Pn));yI.__exportStar(bd(),kc)});var Ed=Pe(Mi=>{"use strict";Object.defineProperty(Mi,"__esModule",{value:!0});Mi.HEARTBEAT_EVENTS=Mi.HEARTBEAT_INTERVAL=void 0;var vI=wn();Mi.HEARTBEAT_INTERVAL=vI.FIVE_SECONDS;Mi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"}});var Wc=Pe(Gc=>{"use strict";Object.defineProperty(Gc,"__esModule",{value:!0});var mI=(Rn(),dr(Pn));mI.__exportStar(Ed(),Gc)});var xd=Pe(co=>{"use strict";Object.defineProperty(co,"__esModule",{value:!0});co.HeartBeat=void 0;var Jc=(Rn(),dr(Pn)),_I=Qt(),wI=wn(),bI=Kc(),Yc=Wc(),Xc=class s extends bI.IHeartBeat{constructor(t){super(t),this.events=new _I.EventEmitter,this.interval=Yc.HEARTBEAT_INTERVAL,this.interval=t?.interval||Yc.HEARTBEAT_INTERVAL}static init(t){return Jc.__awaiter(this,void 0,void 0,function*(){let e=new s(t);return yield e.init(),e})}init(){return Jc.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}initialize(){return Jc.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),wI.toMiliseconds(this.interval))})}pulse(){this.events.emit(Yc.HEARTBEAT_EVENTS.pulse)}};co.HeartBeat=Xc});var Id=Pe(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:!0});var Qc=(Rn(),dr(Pn));Qc.__exportStar(xd(),On);Qc.__exportStar(Kc(),On);Qc.__exportStar(Wc(),On)});var Pd={};ii(Pd,{__assign:()=>eu,__asyncDelegator:()=>DI,__asyncGenerator:()=>LI,__asyncValues:()=>FI,__await:()=>Tn,__awaiter:()=>RI,__classPrivateFieldGet:()=>UI,__classPrivateFieldSet:()=>zI,__createBinding:()=>TI,__decorate:()=>II,__exportStar:()=>AI,__extends:()=>EI,__generator:()=>OI,__importDefault:()=>MI,__importStar:()=>qI,__makeTemplateObject:()=>jI,__metadata:()=>PI,__param:()=>SI,__read:()=>Sd,__rest:()=>xI,__spread:()=>CI,__spreadArrays:()=>NI,__values:()=>tu});function EI(s,t){Zc(s,t);function e(){this.constructor=s}s.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function xI(s,t){var e={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&t.indexOf(i)<0&&(e[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(s);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(s,i[o])&&(e[i[o]]=s[i[o]]);return e}function II(s,t,e,i){var o=arguments.length,c=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,t,e,i);else for(var f=s.length-1;f>=0;f--)(h=s[f])&&(c=(o<3?h(c):o>3?h(t,e,c):h(t,e))||c);return o>3&&c&&Object.defineProperty(t,e,c),c}function SI(s,t){return function(e,i){t(e,i,s)}}function PI(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}function RI(s,t,e,i){function o(c){return c instanceof e?c:new e(function(h){h(c)})}return new(e||(e=Promise))(function(c,h){function f(w){try{d(i.next(w))}catch(S){h(S)}}function y(w){try{d(i.throw(w))}catch(S){h(S)}}function d(w){w.done?c(w.value):o(w.value).then(f,y)}d((i=i.apply(s,t||[])).next())})}function OI(s,t){var e={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,h;return h={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function f(d){return function(w){return y([d,w])}}function y(d){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,o&&(c=d[0]&2?o.return:d[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,d[1])).done)return c;switch(o=0,c&&(d=[d[0]&2,c.value]),d[0]){case 0:case 1:c=d;break;case 4:return e.label++,{value:d[1],done:!1};case 5:e.label++,o=d[1],d=[0];continue;case 7:d=e.ops.pop(),e.trys.pop();continue;default:if(c=e.trys,!(c=c.length>0&&c[c.length-1])&&(d[0]===6||d[0]===2)){e=0;continue}if(d[0]===3&&(!c||d[1]>c[0]&&d[1]<c[3])){e.label=d[1];break}if(d[0]===6&&e.label<c[1]){e.label=c[1],c=d;break}if(c&&e.label<c[2]){e.label=c[2],e.ops.push(d);break}c[2]&&e.ops.pop(),e.trys.pop();continue}d=t.call(s,e)}catch(w){d=[6,w],o=0}finally{i=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function TI(s,t,e,i){i===void 0&&(i=e),s[i]=t[e]}function AI(s,t){for(var e in s)e!=="default"&&!t.hasOwnProperty(e)&&(t[e]=s[e])}function tu(s){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&s[t],i=0;if(e)return e.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&i>=s.length&&(s=void 0),{value:s&&s[i++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Sd(s,t){var e=typeof Symbol=="function"&&s[Symbol.iterator];if(!e)return s;var i=e.call(s),o,c=[],h;try{for(;(t===void 0||t-- >0)&&!(o=i.next()).done;)c.push(o.value)}catch(f){h={error:f}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(h)throw h.error}}return c}function CI(){for(var s=[],t=0;t<arguments.length;t++)s=s.concat(Sd(arguments[t]));return s}function NI(){for(var s=0,t=0,e=arguments.length;t<e;t++)s+=arguments[t].length;for(var i=Array(s),o=0,t=0;t<e;t++)for(var c=arguments[t],h=0,f=c.length;h<f;h++,o++)i[o]=c[h];return i}function Tn(s){return this instanceof Tn?(this.v=s,this):new Tn(s)}function LI(s,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=e.apply(s,t||[]),o,c=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(x){i[x]&&(o[x]=function(T){return new Promise(function(A,z){c.push([x,T,A,z])>1||f(x,T)})})}function f(x,T){try{y(i[x](T))}catch(A){S(c[0][3],A)}}function y(x){x.value instanceof Tn?Promise.resolve(x.value.v).then(d,w):S(c[0][2],x)}function d(x){f("next",x)}function w(x){f("throw",x)}function S(x,T){x(T),c.shift(),c.length&&f(c[0][0],c[0][1])}}function DI(s){var t,e;return t={},i("next"),i("throw",function(o){throw o}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(o,c){t[o]=s[o]?function(h){return(e=!e)?{value:Tn(s[o](h)),done:o==="return"}:c?c(h):h}:c}}function FI(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=s[Symbol.asyncIterator],e;return t?t.call(s):(s=typeof tu=="function"?tu(s):s[Symbol.iterator](),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(c){e[c]=s[c]&&function(h){return new Promise(function(f,y){h=s[c](h),o(f,y,h.done,h.value)})}}function o(c,h,f,y){Promise.resolve(y).then(function(d){c({value:d,done:f})},h)}}function jI(s,t){return Object.defineProperty?Object.defineProperty(s,"raw",{value:t}):s.raw=t,s}function qI(s){if(s&&s.__esModule)return s;var t={};if(s!=null)for(var e in s)Object.hasOwnProperty.call(s,e)&&(t[e]=s[e]);return t.default=s,t}function MI(s){return s&&s.__esModule?s:{default:s}}function UI(s,t){if(!t.has(s))throw new TypeError("attempted to get private field on non-instance");return t.get(s)}function zI(s,t,e){if(!t.has(s))throw new TypeError("attempted to set private field on non-instance");return t.set(s,e),e}var Zc,eu,Rd=Ci(()=>{"use strict";Zc=function(s,t){return Zc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var o in i)i.hasOwnProperty(o)&&(e[o]=i[o])},Zc(s,t)};eu=function(){return eu=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++){e=arguments[i];for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&(t[c]=e[c])}return t},eu.apply(this,arguments)}});var Td=Pe((UT,Od)=>{"use strict";function $I(s){try{return JSON.stringify(s)}catch{return'"[Circular]"'}}Od.exports=HI;function HI(s,t,e){var i=e&&e.stringify||$I,o=1;if(typeof s=="object"&&s!==null){var c=t.length+o;if(c===1)return s;var h=new Array(c);h[0]=i(s);for(var f=1;f<c;f++)h[f]=i(t[f]);return h.join(" ")}if(typeof s!="string")return s;var y=t.length;if(y===0)return s;for(var d="",w=1-o,S=-1,x=s&&s.length||0,T=0;T<x;){if(s.charCodeAt(T)===37&&T+1<x){switch(S=S>-1?S:0,s.charCodeAt(T+1)){case 100:case 102:if(w>=y||t[w]==null)break;S<T&&(d+=s.slice(S,T)),d+=Number(t[w]),S=T+2,T++;break;case 105:if(w>=y||t[w]==null)break;S<T&&(d+=s.slice(S,T)),d+=Math.floor(Number(t[w])),S=T+2,T++;break;case 79:case 111:case 106:if(w>=y||t[w]===void 0)break;S<T&&(d+=s.slice(S,T));var A=typeof t[w];if(A==="string"){d+="'"+t[w]+"'",S=T+2,T++;break}if(A==="function"){d+=t[w].name||"<anonymous>",S=T+2,T++;break}d+=i(t[w]),S=T+2,T++;break;case 115:if(w>=y)break;S<T&&(d+=s.slice(S,T)),d+=String(t[w]),S=T+2,T++;break;case 37:S<T&&(d+=s.slice(S,T)),d+="%",S=T+2,T++,w--;break}++w}++T}return S===-1?s:(S<x&&(d+=s.slice(S)),d)}});var Dd=Pe((zT,Ld)=>{"use strict";var Ad=Td();Ld.exports=er;var An=QI().console||{},VI={mapHttpRequest:uo,mapHttpResponse:uo,wrapRequestSerializer:ru,wrapResponseSerializer:ru,wrapErrorSerializer:ru,req:uo,res:uo,err:WI};function BI(s,t){return Array.isArray(s)?s.filter(function(i){return i!=="!stdSerializers.err"}):s===!0?Object.keys(t):!1}function er(s){s=s||{},s.browser=s.browser||{};let t=s.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");let e=s.browser.write||An;s.browser.write&&(s.browser.asObject=!0);let i=s.serializers||{},o=BI(s.browser.serialize,i),c=s.browser.serialize;Array.isArray(s.browser.serialize)&&s.browser.serialize.indexOf("!stdSerializers.err")>-1&&(c=!1);let h=["error","fatal","warn","info","debug","trace"];typeof e=="function"&&(e.error=e.fatal=e.warn=e.info=e.debug=e.trace=e),s.enabled===!1&&(s.level="silent");let f=s.level||"info",y=Object.create(e);y.log||(y.log=Cn),Object.defineProperty(y,"levelVal",{get:w}),Object.defineProperty(y,"level",{get:S,set:x});let d={transmit:t,serialize:o,asObject:s.browser.asObject,levels:h,timestamp:JI(s)};y.levels=er.levels,y.level=f,y.setMaxListeners=y.getMaxListeners=y.emit=y.addListener=y.on=y.prependListener=y.once=y.prependOnceListener=y.removeListener=y.removeAllListeners=y.listeners=y.listenerCount=y.eventNames=y.write=y.flush=Cn,y.serializers=i,y._serialize=o,y._stdErrSerialize=c,y.child=T,t&&(y._logEvent=iu());function w(){return this.level==="silent"?1/0:this.levels.values[this.level]}function S(){return this._level}function x(A){if(A!=="silent"&&!this.levels.values[A])throw Error("unknown level "+A);this._level=A,Ui(d,y,"error","log"),Ui(d,y,"fatal","error"),Ui(d,y,"warn","error"),Ui(d,y,"info","log"),Ui(d,y,"debug","log"),Ui(d,y,"trace","log")}function T(A,z){if(!A)throw new Error("missing bindings for child Pino");z=z||{},o&&A.serializers&&(z.serializers=A.serializers);let K=z.serializers;if(o&&K){var B=Object.assign({},i,K),Z=s.browser.serialize===!0?Object.keys(B):o;delete A.serializers,ho([A],Z,B,this._stdErrSerialize)}function H(U){this._childLevel=(U._childLevel|0)+1,this.error=zi(U,A,"error"),this.fatal=zi(U,A,"fatal"),this.warn=zi(U,A,"warn"),this.info=zi(U,A,"info"),this.debug=zi(U,A,"debug"),this.trace=zi(U,A,"trace"),B&&(this.serializers=B,this._serialize=Z),t&&(this._logEvent=iu([].concat(U._logEvent.bindings,A)))}return H.prototype=this,new H(this)}return y}er.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};er.stdSerializers=VI;er.stdTimeFunctions=Object.assign({},{nullTime:Cd,epochTime:Nd,unixTime:YI,isoTime:XI});function Ui(s,t,e,i){let o=Object.getPrototypeOf(t);t[e]=t.levelVal>t.levels.values[e]?Cn:o[e]?o[e]:An[e]||An[i]||Cn,kI(s,t,e)}function kI(s,t,e){!s.transmit&&t[e]===Cn||(t[e]=function(i){return function(){let c=s.timestamp(),h=new Array(arguments.length),f=Object.getPrototypeOf&&Object.getPrototypeOf(this)===An?An:this;for(var y=0;y<h.length;y++)h[y]=arguments[y];if(s.serialize&&!s.asObject&&ho(h,this._serialize,this.serializers,this._stdErrSerialize),s.asObject?i.call(f,KI(this,e,h,c)):i.apply(f,h),s.transmit){let d=s.transmit.level||t.level,w=er.levels.values[d],S=er.levels.values[e];if(S<w)return;GI(this,{ts:c,methodLevel:e,methodValue:S,transmitLevel:d,transmitValue:er.levels.values[s.transmit.level||t.level],send:s.transmit.send,val:t.levelVal},h)}}}(t[e]))}function KI(s,t,e,i){s._serialize&&ho(e,s._serialize,s.serializers,s._stdErrSerialize);let o=e.slice(),c=o[0],h={};i&&(h.time=i),h.level=er.levels.values[t];let f=(s._childLevel|0)+1;if(f<1&&(f=1),c!==null&&typeof c=="object"){for(;f--&&typeof o[0]=="object";)Object.assign(h,o.shift());c=o.length?Ad(o.shift(),o):void 0}else typeof c=="string"&&(c=Ad(o.shift(),o));return c!==void 0&&(h.msg=c),h}function ho(s,t,e,i){for(let o in s)if(i&&s[o]instanceof Error)s[o]=er.stdSerializers.err(s[o]);else if(typeof s[o]=="object"&&!Array.isArray(s[o]))for(let c in s[o])t&&t.indexOf(c)>-1&&c in e&&(s[o][c]=e[c](s[o][c]))}function zi(s,t,e){return function(){let i=new Array(1+arguments.length);i[0]=t;for(var o=1;o<i.length;o++)i[o]=arguments[o-1];return s[e].apply(this,i)}}function GI(s,t,e){let i=t.send,o=t.ts,c=t.methodLevel,h=t.methodValue,f=t.val,y=s._logEvent.bindings;ho(e,s._serialize||Object.keys(s.serializers),s.serializers,s._stdErrSerialize===void 0?!0:s._stdErrSerialize),s._logEvent.ts=o,s._logEvent.messages=e.filter(function(d){return y.indexOf(d)===-1}),s._logEvent.level.label=c,s._logEvent.level.value=h,i(c,s._logEvent,f),s._logEvent=iu(y)}function iu(s){return{ts:0,messages:[],bindings:s||[],level:{label:"",value:0}}}function WI(s){let t={type:s.constructor.name,msg:s.message,stack:s.stack};for(let e in s)t[e]===void 0&&(t[e]=s[e]);return t}function JI(s){return typeof s.timestamp=="function"?s.timestamp:s.timestamp===!1?Cd:Nd}function uo(){return{}}function ru(s){return s}function Cn(){}function Cd(){return!1}function Nd(){return Date.now()}function YI(){return Math.round(Date.now()/1e3)}function XI(){return new Date(Date.now()).toISOString()}function QI(){function s(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return s(self)||s(window)||s(this)||{}}}});var nu=Pe($i=>{"use strict";Object.defineProperty($i,"__esModule",{value:!0});$i.PINO_CUSTOM_CONTEXT_KEY=$i.PINO_LOGGER_DEFAULTS=void 0;$i.PINO_LOGGER_DEFAULTS={level:"info"};$i.PINO_CUSTOM_CONTEXT_KEY="custom_context"});var Ud=Pe(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.generateChildLogger=wt.formatChildLoggerContext=wt.getLoggerContext=wt.setBrowserLoggerContext=wt.getBrowserLoggerContext=wt.getDefaultLoggerOptions=void 0;var Hi=nu();function ZI(s){return Object.assign(Object.assign({},s),{level:s?.level||Hi.PINO_LOGGER_DEFAULTS.level})}wt.getDefaultLoggerOptions=ZI;function Fd(s,t=Hi.PINO_CUSTOM_CONTEXT_KEY){return s[t]||""}wt.getBrowserLoggerContext=Fd;function jd(s,t,e=Hi.PINO_CUSTOM_CONTEXT_KEY){return s[e]=t,s}wt.setBrowserLoggerContext=jd;function qd(s,t=Hi.PINO_CUSTOM_CONTEXT_KEY){let e="";return typeof s.bindings>"u"?e=Fd(s,t):e=s.bindings().context||"",e}wt.getLoggerContext=qd;function Md(s,t,e=Hi.PINO_CUSTOM_CONTEXT_KEY){let i=qd(s,e);return i.trim()?`${i}/${t}`:t}wt.formatChildLoggerContext=Md;function eS(s,t,e=Hi.PINO_CUSTOM_CONTEXT_KEY){let i=Md(s,t,e),o=s.child({context:i});return jd(o,i,e)}wt.generateChildLogger=eS});var lo=Pe(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});Vi.pino=void 0;var su=(Rd(),dr(Pd)),tS=su.__importDefault(Dd());Object.defineProperty(Vi,"pino",{enumerable:!0,get:function(){return tS.default}});su.__exportStar(nu(),Vi);su.__exportStar(Ud(),Vi)});var Vd=Pe(vr=>{"use strict";Object.defineProperty(vr,"__esModule",{value:!0});var ki=mx(),Bi=dp();vr.DIGEST_LENGTH=64;vr.BLOCK_SIZE=128;var Hd=function(){function s(){this.digestLength=vr.DIGEST_LENGTH,this.blockSize=vr.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return s.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},s.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},s.prototype.clean=function(){Bi.wipe(this._buffer),Bi.wipe(this._tempHi),Bi.wipe(this._tempLo),this.reset()},s.prototype.update=function(t,e){if(e===void 0&&(e=t.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var i=0;if(this._bytesHashed+=e,this._bufferLength>0){for(;this._bufferLength<vr.BLOCK_SIZE&&e>0;)this._buffer[this._bufferLength++]=t[i++],e--;this._bufferLength===this.blockSize&&(ou(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(e>=this.blockSize&&(i=ou(this._tempHi,this._tempLo,this._stateHi,this._stateLo,t,i,e),e%=this.blockSize);e>0;)this._buffer[this._bufferLength++]=t[i++],e--;return this},s.prototype.finish=function(t){if(!this._finished){var e=this._bytesHashed,i=this._bufferLength,o=e/536870912|0,c=e<<3,h=e%128<112?128:256;this._buffer[i]=128;for(var f=i+1;f<h-8;f++)this._buffer[f]=0;ki.writeUint32BE(o,this._buffer,h-8),ki.writeUint32BE(c,this._buffer,h-4),ou(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,h),this._finished=!0}for(var f=0;f<this.digestLength/8;f++)ki.writeUint32BE(this._stateHi[f],t,f*8),ki.writeUint32BE(this._stateLo[f],t,f*8+4);return this},s.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},s.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},s.prototype.restoreState=function(t){return this._stateHi.set(t.stateHi),this._stateLo.set(t.stateLo),this._bufferLength=t.bufferLength,t.buffer&&this._buffer.set(t.buffer),this._bytesHashed=t.bytesHashed,this._finished=!1,this},s.prototype.cleanSavedState=function(t){Bi.wipe(t.stateHi),Bi.wipe(t.stateLo),t.buffer&&Bi.wipe(t.buffer),t.bufferLength=0,t.bytesHashed=0},s}();vr.SHA512=Hd;var $d=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function ou(s,t,e,i,o,c,h){for(var f=e[0],y=e[1],d=e[2],w=e[3],S=e[4],x=e[5],T=e[6],A=e[7],z=i[0],K=i[1],B=i[2],Z=i[3],H=i[4],U=i[5],ee=i[6],ne=i[7],O,N,re,I,P,L,q,M;h>=128;){for(var Y=0;Y<16;Y++){var _e=8*Y+c;s[Y]=ki.readUint32BE(o,_e),t[Y]=ki.readUint32BE(o,_e+4)}for(var Y=0;Y<80;Y++){var ke=f,et=y,gi=d,Re=w,ve=S,Ke=x,Ge=T,$e=A,Oe=z,De=K,We=B,Ie=Z,Ce=H,Je=U,Fe=ee,Ne=ne;if(O=A,N=ne,P=N&65535,L=N>>>16,q=O&65535,M=O>>>16,O=(S>>>14|H<<32-14)^(S>>>18|H<<32-18)^(H>>>41-32|S<<32-(41-32)),N=(H>>>14|S<<32-14)^(H>>>18|S<<32-18)^(S>>>41-32|H<<32-(41-32)),P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,O=S&x^~S&T,N=H&U^~H&ee,P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,O=$d[Y*2],N=$d[Y*2+1],P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,O=s[Y%16],N=t[Y%16],P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,L+=P>>>16,q+=L>>>16,M+=q>>>16,re=q&65535|M<<16,I=P&65535|L<<16,O=re,N=I,P=N&65535,L=N>>>16,q=O&65535,M=O>>>16,O=(f>>>28|z<<32-28)^(z>>>34-32|f<<32-(34-32))^(z>>>39-32|f<<32-(39-32)),N=(z>>>28|f<<32-28)^(f>>>34-32|z<<32-(34-32))^(f>>>39-32|z<<32-(39-32)),P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,O=f&y^f&d^y&d,N=z&K^z&B^K&B,P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,L+=P>>>16,q+=L>>>16,M+=q>>>16,$e=q&65535|M<<16,Ne=P&65535|L<<16,O=Re,N=Ie,P=N&65535,L=N>>>16,q=O&65535,M=O>>>16,O=re,N=I,P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,L+=P>>>16,q+=L>>>16,M+=q>>>16,Re=q&65535|M<<16,Ie=P&65535|L<<16,y=ke,d=et,w=gi,S=Re,x=ve,T=Ke,A=Ge,f=$e,K=Oe,B=De,Z=We,H=Ie,U=Ce,ee=Je,ne=Fe,z=Ne,Y%16===15)for(var _e=0;_e<16;_e++)O=s[_e],N=t[_e],P=N&65535,L=N>>>16,q=O&65535,M=O>>>16,O=s[(_e+9)%16],N=t[(_e+9)%16],P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,re=s[(_e+1)%16],I=t[(_e+1)%16],O=(re>>>1|I<<32-1)^(re>>>8|I<<32-8)^re>>>7,N=(I>>>1|re<<32-1)^(I>>>8|re<<32-8)^(I>>>7|re<<32-7),P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,re=s[(_e+14)%16],I=t[(_e+14)%16],O=(re>>>19|I<<32-19)^(I>>>61-32|re<<32-(61-32))^re>>>6,N=(I>>>19|re<<32-19)^(re>>>61-32|I<<32-(61-32))^(I>>>6|re<<32-6),P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,L+=P>>>16,q+=L>>>16,M+=q>>>16,s[_e]=q&65535|M<<16,t[_e]=P&65535|L<<16}O=f,N=z,P=N&65535,L=N>>>16,q=O&65535,M=O>>>16,O=e[0],N=i[0],P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,L+=P>>>16,q+=L>>>16,M+=q>>>16,e[0]=f=q&65535|M<<16,i[0]=z=P&65535|L<<16,O=y,N=K,P=N&65535,L=N>>>16,q=O&65535,M=O>>>16,O=e[1],N=i[1],P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,L+=P>>>16,q+=L>>>16,M+=q>>>16,e[1]=y=q&65535|M<<16,i[1]=K=P&65535|L<<16,O=d,N=B,P=N&65535,L=N>>>16,q=O&65535,M=O>>>16,O=e[2],N=i[2],P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,L+=P>>>16,q+=L>>>16,M+=q>>>16,e[2]=d=q&65535|M<<16,i[2]=B=P&65535|L<<16,O=w,N=Z,P=N&65535,L=N>>>16,q=O&65535,M=O>>>16,O=e[3],N=i[3],P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,L+=P>>>16,q+=L>>>16,M+=q>>>16,e[3]=w=q&65535|M<<16,i[3]=Z=P&65535|L<<16,O=S,N=H,P=N&65535,L=N>>>16,q=O&65535,M=O>>>16,O=e[4],N=i[4],P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,L+=P>>>16,q+=L>>>16,M+=q>>>16,e[4]=S=q&65535|M<<16,i[4]=H=P&65535|L<<16,O=x,N=U,P=N&65535,L=N>>>16,q=O&65535,M=O>>>16,O=e[5],N=i[5],P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,L+=P>>>16,q+=L>>>16,M+=q>>>16,e[5]=x=q&65535|M<<16,i[5]=U=P&65535|L<<16,O=T,N=ee,P=N&65535,L=N>>>16,q=O&65535,M=O>>>16,O=e[6],N=i[6],P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,L+=P>>>16,q+=L>>>16,M+=q>>>16,e[6]=T=q&65535|M<<16,i[6]=ee=P&65535|L<<16,O=A,N=ne,P=N&65535,L=N>>>16,q=O&65535,M=O>>>16,O=e[7],N=i[7],P+=N&65535,L+=N>>>16,q+=O&65535,M+=O>>>16,L+=P>>>16,q+=L>>>16,M+=q>>>16,e[7]=A=q&65535|M<<16,i[7]=ne=P&65535|L<<16,c+=128,h-=128}return c}function nS(s){var t=new Hd;t.update(s);var e=t.digest();return t.clean(),e}vr.hash=nS});var ig=Pe(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.convertSecretKeyToX25519=ye.convertPublicKeyToX25519=ye.verify=ye.sign=ye.extractPublicKeyFromSecretKey=ye.generateKeyPair=ye.generateKeyPairFromSeed=ye.SEED_LENGTH=ye.SECRET_KEY_LENGTH=ye.PUBLIC_KEY_LENGTH=ye.SIGNATURE_LENGTH=void 0;var sS=gp(),Nn=Vd(),Wd=dp();ye.SIGNATURE_LENGTH=64;ye.PUBLIC_KEY_LENGTH=32;ye.SECRET_KEY_LENGTH=64;ye.SEED_LENGTH=32;function W(s){let t=new Float64Array(16);if(s)for(let e=0;e<s.length;e++)t[e]=s[e];return t}var oS=new Uint8Array(32);oS[0]=9;var uu=W(),Ki=W([1]),aS=W([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),cS=W([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),Bd=W([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),kd=W([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),uS=W([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Mr(s,t){for(let e=0;e<16;e++)s[e]=t[e]|0}function au(s){let t=1;for(let e=0;e<16;e++){let i=s[e]+t+65535;t=Math.floor(i/65536),s[e]=i-t*65536}s[0]+=t-1+37*(t-1)}function Jd(s,t,e){let i=~(e-1);for(let o=0;o<16;o++){let c=i&(s[o]^t[o]);s[o]^=c,t[o]^=c}}function Ln(s,t){let e=W(),i=W();for(let o=0;o<16;o++)i[o]=t[o];au(i),au(i),au(i);for(let o=0;o<2;o++){e[0]=i[0]-65517;for(let h=1;h<15;h++)e[h]=i[h]-65535-(e[h-1]>>16&1),e[h-1]&=65535;e[15]=i[15]-32767-(e[14]>>16&1);let c=e[15]>>16&1;e[14]&=65535,Jd(i,e,1-c)}for(let o=0;o<16;o++)s[2*o]=i[o]&255,s[2*o+1]=i[o]>>8}function Yd(s,t){let e=0;for(let i=0;i<32;i++)e|=s[i]^t[i];return(1&e-1>>>8)-1}function Kd(s,t){let e=new Uint8Array(32),i=new Uint8Array(32);return Ln(e,s),Ln(i,t),Yd(e,i)}function Xd(s){let t=new Uint8Array(32);return Ln(t,s),t[0]&1}function hS(s,t){for(let e=0;e<16;e++)s[e]=t[2*e]+(t[2*e+1]<<8);s[15]&=32767}function si(s,t,e){for(let i=0;i<16;i++)s[i]=t[i]+e[i]}function ai(s,t,e){for(let i=0;i<16;i++)s[i]=t[i]-e[i]}function Ee(s,t,e){let i,o,c=0,h=0,f=0,y=0,d=0,w=0,S=0,x=0,T=0,A=0,z=0,K=0,B=0,Z=0,H=0,U=0,ee=0,ne=0,O=0,N=0,re=0,I=0,P=0,L=0,q=0,M=0,Y=0,_e=0,ke=0,et=0,gi=0,Re=e[0],ve=e[1],Ke=e[2],Ge=e[3],$e=e[4],Oe=e[5],De=e[6],We=e[7],Ie=e[8],Ce=e[9],Je=e[10],Fe=e[11],Ne=e[12],Ye=e[13],we=e[14],qe=e[15];i=t[0],c+=i*Re,h+=i*ve,f+=i*Ke,y+=i*Ge,d+=i*$e,w+=i*Oe,S+=i*De,x+=i*We,T+=i*Ie,A+=i*Ce,z+=i*Je,K+=i*Fe,B+=i*Ne,Z+=i*Ye,H+=i*we,U+=i*qe,i=t[1],h+=i*Re,f+=i*ve,y+=i*Ke,d+=i*Ge,w+=i*$e,S+=i*Oe,x+=i*De,T+=i*We,A+=i*Ie,z+=i*Ce,K+=i*Je,B+=i*Fe,Z+=i*Ne,H+=i*Ye,U+=i*we,ee+=i*qe,i=t[2],f+=i*Re,y+=i*ve,d+=i*Ke,w+=i*Ge,S+=i*$e,x+=i*Oe,T+=i*De,A+=i*We,z+=i*Ie,K+=i*Ce,B+=i*Je,Z+=i*Fe,H+=i*Ne,U+=i*Ye,ee+=i*we,ne+=i*qe,i=t[3],y+=i*Re,d+=i*ve,w+=i*Ke,S+=i*Ge,x+=i*$e,T+=i*Oe,A+=i*De,z+=i*We,K+=i*Ie,B+=i*Ce,Z+=i*Je,H+=i*Fe,U+=i*Ne,ee+=i*Ye,ne+=i*we,O+=i*qe,i=t[4],d+=i*Re,w+=i*ve,S+=i*Ke,x+=i*Ge,T+=i*$e,A+=i*Oe,z+=i*De,K+=i*We,B+=i*Ie,Z+=i*Ce,H+=i*Je,U+=i*Fe,ee+=i*Ne,ne+=i*Ye,O+=i*we,N+=i*qe,i=t[5],w+=i*Re,S+=i*ve,x+=i*Ke,T+=i*Ge,A+=i*$e,z+=i*Oe,K+=i*De,B+=i*We,Z+=i*Ie,H+=i*Ce,U+=i*Je,ee+=i*Fe,ne+=i*Ne,O+=i*Ye,N+=i*we,re+=i*qe,i=t[6],S+=i*Re,x+=i*ve,T+=i*Ke,A+=i*Ge,z+=i*$e,K+=i*Oe,B+=i*De,Z+=i*We,H+=i*Ie,U+=i*Ce,ee+=i*Je,ne+=i*Fe,O+=i*Ne,N+=i*Ye,re+=i*we,I+=i*qe,i=t[7],x+=i*Re,T+=i*ve,A+=i*Ke,z+=i*Ge,K+=i*$e,B+=i*Oe,Z+=i*De,H+=i*We,U+=i*Ie,ee+=i*Ce,ne+=i*Je,O+=i*Fe,N+=i*Ne,re+=i*Ye,I+=i*we,P+=i*qe,i=t[8],T+=i*Re,A+=i*ve,z+=i*Ke,K+=i*Ge,B+=i*$e,Z+=i*Oe,H+=i*De,U+=i*We,ee+=i*Ie,ne+=i*Ce,O+=i*Je,N+=i*Fe,re+=i*Ne,I+=i*Ye,P+=i*we,L+=i*qe,i=t[9],A+=i*Re,z+=i*ve,K+=i*Ke,B+=i*Ge,Z+=i*$e,H+=i*Oe,U+=i*De,ee+=i*We,ne+=i*Ie,O+=i*Ce,N+=i*Je,re+=i*Fe,I+=i*Ne,P+=i*Ye,L+=i*we,q+=i*qe,i=t[10],z+=i*Re,K+=i*ve,B+=i*Ke,Z+=i*Ge,H+=i*$e,U+=i*Oe,ee+=i*De,ne+=i*We,O+=i*Ie,N+=i*Ce,re+=i*Je,I+=i*Fe,P+=i*Ne,L+=i*Ye,q+=i*we,M+=i*qe,i=t[11],K+=i*Re,B+=i*ve,Z+=i*Ke,H+=i*Ge,U+=i*$e,ee+=i*Oe,ne+=i*De,O+=i*We,N+=i*Ie,re+=i*Ce,I+=i*Je,P+=i*Fe,L+=i*Ne,q+=i*Ye,M+=i*we,Y+=i*qe,i=t[12],B+=i*Re,Z+=i*ve,H+=i*Ke,U+=i*Ge,ee+=i*$e,ne+=i*Oe,O+=i*De,N+=i*We,re+=i*Ie,I+=i*Ce,P+=i*Je,L+=i*Fe,q+=i*Ne,M+=i*Ye,Y+=i*we,_e+=i*qe,i=t[13],Z+=i*Re,H+=i*ve,U+=i*Ke,ee+=i*Ge,ne+=i*$e,O+=i*Oe,N+=i*De,re+=i*We,I+=i*Ie,P+=i*Ce,L+=i*Je,q+=i*Fe,M+=i*Ne,Y+=i*Ye,_e+=i*we,ke+=i*qe,i=t[14],H+=i*Re,U+=i*ve,ee+=i*Ke,ne+=i*Ge,O+=i*$e,N+=i*Oe,re+=i*De,I+=i*We,P+=i*Ie,L+=i*Ce,q+=i*Je,M+=i*Fe,Y+=i*Ne,_e+=i*Ye,ke+=i*we,et+=i*qe,i=t[15],U+=i*Re,ee+=i*ve,ne+=i*Ke,O+=i*Ge,N+=i*$e,re+=i*Oe,I+=i*De,P+=i*We,L+=i*Ie,q+=i*Ce,M+=i*Je,Y+=i*Fe,_e+=i*Ne,ke+=i*Ye,et+=i*we,gi+=i*qe,c+=38*ee,h+=38*ne,f+=38*O,y+=38*N,d+=38*re,w+=38*I,S+=38*P,x+=38*L,T+=38*q,A+=38*M,z+=38*Y,K+=38*_e,B+=38*ke,Z+=38*et,H+=38*gi,o=1,i=c+o+65535,o=Math.floor(i/65536),c=i-o*65536,i=h+o+65535,o=Math.floor(i/65536),h=i-o*65536,i=f+o+65535,o=Math.floor(i/65536),f=i-o*65536,i=y+o+65535,o=Math.floor(i/65536),y=i-o*65536,i=d+o+65535,o=Math.floor(i/65536),d=i-o*65536,i=w+o+65535,o=Math.floor(i/65536),w=i-o*65536,i=S+o+65535,o=Math.floor(i/65536),S=i-o*65536,i=x+o+65535,o=Math.floor(i/65536),x=i-o*65536,i=T+o+65535,o=Math.floor(i/65536),T=i-o*65536,i=A+o+65535,o=Math.floor(i/65536),A=i-o*65536,i=z+o+65535,o=Math.floor(i/65536),z=i-o*65536,i=K+o+65535,o=Math.floor(i/65536),K=i-o*65536,i=B+o+65535,o=Math.floor(i/65536),B=i-o*65536,i=Z+o+65535,o=Math.floor(i/65536),Z=i-o*65536,i=H+o+65535,o=Math.floor(i/65536),H=i-o*65536,i=U+o+65535,o=Math.floor(i/65536),U=i-o*65536,c+=o-1+37*(o-1),o=1,i=c+o+65535,o=Math.floor(i/65536),c=i-o*65536,i=h+o+65535,o=Math.floor(i/65536),h=i-o*65536,i=f+o+65535,o=Math.floor(i/65536),f=i-o*65536,i=y+o+65535,o=Math.floor(i/65536),y=i-o*65536,i=d+o+65535,o=Math.floor(i/65536),d=i-o*65536,i=w+o+65535,o=Math.floor(i/65536),w=i-o*65536,i=S+o+65535,o=Math.floor(i/65536),S=i-o*65536,i=x+o+65535,o=Math.floor(i/65536),x=i-o*65536,i=T+o+65535,o=Math.floor(i/65536),T=i-o*65536,i=A+o+65535,o=Math.floor(i/65536),A=i-o*65536,i=z+o+65535,o=Math.floor(i/65536),z=i-o*65536,i=K+o+65535,o=Math.floor(i/65536),K=i-o*65536,i=B+o+65535,o=Math.floor(i/65536),B=i-o*65536,i=Z+o+65535,o=Math.floor(i/65536),Z=i-o*65536,i=H+o+65535,o=Math.floor(i/65536),H=i-o*65536,i=U+o+65535,o=Math.floor(i/65536),U=i-o*65536,c+=o-1+37*(o-1),s[0]=c,s[1]=h,s[2]=f,s[3]=y,s[4]=d,s[5]=w,s[6]=S,s[7]=x,s[8]=T,s[9]=A,s[10]=z,s[11]=K,s[12]=B,s[13]=Z,s[14]=H,s[15]=U}function oi(s,t){Ee(s,t,t)}function Qd(s,t){let e=W(),i;for(i=0;i<16;i++)e[i]=t[i];for(i=253;i>=0;i--)oi(e,e),i!==2&&i!==4&&Ee(e,e,t);for(i=0;i<16;i++)s[i]=e[i]}function lS(s,t){let e=W(),i;for(i=0;i<16;i++)e[i]=t[i];for(i=250;i>=0;i--)oi(e,e),i!==1&&Ee(e,e,t);for(i=0;i<16;i++)s[i]=e[i]}function hu(s,t){let e=W(),i=W(),o=W(),c=W(),h=W(),f=W(),y=W(),d=W(),w=W();ai(e,s[1],s[0]),ai(w,t[1],t[0]),Ee(e,e,w),si(i,s[0],s[1]),si(w,t[0],t[1]),Ee(i,i,w),Ee(o,s[3],t[3]),Ee(o,o,cS),Ee(c,s[2],t[2]),si(c,c,c),ai(h,i,e),ai(f,c,o),si(y,c,o),si(d,i,e),Ee(s[0],h,f),Ee(s[1],d,y),Ee(s[2],y,f),Ee(s[3],h,d)}function Gd(s,t,e){for(let i=0;i<4;i++)Jd(s[i],t[i],e)}function fu(s,t){let e=W(),i=W(),o=W();Qd(o,t[2]),Ee(e,t[0],o),Ee(i,t[1],o),Ln(s,i),s[31]^=Xd(e)<<7}function Zd(s,t,e){Mr(s[0],uu),Mr(s[1],Ki),Mr(s[2],Ki),Mr(s[3],uu);for(let i=255;i>=0;--i){let o=e[i/8|0]>>(i&7)&1;Gd(s,t,o),hu(t,s),hu(s,s),Gd(s,t,o)}}function pu(s,t){let e=[W(),W(),W(),W()];Mr(e[0],Bd),Mr(e[1],kd),Mr(e[2],Ki),Ee(e[3],Bd,kd),Zd(s,e,t)}function eg(s){if(s.length!==ye.SEED_LENGTH)throw new Error(`ed25519: seed must be ${ye.SEED_LENGTH} bytes`);let t=(0,Nn.hash)(s);t[0]&=248,t[31]&=127,t[31]|=64;let e=new Uint8Array(32),i=[W(),W(),W(),W()];pu(i,t),fu(e,i);let o=new Uint8Array(64);return o.set(s),o.set(e,32),{publicKey:e,secretKey:o}}ye.generateKeyPairFromSeed=eg;function fS(s){let t=(0,sS.randomBytes)(32,s),e=eg(t);return(0,Wd.wipe)(t),e}ye.generateKeyPair=fS;function pS(s){if(s.length!==ye.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${ye.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(s.subarray(32))}ye.extractPublicKeyFromSecretKey=pS;var cu=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function tg(s,t){let e,i,o,c;for(i=63;i>=32;--i){for(e=0,o=i-32,c=i-12;o<c;++o)t[o]+=e-16*t[i]*cu[o-(i-32)],e=Math.floor((t[o]+128)/256),t[o]-=e*256;t[o]+=e,t[i]=0}for(e=0,o=0;o<32;o++)t[o]+=e-(t[31]>>4)*cu[o],e=t[o]>>8,t[o]&=255;for(o=0;o<32;o++)t[o]-=e*cu[o];for(i=0;i<32;i++)t[i+1]+=t[i]>>8,s[i]=t[i]&255}function lu(s){let t=new Float64Array(64);for(let e=0;e<64;e++)t[e]=s[e];for(let e=0;e<64;e++)s[e]=0;tg(s,t)}function dS(s,t){let e=new Float64Array(64),i=[W(),W(),W(),W()],o=(0,Nn.hash)(s.subarray(0,32));o[0]&=248,o[31]&=127,o[31]|=64;let c=new Uint8Array(64);c.set(o.subarray(32),32);let h=new Nn.SHA512;h.update(c.subarray(32)),h.update(t);let f=h.digest();h.clean(),lu(f),pu(i,f),fu(c,i),h.reset(),h.update(c.subarray(0,32)),h.update(s.subarray(32)),h.update(t);let y=h.digest();lu(y);for(let d=0;d<32;d++)e[d]=f[d];for(let d=0;d<32;d++)for(let w=0;w<32;w++)e[d+w]+=y[d]*o[w];return tg(c.subarray(32),e),c}ye.sign=dS;function rg(s,t){let e=W(),i=W(),o=W(),c=W(),h=W(),f=W(),y=W();return Mr(s[2],Ki),hS(s[1],t),oi(o,s[1]),Ee(c,o,aS),ai(o,o,s[2]),si(c,s[2],c),oi(h,c),oi(f,h),Ee(y,f,h),Ee(e,y,o),Ee(e,e,c),lS(e,e),Ee(e,e,o),Ee(e,e,c),Ee(e,e,c),Ee(s[0],e,c),oi(i,s[0]),Ee(i,i,c),Kd(i,o)&&Ee(s[0],s[0],uS),oi(i,s[0]),Ee(i,i,c),Kd(i,o)?-1:(Xd(s[0])===t[31]>>7&&ai(s[0],uu,s[0]),Ee(s[3],s[0],s[1]),0)}function gS(s,t,e){let i=new Uint8Array(32),o=[W(),W(),W(),W()],c=[W(),W(),W(),W()];if(e.length!==ye.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${ye.SIGNATURE_LENGTH} bytes`);if(rg(c,s))return!1;let h=new Nn.SHA512;h.update(e.subarray(0,32)),h.update(s),h.update(t);let f=h.digest();return lu(f),Zd(o,c,f),pu(c,e.subarray(32)),hu(o,c),fu(i,o),!Yd(e,i)}ye.verify=gS;function yS(s){let t=[W(),W(),W(),W()];if(rg(t,s))throw new Error("Ed25519: invalid public key");let e=W(),i=W(),o=t[1];si(e,Ki,o),ai(i,Ki,o),Qd(i,i),Ee(e,e,i);let c=new Uint8Array(32);return Ln(c,e),c}ye.convertPublicKeyToX25519=yS;function vS(s){let t=(0,Nn.hash)(s.subarray(0,32));t[0]&=248,t[31]&=127,t[31]|=64;let e=new Uint8Array(t.subarray(0,32));return(0,Wd.wipe)(t),e}ye.convertSecretKeyToX25519=vS});var Ig={};ii(Ig,{__assign:()=>wu,__asyncDelegator:()=>FS,__asyncGenerator:()=>DS,__asyncValues:()=>jS,__await:()=>Mn,__awaiter:()=>OS,__classPrivateFieldGet:()=>zS,__classPrivateFieldSet:()=>$S,__createBinding:()=>AS,__decorate:()=>SS,__exportStar:()=>CS,__extends:()=>xS,__generator:()=>TS,__importDefault:()=>US,__importStar:()=>MS,__makeTemplateObject:()=>qS,__metadata:()=>RS,__param:()=>PS,__read:()=>xg,__rest:()=>IS,__spread:()=>NS,__spreadArrays:()=>LS,__values:()=>bu});function xS(s,t){_u(s,t);function e(){this.constructor=s}s.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function IS(s,t){var e={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&t.indexOf(i)<0&&(e[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(s);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(s,i[o])&&(e[i[o]]=s[i[o]]);return e}function SS(s,t,e,i){var o=arguments.length,c=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,t,e,i);else for(var f=s.length-1;f>=0;f--)(h=s[f])&&(c=(o<3?h(c):o>3?h(t,e,c):h(t,e))||c);return o>3&&c&&Object.defineProperty(t,e,c),c}function PS(s,t){return function(e,i){t(e,i,s)}}function RS(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}function OS(s,t,e,i){function o(c){return c instanceof e?c:new e(function(h){h(c)})}return new(e||(e=Promise))(function(c,h){function f(w){try{d(i.next(w))}catch(S){h(S)}}function y(w){try{d(i.throw(w))}catch(S){h(S)}}function d(w){w.done?c(w.value):o(w.value).then(f,y)}d((i=i.apply(s,t||[])).next())})}function TS(s,t){var e={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,h;return h={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function f(d){return function(w){return y([d,w])}}function y(d){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,o&&(c=d[0]&2?o.return:d[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,d[1])).done)return c;switch(o=0,c&&(d=[d[0]&2,c.value]),d[0]){case 0:case 1:c=d;break;case 4:return e.label++,{value:d[1],done:!1};case 5:e.label++,o=d[1],d=[0];continue;case 7:d=e.ops.pop(),e.trys.pop();continue;default:if(c=e.trys,!(c=c.length>0&&c[c.length-1])&&(d[0]===6||d[0]===2)){e=0;continue}if(d[0]===3&&(!c||d[1]>c[0]&&d[1]<c[3])){e.label=d[1];break}if(d[0]===6&&e.label<c[1]){e.label=c[1],c=d;break}if(c&&e.label<c[2]){e.label=c[2],e.ops.push(d);break}c[2]&&e.ops.pop(),e.trys.pop();continue}d=t.call(s,e)}catch(w){d=[6,w],o=0}finally{i=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function AS(s,t,e,i){i===void 0&&(i=e),s[i]=t[e]}function CS(s,t){for(var e in s)e!=="default"&&!t.hasOwnProperty(e)&&(t[e]=s[e])}function bu(s){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&s[t],i=0;if(e)return e.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&i>=s.length&&(s=void 0),{value:s&&s[i++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function xg(s,t){var e=typeof Symbol=="function"&&s[Symbol.iterator];if(!e)return s;var i=e.call(s),o,c=[],h;try{for(;(t===void 0||t-- >0)&&!(o=i.next()).done;)c.push(o.value)}catch(f){h={error:f}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(h)throw h.error}}return c}function NS(){for(var s=[],t=0;t<arguments.length;t++)s=s.concat(xg(arguments[t]));return s}function LS(){for(var s=0,t=0,e=arguments.length;t<e;t++)s+=arguments[t].length;for(var i=Array(s),o=0,t=0;t<e;t++)for(var c=arguments[t],h=0,f=c.length;h<f;h++,o++)i[o]=c[h];return i}function Mn(s){return this instanceof Mn?(this.v=s,this):new Mn(s)}function DS(s,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=e.apply(s,t||[]),o,c=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(x){i[x]&&(o[x]=function(T){return new Promise(function(A,z){c.push([x,T,A,z])>1||f(x,T)})})}function f(x,T){try{y(i[x](T))}catch(A){S(c[0][3],A)}}function y(x){x.value instanceof Mn?Promise.resolve(x.value.v).then(d,w):S(c[0][2],x)}function d(x){f("next",x)}function w(x){f("throw",x)}function S(x,T){x(T),c.shift(),c.length&&f(c[0][0],c[0][1])}}function FS(s){var t,e;return t={},i("next"),i("throw",function(o){throw o}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(o,c){t[o]=s[o]?function(h){return(e=!e)?{value:Mn(s[o](h)),done:o==="return"}:c?c(h):h}:c}}function jS(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=s[Symbol.asyncIterator],e;return t?t.call(s):(s=typeof bu=="function"?bu(s):s[Symbol.iterator](),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(c){e[c]=s[c]&&function(h){return new Promise(function(f,y){h=s[c](h),o(f,y,h.done,h.value)})}}function o(c,h,f,y){Promise.resolve(y).then(function(d){c({value:d,done:f})},h)}}function qS(s,t){return Object.defineProperty?Object.defineProperty(s,"raw",{value:t}):s.raw=t,s}function MS(s){if(s&&s.__esModule)return s;var t={};if(s!=null)for(var e in s)Object.hasOwnProperty.call(s,e)&&(t[e]=s[e]);return t.default=s,t}function US(s){return s&&s.__esModule?s:{default:s}}function zS(s,t){if(!t.has(s))throw new TypeError("attempted to get private field on non-instance");return t.get(s)}function $S(s,t,e){if(!t.has(s))throw new TypeError("attempted to set private field on non-instance");return t.set(s,e),e}var _u,wu,Sg=Ci(()=>{"use strict";_u=function(s,t){return _u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var o in i)i.hasOwnProperty(o)&&(e[o]=i[o])},_u(s,t)};wu=function(){return wu=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++){e=arguments[i];for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&(t[c]=e[c])}return t},wu.apply(this,arguments)}});var Rg=Pe(zr=>{"use strict";Object.defineProperty(zr,"__esModule",{value:!0});zr.isBrowserCryptoAvailable=zr.getSubtleCrypto=zr.getBrowerCrypto=void 0;function Eu(){return(global==null?void 0:global.crypto)||(global==null?void 0:global.msCrypto)||{}}zr.getBrowerCrypto=Eu;function Pg(){let s=Eu();return s.subtle||s.webkitSubtle}zr.getSubtleCrypto=Pg;function HS(){return!!Eu()&&!!Pg()}zr.isBrowserCryptoAvailable=HS});var Ag=Pe($r=>{"use strict";Object.defineProperty($r,"__esModule",{value:!0});$r.isBrowser=$r.isNode=$r.isReactNative=void 0;function Og(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}$r.isReactNative=Og;function Tg(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}$r.isNode=Tg;function VS(){return!Og()&&!Tg()}$r.isBrowser=VS});var xu=Pe(Co=>{"use strict";Object.defineProperty(Co,"__esModule",{value:!0});var Cg=(Sg(),dr(Ig));Cg.__exportStar(Rg(),Co);Cg.__exportStar(Ag(),Co)});var Mg=Pe((X2,qg)=>{"use strict";qg.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}});var Sy=Pe((Hn,Xi)=>{"use strict";var QS=200,Uu="__lodash_hash_undefined__",Bo=1,ry=2,iy=9007199254740991,qo="[object Arguments]",Nu="[object Array]",ZS="[object AsyncFunction]",ny="[object Boolean]",sy="[object Date]",oy="[object Error]",ay="[object Function]",eP="[object GeneratorFunction]",Mo="[object Map]",cy="[object Number]",tP="[object Null]",Yi="[object Object]",kg="[object Promise]",rP="[object Proxy]",uy="[object RegExp]",Uo="[object Set]",hy="[object String]",iP="[object Symbol]",nP="[object Undefined]",Lu="[object WeakMap]",ly="[object ArrayBuffer]",zo="[object DataView]",sP="[object Float32Array]",oP="[object Float64Array]",aP="[object Int8Array]",cP="[object Int16Array]",uP="[object Int32Array]",hP="[object Uint8Array]",lP="[object Uint8ClampedArray]",fP="[object Uint16Array]",pP="[object Uint32Array]",dP=/[\\^$.*+?()[\]{}|]/g,gP=/^\[object .+?Constructor\]$/,yP=/^(?:0|[1-9]\d*)$/,Ae={};Ae[sP]=Ae[oP]=Ae[aP]=Ae[cP]=Ae[uP]=Ae[hP]=Ae[lP]=Ae[fP]=Ae[pP]=!0;Ae[qo]=Ae[Nu]=Ae[ly]=Ae[ny]=Ae[zo]=Ae[sy]=Ae[oy]=Ae[ay]=Ae[Mo]=Ae[cy]=Ae[Yi]=Ae[uy]=Ae[Uo]=Ae[hy]=Ae[Lu]=!1;var fy=typeof global=="object"&&global&&global.Object===Object&&global,vP=typeof self=="object"&&self&&self.Object===Object&&self,wr=fy||vP||Function("return this")(),py=typeof Hn=="object"&&Hn&&!Hn.nodeType&&Hn,Kg=py&&typeof Xi=="object"&&Xi&&!Xi.nodeType&&Xi,dy=Kg&&Kg.exports===py,Tu=dy&&fy.process,Gg=function(){try{return Tu&&Tu.binding&&Tu.binding("util")}catch{}}(),Wg=Gg&&Gg.isTypedArray;function mP(s,t){for(var e=-1,i=s==null?0:s.length,o=0,c=[];++e<i;){var h=s[e];t(h,e,s)&&(c[o++]=h)}return c}function _P(s,t){for(var e=-1,i=t.length,o=s.length;++e<i;)s[o+e]=t[e];return s}function wP(s,t){for(var e=-1,i=s==null?0:s.length;++e<i;)if(t(s[e],e,s))return!0;return!1}function bP(s,t){for(var e=-1,i=Array(s);++e<s;)i[e]=t(e);return i}function EP(s){return function(t){return s(t)}}function xP(s,t){return s.has(t)}function IP(s,t){return s?.[t]}function SP(s){var t=-1,e=Array(s.size);return s.forEach(function(i,o){e[++t]=[o,i]}),e}function PP(s,t){return function(e){return s(t(e))}}function RP(s){var t=-1,e=Array(s.size);return s.forEach(function(i){e[++t]=i}),e}var OP=Array.prototype,TP=Function.prototype,ko=Object.prototype,Au=wr["__core-js_shared__"],gy=TP.toString,tr=ko.hasOwnProperty,Jg=function(){var s=/[^.]+$/.exec(Au&&Au.keys&&Au.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),yy=ko.toString,AP=RegExp("^"+gy.call(tr).replace(dP,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Yg=dy?wr.Buffer:void 0,$o=wr.Symbol,Xg=wr.Uint8Array,vy=ko.propertyIsEnumerable,CP=OP.splice,ci=$o?$o.toStringTag:void 0,Qg=Object.getOwnPropertySymbols,NP=Yg?Yg.isBuffer:void 0,LP=PP(Object.keys,Object),Du=Qi(wr,"DataView"),Vn=Qi(wr,"Map"),Fu=Qi(wr,"Promise"),ju=Qi(wr,"Set"),qu=Qi(wr,"WeakMap"),Bn=Qi(Object,"create"),DP=li(Du),FP=li(Vn),jP=li(Fu),qP=li(ju),MP=li(qu),Zg=$o?$o.prototype:void 0,Cu=Zg?Zg.valueOf:void 0;function ui(s){var t=-1,e=s==null?0:s.length;for(this.clear();++t<e;){var i=s[t];this.set(i[0],i[1])}}function UP(){this.__data__=Bn?Bn(null):{},this.size=0}function zP(s){var t=this.has(s)&&delete this.__data__[s];return this.size-=t?1:0,t}function $P(s){var t=this.__data__;if(Bn){var e=t[s];return e===Uu?void 0:e}return tr.call(t,s)?t[s]:void 0}function HP(s){var t=this.__data__;return Bn?t[s]!==void 0:tr.call(t,s)}function VP(s,t){var e=this.__data__;return this.size+=this.has(s)?0:1,e[s]=Bn&&t===void 0?Uu:t,this}ui.prototype.clear=UP;ui.prototype.delete=zP;ui.prototype.get=$P;ui.prototype.has=HP;ui.prototype.set=VP;function br(s){var t=-1,e=s==null?0:s.length;for(this.clear();++t<e;){var i=s[t];this.set(i[0],i[1])}}function BP(){this.__data__=[],this.size=0}function kP(s){var t=this.__data__,e=Ko(t,s);if(e<0)return!1;var i=t.length-1;return e==i?t.pop():CP.call(t,e,1),--this.size,!0}function KP(s){var t=this.__data__,e=Ko(t,s);return e<0?void 0:t[e][1]}function GP(s){return Ko(this.__data__,s)>-1}function WP(s,t){var e=this.__data__,i=Ko(e,s);return i<0?(++this.size,e.push([s,t])):e[i][1]=t,this}br.prototype.clear=BP;br.prototype.delete=kP;br.prototype.get=KP;br.prototype.has=GP;br.prototype.set=WP;function hi(s){var t=-1,e=s==null?0:s.length;for(this.clear();++t<e;){var i=s[t];this.set(i[0],i[1])}}function JP(){this.size=0,this.__data__={hash:new ui,map:new(Vn||br),string:new ui}}function YP(s){var t=Go(this,s).delete(s);return this.size-=t?1:0,t}function XP(s){return Go(this,s).get(s)}function QP(s){return Go(this,s).has(s)}function ZP(s,t){var e=Go(this,s),i=e.size;return e.set(s,t),this.size+=e.size==i?0:1,this}hi.prototype.clear=JP;hi.prototype.delete=YP;hi.prototype.get=XP;hi.prototype.has=QP;hi.prototype.set=ZP;function Ho(s){var t=-1,e=s==null?0:s.length;for(this.__data__=new hi;++t<e;)this.add(s[t])}function eR(s){return this.__data__.set(s,Uu),this}function tR(s){return this.__data__.has(s)}Ho.prototype.add=Ho.prototype.push=eR;Ho.prototype.has=tR;function Br(s){var t=this.__data__=new br(s);this.size=t.size}function rR(){this.__data__=new br,this.size=0}function iR(s){var t=this.__data__,e=t.delete(s);return this.size=t.size,e}function nR(s){return this.__data__.get(s)}function sR(s){return this.__data__.has(s)}function oR(s,t){var e=this.__data__;if(e instanceof br){var i=e.__data__;if(!Vn||i.length<QS-1)return i.push([s,t]),this.size=++e.size,this;e=this.__data__=new hi(i)}return e.set(s,t),this.size=e.size,this}Br.prototype.clear=rR;Br.prototype.delete=iR;Br.prototype.get=nR;Br.prototype.has=sR;Br.prototype.set=oR;function aR(s,t){var e=Vo(s),i=!e&&ER(s),o=!e&&!i&&Mu(s),c=!e&&!i&&!o&&Iy(s),h=e||i||o||c,f=h?bP(s.length,String):[],y=f.length;for(var d in s)(t||tr.call(s,d))&&!(h&&(d=="length"||o&&(d=="offset"||d=="parent")||c&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||vR(d,y)))&&f.push(d);return f}function Ko(s,t){for(var e=s.length;e--;)if(wy(s[e][0],t))return e;return-1}function cR(s,t,e){var i=t(s);return Vo(s)?i:_P(i,e(s))}function Kn(s){return s==null?s===void 0?nP:tP:ci&&ci in Object(s)?gR(s):bR(s)}function ey(s){return kn(s)&&Kn(s)==qo}function my(s,t,e,i,o){return s===t?!0:s==null||t==null||!kn(s)&&!kn(t)?s!==s&&t!==t:uR(s,t,e,i,my,o)}function uR(s,t,e,i,o,c){var h=Vo(s),f=Vo(t),y=h?Nu:Vr(s),d=f?Nu:Vr(t);y=y==qo?Yi:y,d=d==qo?Yi:d;var w=y==Yi,S=d==Yi,x=y==d;if(x&&Mu(s)){if(!Mu(t))return!1;h=!0,w=!1}if(x&&!w)return c||(c=new Br),h||Iy(s)?_y(s,t,e,i,o,c):pR(s,t,y,e,i,o,c);if(!(e&Bo)){var T=w&&tr.call(s,"__wrapped__"),A=S&&tr.call(t,"__wrapped__");if(T||A){var z=T?s.value():s,K=A?t.value():t;return c||(c=new Br),o(z,K,e,i,c)}}return x?(c||(c=new Br),dR(s,t,e,i,o,c)):!1}function hR(s){if(!xy(s)||_R(s))return!1;var t=by(s)?AP:gP;return t.test(li(s))}function lR(s){return kn(s)&&Ey(s.length)&&!!Ae[Kn(s)]}function fR(s){if(!wR(s))return LP(s);var t=[];for(var e in Object(s))tr.call(s,e)&&e!="constructor"&&t.push(e);return t}function _y(s,t,e,i,o,c){var h=e&Bo,f=s.length,y=t.length;if(f!=y&&!(h&&y>f))return!1;var d=c.get(s);if(d&&c.get(t))return d==t;var w=-1,S=!0,x=e&ry?new Ho:void 0;for(c.set(s,t),c.set(t,s);++w<f;){var T=s[w],A=t[w];if(i)var z=h?i(A,T,w,t,s,c):i(T,A,w,s,t,c);if(z!==void 0){if(z)continue;S=!1;break}if(x){if(!wP(t,function(K,B){if(!xP(x,B)&&(T===K||o(T,K,e,i,c)))return x.push(B)})){S=!1;break}}else if(!(T===A||o(T,A,e,i,c))){S=!1;break}}return c.delete(s),c.delete(t),S}function pR(s,t,e,i,o,c,h){switch(e){case zo:if(s.byteLength!=t.byteLength||s.byteOffset!=t.byteOffset)return!1;s=s.buffer,t=t.buffer;case ly:return!(s.byteLength!=t.byteLength||!c(new Xg(s),new Xg(t)));case ny:case sy:case cy:return wy(+s,+t);case oy:return s.name==t.name&&s.message==t.message;case uy:case hy:return s==t+"";case Mo:var f=SP;case Uo:var y=i&Bo;if(f||(f=RP),s.size!=t.size&&!y)return!1;var d=h.get(s);if(d)return d==t;i|=ry,h.set(s,t);var w=_y(f(s),f(t),i,o,c,h);return h.delete(s),w;case iP:if(Cu)return Cu.call(s)==Cu.call(t)}return!1}function dR(s,t,e,i,o,c){var h=e&Bo,f=ty(s),y=f.length,d=ty(t),w=d.length;if(y!=w&&!h)return!1;for(var S=y;S--;){var x=f[S];if(!(h?x in t:tr.call(t,x)))return!1}var T=c.get(s);if(T&&c.get(t))return T==t;var A=!0;c.set(s,t),c.set(t,s);for(var z=h;++S<y;){x=f[S];var K=s[x],B=t[x];if(i)var Z=h?i(B,K,x,t,s,c):i(K,B,x,s,t,c);if(!(Z===void 0?K===B||o(K,B,e,i,c):Z)){A=!1;break}z||(z=x=="constructor")}if(A&&!z){var H=s.constructor,U=t.constructor;H!=U&&"constructor"in s&&"constructor"in t&&!(typeof H=="function"&&H instanceof H&&typeof U=="function"&&U instanceof U)&&(A=!1)}return c.delete(s),c.delete(t),A}function ty(s){return cR(s,SR,yR)}function Go(s,t){var e=s.__data__;return mR(t)?e[typeof t=="string"?"string":"hash"]:e.map}function Qi(s,t){var e=IP(s,t);return hR(e)?e:void 0}function gR(s){var t=tr.call(s,ci),e=s[ci];try{s[ci]=void 0;var i=!0}catch{}var o=yy.call(s);return i&&(t?s[ci]=e:delete s[ci]),o}var yR=Qg?function(s){return s==null?[]:(s=Object(s),mP(Qg(s),function(t){return vy.call(s,t)}))}:PR,Vr=Kn;(Du&&Vr(new Du(new ArrayBuffer(1)))!=zo||Vn&&Vr(new Vn)!=Mo||Fu&&Vr(Fu.resolve())!=kg||ju&&Vr(new ju)!=Uo||qu&&Vr(new qu)!=Lu)&&(Vr=function(s){var t=Kn(s),e=t==Yi?s.constructor:void 0,i=e?li(e):"";if(i)switch(i){case DP:return zo;case FP:return Mo;case jP:return kg;case qP:return Uo;case MP:return Lu}return t});function vR(s,t){return t=t??iy,!!t&&(typeof s=="number"||yP.test(s))&&s>-1&&s%1==0&&s<t}function mR(s){var t=typeof s;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?s!=="__proto__":s===null}function _R(s){return!!Jg&&Jg in s}function wR(s){var t=s&&s.constructor,e=typeof t=="function"&&t.prototype||ko;return s===e}function bR(s){return yy.call(s)}function li(s){if(s!=null){try{return gy.call(s)}catch{}try{return s+""}catch{}}return""}function wy(s,t){return s===t||s!==s&&t!==t}var ER=ey(function(){return arguments}())?ey:function(s){return kn(s)&&tr.call(s,"callee")&&!vy.call(s,"callee")},Vo=Array.isArray;function xR(s){return s!=null&&Ey(s.length)&&!by(s)}var Mu=NP||RR;function IR(s,t){return my(s,t)}function by(s){if(!xy(s))return!1;var t=Kn(s);return t==ay||t==eP||t==ZS||t==rP}function Ey(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=iy}function xy(s){var t=typeof s;return s!=null&&(t=="object"||t=="function")}function kn(s){return s!=null&&typeof s=="object"}var Iy=Wg?EP(Wg):lR;function SR(s){return xR(s)?aR(s):fR(s)}function PR(){return[]}function RR(){return!1}Xi.exports=IR});var gv=Pe((Sr,dv)=>{"use strict";var pv=typeof self<"u"?self:Sr,Qo=function(){function s(){this.fetch=!1,this.DOMException=pv.DOMException}return s.prototype=pv,new s}();(function(s){var t=function(e){var i={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function o(I){return I&&DataView.prototype.isPrototypeOf(I)}if(i.arrayBuffer)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(I){return I&&c.indexOf(Object.prototype.toString.call(I))>-1};function f(I){if(typeof I!="string"&&(I=String(I)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(I))throw new TypeError("Invalid character in header field name");return I.toLowerCase()}function y(I){return typeof I!="string"&&(I=String(I)),I}function d(I){var P={next:function(){var L=I.shift();return{done:L===void 0,value:L}}};return i.iterable&&(P[Symbol.iterator]=function(){return P}),P}function w(I){this.map={},I instanceof w?I.forEach(function(P,L){this.append(L,P)},this):Array.isArray(I)?I.forEach(function(P){this.append(P[0],P[1])},this):I&&Object.getOwnPropertyNames(I).forEach(function(P){this.append(P,I[P])},this)}w.prototype.append=function(I,P){I=f(I),P=y(P);var L=this.map[I];this.map[I]=L?L+", "+P:P},w.prototype.delete=function(I){delete this.map[f(I)]},w.prototype.get=function(I){return I=f(I),this.has(I)?this.map[I]:null},w.prototype.has=function(I){return this.map.hasOwnProperty(f(I))},w.prototype.set=function(I,P){this.map[f(I)]=y(P)},w.prototype.forEach=function(I,P){for(var L in this.map)this.map.hasOwnProperty(L)&&I.call(P,this.map[L],L,this)},w.prototype.keys=function(){var I=[];return this.forEach(function(P,L){I.push(L)}),d(I)},w.prototype.values=function(){var I=[];return this.forEach(function(P){I.push(P)}),d(I)},w.prototype.entries=function(){var I=[];return this.forEach(function(P,L){I.push([L,P])}),d(I)},i.iterable&&(w.prototype[Symbol.iterator]=w.prototype.entries);function S(I){if(I.bodyUsed)return Promise.reject(new TypeError("Already read"));I.bodyUsed=!0}function x(I){return new Promise(function(P,L){I.onload=function(){P(I.result)},I.onerror=function(){L(I.error)}})}function T(I){var P=new FileReader,L=x(P);return P.readAsArrayBuffer(I),L}function A(I){var P=new FileReader,L=x(P);return P.readAsText(I),L}function z(I){for(var P=new Uint8Array(I),L=new Array(P.length),q=0;q<P.length;q++)L[q]=String.fromCharCode(P[q]);return L.join("")}function K(I){if(I.slice)return I.slice(0);var P=new Uint8Array(I.byteLength);return P.set(new Uint8Array(I)),P.buffer}function B(){return this.bodyUsed=!1,this._initBody=function(I){this._bodyInit=I,I?typeof I=="string"?this._bodyText=I:i.blob&&Blob.prototype.isPrototypeOf(I)?this._bodyBlob=I:i.formData&&FormData.prototype.isPrototypeOf(I)?this._bodyFormData=I:i.searchParams&&URLSearchParams.prototype.isPrototypeOf(I)?this._bodyText=I.toString():i.arrayBuffer&&i.blob&&o(I)?(this._bodyArrayBuffer=K(I.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):i.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(I)||h(I))?this._bodyArrayBuffer=K(I):this._bodyText=I=Object.prototype.toString.call(I):this._bodyText="",this.headers.get("content-type")||(typeof I=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i.searchParams&&URLSearchParams.prototype.isPrototypeOf(I)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i.blob&&(this.blob=function(){var I=S(this);if(I)return I;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?S(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(T)}),this.text=function(){var I=S(this);if(I)return I;if(this._bodyBlob)return A(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(z(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i.formData&&(this.formData=function(){return this.text().then(ee)}),this.json=function(){return this.text().then(JSON.parse)},this}var Z=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function H(I){var P=I.toUpperCase();return Z.indexOf(P)>-1?P:I}function U(I,P){P=P||{};var L=P.body;if(I instanceof U){if(I.bodyUsed)throw new TypeError("Already read");this.url=I.url,this.credentials=I.credentials,P.headers||(this.headers=new w(I.headers)),this.method=I.method,this.mode=I.mode,this.signal=I.signal,!L&&I._bodyInit!=null&&(L=I._bodyInit,I.bodyUsed=!0)}else this.url=String(I);if(this.credentials=P.credentials||this.credentials||"same-origin",(P.headers||!this.headers)&&(this.headers=new w(P.headers)),this.method=H(P.method||this.method||"GET"),this.mode=P.mode||this.mode||null,this.signal=P.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&L)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(L)}U.prototype.clone=function(){return new U(this,{body:this._bodyInit})};function ee(I){var P=new FormData;return I.trim().split("&").forEach(function(L){if(L){var q=L.split("="),M=q.shift().replace(/\+/g," "),Y=q.join("=").replace(/\+/g," ");P.append(decodeURIComponent(M),decodeURIComponent(Y))}}),P}function ne(I){var P=new w,L=I.replace(/\r?\n[\t ]+/g," ");return L.split(/\r?\n/).forEach(function(q){var M=q.split(":"),Y=M.shift().trim();if(Y){var _e=M.join(":").trim();P.append(Y,_e)}}),P}B.call(U.prototype);function O(I,P){P||(P={}),this.type="default",this.status=P.status===void 0?200:P.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in P?P.statusText:"OK",this.headers=new w(P.headers),this.url=P.url||"",this._initBody(I)}B.call(O.prototype),O.prototype.clone=function(){return new O(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new w(this.headers),url:this.url})},O.error=function(){var I=new O(null,{status:0,statusText:""});return I.type="error",I};var N=[301,302,303,307,308];O.redirect=function(I,P){if(N.indexOf(P)===-1)throw new RangeError("Invalid status code");return new O(null,{status:P,headers:{location:I}})},e.DOMException=s.DOMException;try{new e.DOMException}catch{e.DOMException=function(P,L){this.message=P,this.name=L;var q=Error(P);this.stack=q.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function re(I,P){return new Promise(function(L,q){var M=new U(I,P);if(M.signal&&M.signal.aborted)return q(new e.DOMException("Aborted","AbortError"));var Y=new XMLHttpRequest;function _e(){Y.abort()}Y.onload=function(){var ke={status:Y.status,statusText:Y.statusText,headers:ne(Y.getAllResponseHeaders()||"")};ke.url="responseURL"in Y?Y.responseURL:ke.headers.get("X-Request-URL");var et="response"in Y?Y.response:Y.responseText;L(new O(et,ke))},Y.onerror=function(){q(new TypeError("Network request failed"))},Y.ontimeout=function(){q(new TypeError("Network request failed"))},Y.onabort=function(){q(new e.DOMException("Aborted","AbortError"))},Y.open(M.method,M.url,!0),M.credentials==="include"?Y.withCredentials=!0:M.credentials==="omit"&&(Y.withCredentials=!1),"responseType"in Y&&i.blob&&(Y.responseType="blob"),M.headers.forEach(function(ke,et){Y.setRequestHeader(et,ke)}),M.signal&&(M.signal.addEventListener("abort",_e),Y.onreadystatechange=function(){Y.readyState===4&&M.signal.removeEventListener("abort",_e)}),Y.send(typeof M._bodyInit>"u"?null:M._bodyInit)})}return re.polyfill=!0,s.fetch||(s.fetch=re,s.Headers=w,s.Request=U,s.Response=O),e.Headers=w,e.Request=U,e.Response=O,e.fetch=re,Object.defineProperty(e,"__esModule",{value:!0}),e}({})})(Qo);Qo.fetch.ponyfill=!0;delete Qo.fetch.polyfill;var Zi=Qo;Sr=Zi.fetch;Sr.default=Zi.fetch;Sr.fetch=Zi.fetch;Sr.Headers=Zi.Headers;Sr.Request=Zi.Request;Sr.Response=Zi.Response;dv.exports=Sr});var Dv=Ue(Qt());var xr=Ue(Qt()),ky=Ue(vd()),pi=Ue(Id()),fe=Ue(lo());Vc();var zd=Ue(Qt()),fo=class extends Zt{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}};var po=class extends Zt{constructor(t,e){super(),this.core=t,this.logger=e,this.records=new Map}},go=class{constructor(t,e){this.logger=t,this.core=e}},yo=class extends Zt{constructor(t,e){super(),this.relayer=t,this.logger=e}},vo=class extends Zt{constructor(t){super()}},mo=class{constructor(t,e,i,o){this.core=t,this.logger=e,this.name=i}};var _o=class extends Zt{constructor(t,e){super(),this.relayer=t,this.logger=e}};var wo=class extends Zt{constructor(t,e){super(),this.core=t,this.logger=e}};var bo=class{constructor(t,e){this.projectId=t,this.logger=e}};var Eo=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}};var xo=class{constructor(t){this.client=t}};var rS=s=>JSON.stringify(s,(t,e)=>typeof e=="bigint"?e.toString()+"n":e),iS=s=>{let t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,e=s.replace(t,'$1"$2n"$3');return JSON.parse(e,(i,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function ni(s){if(typeof s!="string")throw new Error(`Cannot safe json parse value of type ${typeof s}`);try{return iS(s)}catch{return s}}function yr(s){return typeof s=="string"?s:rS(s)||""}var Dn=Ue(ig()),gg=Ue(gp()),yg=Ue(wn());var ng="EdDSA",sg="JWT",du=".",gu="base64url",og="utf8",ag="utf8",cg=":",ug="did",hg="key",yu="base58btc",lg="z",fg="K36";function Io(s){return Ni(ks(yr(s),og),gu)}function So(s){let t=ks(fg,yu),e=lg+Ni(yp([t,s]),yu);return[ug,hg,e].join(cg)}function mS(s){return Ni(s,gu)}function pg(s){return ks([Io(s.header),Io(s.payload)].join(du),ag)}function dg(s){return[Io(s.header),Io(s.payload),mS(s.signature)].join(du)}function vu(s=(0,gg.randomBytes)(32)){return Dn.generateKeyPairFromSeed(s)}function vg(c,h,f,y){return m(this,arguments,function*(s,t,e,i,o=(0,yg.fromMiliseconds)(Date.now())){let d={alg:ng,typ:sg},w=So(i.publicKey),S=o+e,x={iss:w,sub:s,aud:t,iat:o,exp:S},T=pg({header:d,payload:x}),A=Dn.sign(i.secretKey,T);return dg({header:d,payload:x,signature:A})})}var le=Ue(wn());var jg=Ue(Qt());var nt={};ii(nt,{DEFAULT_ERROR:()=>jn,IBaseJsonRpcProvider:()=>Do,IEvents:()=>Wi,IJsonRpcConnection:()=>Iu,IJsonRpcProvider:()=>$n,INTERNAL_ERROR:()=>Po,INVALID_PARAMS:()=>bg,INVALID_REQUEST:()=>_g,METHOD_NOT_FOUND:()=>wg,PARSE_ERROR:()=>mg,RESERVED_ERROR_CODES:()=>mu,SERVER_ERROR:()=>Fn,SERVER_ERROR_CODE_RANGE:()=>Ro,STANDARD_ERROR_MAP:()=>Ur,formatErrorMessage:()=>Dg,formatJsonRpcError:()=>_r,formatJsonRpcRequest:()=>mr,formatJsonRpcResult:()=>Gi,getBigIntRpcId:()=>zn,getError:()=>To,getErrorByCode:()=>Ao,isHttpUrl:()=>Fo,isJsonRpcError:()=>gt,isJsonRpcPayload:()=>Pu,isJsonRpcRequest:()=>Ji,isJsonRpcResponse:()=>Hr,isJsonRpcResult:()=>Ut,isJsonRpcValidationInvalid:()=>YS,isLocalhostUrl:()=>Su,isNodeJs:()=>Lg,isReservedErrorCode:()=>Oo,isServerErrorCode:()=>bS,isValidDefaultRoute:()=>No,isValidErrorCode:()=>Eg,isValidLeadingWildcardRoute:()=>kS,isValidRoute:()=>BS,isValidTrailingWildcardRoute:()=>KS,isValidWildcardRoute:()=>Lo,isWsUrl:()=>jo,parseConnectionError:()=>qn,payloadId:()=>Un,validateJsonRpcError:()=>ES});var mg="PARSE_ERROR",_g="INVALID_REQUEST",wg="METHOD_NOT_FOUND",bg="INVALID_PARAMS",Po="INTERNAL_ERROR",Fn="SERVER_ERROR",mu=[-32700,-32600,-32601,-32602,-32603],Ro=[-32e3,-32099],Ur={[mg]:{code:-32700,message:"Parse error"},[_g]:{code:-32600,message:"Invalid Request"},[wg]:{code:-32601,message:"Method not found"},[bg]:{code:-32602,message:"Invalid params"},[Po]:{code:-32603,message:"Internal error"},[Fn]:{code:-32e3,message:"Server error"}},jn=Fn;function bS(s){return s<=Ro[0]&&s>=Ro[1]}function Oo(s){return mu.includes(s)}function Eg(s){return typeof s=="number"}function To(s){return Object.keys(Ur).includes(s)?Ur[s]:Ur[jn]}function Ao(s){let t=Object.values(Ur).find(e=>e.code===s);return t||Ur[jn]}function ES(s){if(typeof s.error.code>"u")return{valid:!1,error:"Missing code for JSON-RPC error"};if(typeof s.error.message>"u")return{valid:!1,error:"Missing message for JSON-RPC error"};if(!Eg(s.error.code))return{valid:!1,error:`Invalid error code type for JSON-RPC: ${s.error.code}`};if(Oo(s.error.code)){let t=Ao(s.error.code);if(t.message!==Ur[jn].message&&s.error.message===t.message)return{valid:!1,error:`Invalid error code message for JSON-RPC: ${s.error.code}`}}return{valid:!0}}function qn(s,t,e){return s.message.includes("getaddrinfo ENOTFOUND")||s.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${e} RPC url at ${t}`):s}var dt={};ii(dt,{isNodeJs:()=>Lg});var Ng=Ue(xu());Ot(dt,Ue(xu()));var Lg=Ng.isNode;Ot(nt,dt);function Un(s=3){let t=Date.now()*Math.pow(10,s),e=Math.floor(Math.random()*Math.pow(10,s));return t+e}function zn(s=6){return BigInt(Un(s))}function mr(s,t,e){return{id:e||Un(),jsonrpc:"2.0",method:s,params:t}}function Gi(s,t){return{id:s,jsonrpc:"2.0",result:t}}function _r(s,t,e){return{id:s,jsonrpc:"2.0",error:Dg(t,e)}}function Dg(s,t){return typeof s>"u"?To(Po):(typeof s=="string"&&(s=Object.assign(Object.assign({},To(Fn)),{message:s})),typeof t<"u"&&(s.data=t),Oo(s.code)&&(s=Ao(s.code)),s)}function BS(s){return s.includes("*")?Lo(s):!/\W/g.test(s)}function No(s){return s==="*"}function Lo(s){return No(s)?!0:!(!s.includes("*")||s.split("*").length!==2||s.split("*").filter(t=>t.trim()==="").length!==1)}function kS(s){return!No(s)&&Lo(s)&&!s.split("*")[0].trim()}function KS(s){return!No(s)&&Lo(s)&&!s.split("*")[1].trim()}var Wi=class{};var Iu=class extends Wi{constructor(t){super()}},Do=class extends Wi{constructor(){super()}},$n=class extends Do{constructor(t){super()}};var GS="^https?:",WS="^wss?:";function JS(s){let t=s.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Fg(s,t){let e=JS(s);return typeof e>"u"?!1:new RegExp(t).test(e)}function Fo(s){return Fg(s,GS)}function jo(s){return Fg(s,WS)}function Su(s){return new RegExp("wss?://localhost(:d{2,5})?").test(s)}function Pu(s){return typeof s=="object"&&"id"in s&&"jsonrpc"in s&&s.jsonrpc==="2.0"}function Ji(s){return Pu(s)&&"method"in s}function Hr(s){return Pu(s)&&(Ut(s)||gt(s))}function Ut(s){return"result"in s}function gt(s){return"error"in s}function YS(s){return"error"in s&&s.valid===!1}var zt=class extends $n{constructor(t){super(t),this.events=new jg.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}connect(){return m(this,arguments,function*(t=this.connection){yield this.open(t)})}disconnect(){return m(this,null,function*(){yield this.close()})}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}request(t,e){return m(this,null,function*(){return this.requestStrict(mr(t.method,t.params||[],t.id||zn().toString()),e)})}requestStrict(t,e){return m(this,null,function*(){return new Promise((i,o)=>m(this,null,function*(){if(!this.connection.connected)try{yield this.open()}catch(c){o(c)}this.events.on(`${t.id}`,c=>{gt(c)?o(c.error):i(c.result)});try{yield this.connection.send(t,e)}catch(c){o(c)}}))})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Hr(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}open(){return m(this,arguments,function*(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(yield this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),yield this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))})}close(){return m(this,null,function*(){yield this.connection.close()})}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}};var Hg=Ue(Qt());var Ug=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:Mg(),zg=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u";var Ru=s=>s.split("?")[0];var $g=10,XS=Ug(),Ou=class{constructor(t){if(this.url=t,this.events=new Hg.EventEmitter,this.registering=!1,!jo(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}open(){return m(this,arguments,function*(t=this.url){yield this.register(t)})}close(){return m(this,null,function*(){return new Promise((t,e)=>{if(typeof this.socket>"u"){e(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),t()},this.socket.close()})})}send(t,e){return m(this,null,function*(){typeof this.socket>"u"&&(this.socket=yield this.register());try{this.socket.send(yr(t))}catch(i){this.onError(t.id,i)}})}register(t=this.url){if(!jo(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){let e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((i,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=t,this.registering=!0,new Promise((e,i)=>{let o=(0,nt.isReactNative)()?void 0:{rejectUnauthorized:!Su(t)},c=new XS(t,[],o);zg()?c.onerror=h=>{let f=h;i(this.emitError(f.error))}:c.on("error",h=>{i(this.emitError(h))}),c.onopen=()=>{this.onOpen(c),e(c)}})}onOpen(t){t.onmessage=e=>this.onPayload(e),t.onclose=e=>this.onClose(e),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;let e=typeof t.data=="string"?ni(t.data):t.data;this.events.emit("payload",e)}onError(t,e){let i=this.parseError(e),o=i.message||i.toString(),c=_r(t,o);this.events.emit("payload",c)}parseError(t,e=this.url){return qn(t,Ru(e),"WS")}resetMaxListeners(){this.events.getMaxListeners()>$g&&this.events.setMaxListeners($g)}emitError(t){let e=this.parseError(new Error(t?.message||`WebSocket connection failed for host: ${Ru(this.url)}`));return this.events.emit("register_error",e),e}},Vg=Ou;var Bg=Vg;var Ky=Ue(Sy());function OR(s,t){if(s.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),i=0;i<e.length;i++)e[i]=255;for(var o=0;o<s.length;o++){var c=s.charAt(o),h=c.charCodeAt(0);if(e[h]!==255)throw new TypeError(c+" is ambiguous");e[h]=o}var f=s.length,y=s.charAt(0),d=Math.log(f)/Math.log(256),w=Math.log(256)/Math.log(f);function S(A){if(A instanceof Uint8Array||(ArrayBuffer.isView(A)?A=new Uint8Array(A.buffer,A.byteOffset,A.byteLength):Array.isArray(A)&&(A=Uint8Array.from(A))),!(A instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(A.length===0)return"";for(var z=0,K=0,B=0,Z=A.length;B!==Z&&A[B]===0;)B++,z++;for(var H=(Z-B)*w+1>>>0,U=new Uint8Array(H);B!==Z;){for(var ee=A[B],ne=0,O=H-1;(ee!==0||ne<K)&&O!==-1;O--,ne++)ee+=256*U[O]>>>0,U[O]=ee%f>>>0,ee=ee/f>>>0;if(ee!==0)throw new Error("Non-zero carry");K=ne,B++}for(var N=H-K;N!==H&&U[N]===0;)N++;for(var re=y.repeat(z);N<H;++N)re+=s.charAt(U[N]);return re}function x(A){if(typeof A!="string")throw new TypeError("Expected String");if(A.length===0)return new Uint8Array;var z=0;if(A[z]!==" "){for(var K=0,B=0;A[z]===y;)K++,z++;for(var Z=(A.length-z)*d+1>>>0,H=new Uint8Array(Z);A[z];){var U=e[A.charCodeAt(z)];if(U===255)return;for(var ee=0,ne=Z-1;(U!==0||ee<B)&&ne!==-1;ne--,ee++)U+=f*H[ne]>>>0,H[ne]=U%256>>>0,U=U/256>>>0;if(U!==0)throw new Error("Non-zero carry");B=ee,z++}if(A[z]!==" "){for(var O=Z-B;O!==Z&&H[O]===0;)O++;for(var N=new Uint8Array(K+(Z-O)),re=K;O!==Z;)N[re++]=H[O++];return N}}}function T(A){var z=x(A);if(z)return z;throw new Error(`Non-${t} character`)}return{encode:S,decodeUnsafe:x,decode:T}}var TR=OR,AR=TR,Gy=s=>{if(s instanceof Uint8Array&&s.constructor.name==="Uint8Array")return s;if(s instanceof ArrayBuffer)return new Uint8Array(s);if(ArrayBuffer.isView(s))return new Uint8Array(s.buffer,s.byteOffset,s.byteLength);throw new Error("Unknown type, must be binary type")},CR=s=>new TextEncoder().encode(s),NR=s=>new TextDecoder().decode(s),Vu=class{constructor(t,e,i){this.name=t,this.prefix=e,this.baseEncode=i}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Bu=class{constructor(t,e,i){if(this.name=t,this.prefix=e,e.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=i}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Wy(this,t)}},ku=class{constructor(t){this.decoders=t}or(t){return Wy(this,t)}decode(t){let e=t[0],i=this.decoders[e];if(i)return i.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Wy=(s,t)=>new ku(ut(ut({},s.decoders||{[s.prefix]:s}),t.decoders||{[t.prefix]:t})),Ku=class{constructor(t,e,i,o){this.name=t,this.prefix=e,this.baseEncode=i,this.baseDecode=o,this.encoder=new Vu(t,e,i),this.decoder=new Bu(t,e,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},Wo=({name:s,prefix:t,encode:e,decode:i})=>new Ku(s,t,e,i),Yn=({prefix:s,name:t,alphabet:e})=>{let{encode:i,decode:o}=AR(e,t);return Wo({prefix:s,name:t,encode:i,decode:c=>Gy(o(c))})},LR=(s,t,e,i)=>{let o={};for(let w=0;w<t.length;++w)o[t[w]]=w;let c=s.length;for(;s[c-1]==="=";)--c;let h=new Uint8Array(c*e/8|0),f=0,y=0,d=0;for(let w=0;w<c;++w){let S=o[s[w]];if(S===void 0)throw new SyntaxError(`Non-${i} character`);y=y<<e|S,f+=e,f>=8&&(f-=8,h[d++]=255&y>>f)}if(f>=e||255&y<<8-f)throw new SyntaxError("Unexpected end of data");return h},DR=(s,t,e)=>{let i=t[t.length-1]==="=",o=(1<<e)-1,c="",h=0,f=0;for(let y=0;y<s.length;++y)for(f=f<<8|s[y],h+=8;h>e;)h-=e,c+=t[o&f>>h];if(h&&(c+=t[o&f<<e-h]),i)for(;c.length*e&7;)c+="=";return c},ot=({name:s,prefix:t,bitsPerChar:e,alphabet:i})=>Wo({prefix:t,name:s,encode(o){return DR(o,i,e)},decode(o){return LR(o,i,e,s)}}),FR=Wo({prefix:"\0",name:"identity",encode:s=>NR(s),decode:s=>CR(s)}),jR=Object.freeze({__proto__:null,identity:FR}),qR=ot({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),MR=Object.freeze({__proto__:null,base2:qR}),UR=ot({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),zR=Object.freeze({__proto__:null,base8:UR}),$R=Yn({prefix:"9",name:"base10",alphabet:"0123456789"}),HR=Object.freeze({__proto__:null,base10:$R}),VR=ot({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),BR=ot({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),kR=Object.freeze({__proto__:null,base16:VR,base16upper:BR}),KR=ot({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),GR=ot({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),WR=ot({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),JR=ot({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),YR=ot({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),XR=ot({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),QR=ot({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ZR=ot({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),eO=ot({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),tO=Object.freeze({__proto__:null,base32:KR,base32upper:GR,base32pad:WR,base32padupper:JR,base32hex:YR,base32hexupper:XR,base32hexpad:QR,base32hexpadupper:ZR,base32z:eO}),rO=Yn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),iO=Yn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),nO=Object.freeze({__proto__:null,base36:rO,base36upper:iO}),sO=Yn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),oO=Yn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),aO=Object.freeze({__proto__:null,base58btc:sO,base58flickr:oO}),cO=ot({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),uO=ot({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),hO=ot({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),lO=ot({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),fO=Object.freeze({__proto__:null,base64:cO,base64pad:uO,base64url:hO,base64urlpad:lO}),Jy=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),pO=Jy.reduce((s,t,e)=>(s[e]=t,s),[]),dO=Jy.reduce((s,t,e)=>(s[t.codePointAt(0)]=e,s),[]);function gO(s){return s.reduce((t,e)=>(t+=pO[e],t),"")}function yO(s){let t=[];for(let e of s){let i=dO[e.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${e}`);t.push(i)}return new Uint8Array(t)}var vO=Wo({prefix:"\u{1F680}",name:"base256emoji",encode:gO,decode:yO}),mO=Object.freeze({__proto__:null,base256emoji:vO}),_O=Yy,Py=128,wO=127,bO=~wO,EO=Math.pow(2,31);function Yy(s,t,e){t=t||[],e=e||0;for(var i=e;s>=EO;)t[e++]=s&255|Py,s/=128;for(;s&bO;)t[e++]=s&255|Py,s>>>=7;return t[e]=s|0,Yy.bytes=e-i+1,t}var xO=Gu,IO=128,Ry=127;function Gu(s,i){var e=0,i=i||0,o=0,c=i,h,f=s.length;do{if(c>=f)throw Gu.bytes=0,new RangeError("Could not decode varint");h=s[c++],e+=o<28?(h&Ry)<<o:(h&Ry)*Math.pow(2,o),o+=7}while(h>=IO);return Gu.bytes=c-i,e}var SO=Math.pow(2,7),PO=Math.pow(2,14),RO=Math.pow(2,21),OO=Math.pow(2,28),TO=Math.pow(2,35),AO=Math.pow(2,42),CO=Math.pow(2,49),NO=Math.pow(2,56),LO=Math.pow(2,63),DO=function(s){return s<SO?1:s<PO?2:s<RO?3:s<OO?4:s<TO?5:s<AO?6:s<CO?7:s<NO?8:s<LO?9:10},FO={encode:_O,decode:xO,encodingLength:DO},Xy=FO,Oy=(s,t,e=0)=>(Xy.encode(s,t,e),t),Ty=s=>Xy.encodingLength(s),Wu=(s,t)=>{let e=t.byteLength,i=Ty(s),o=i+Ty(e),c=new Uint8Array(o+e);return Oy(s,c,0),Oy(e,c,i),c.set(t,o),new Ju(s,e,t,c)},Ju=class{constructor(t,e,i,o){this.code=t,this.size=e,this.digest=i,this.bytes=o}},Qy=({name:s,code:t,encode:e})=>new Yu(s,t,e),Yu=class{constructor(t,e,i){this.name=t,this.code=e,this.encode=i}digest(t){if(t instanceof Uint8Array){let e=this.encode(t);return e instanceof Uint8Array?Wu(this.code,e):e.then(i=>Wu(this.code,i))}else throw Error("Unknown type, must be binary type")}},Zy=s=>t=>m(void 0,null,function*(){return new Uint8Array(yield crypto.subtle.digest(s,t))}),jO=Qy({name:"sha2-256",code:18,encode:Zy("SHA-256")}),qO=Qy({name:"sha2-512",code:19,encode:Zy("SHA-512")}),MO=Object.freeze({__proto__:null,sha256:jO,sha512:qO}),ev=0,UO="identity",tv=Gy,zO=s=>Wu(ev,tv(s)),$O={code:ev,name:UO,encode:tv,digest:zO},HO=Object.freeze({__proto__:null,identity:$O});new TextEncoder,new TextDecoder;var Ay=ut(ut(ut(ut(ut(ut(ut(ut(ut(ut({},jR),MR),zR),HR),kR),tO),nO),aO),fO),mO);ut(ut({},MO),HO);function rv(s){return globalThis.Buffer!=null?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):s}function VO(s=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?rv(globalThis.Buffer.allocUnsafe(s)):new Uint8Array(s)}function iv(s,t,e,i){return{name:s,prefix:t,encoder:{name:s,prefix:t,encode:e},decoder:{decode:i}}}var Cy=iv("utf8","u",s=>"u"+new TextDecoder("utf8").decode(s),s=>new TextEncoder().encode(s.substring(1))),zu=iv("ascii","a",s=>{let t="a";for(let e=0;e<s.length;e++)t+=String.fromCharCode(s[e]);return t},s=>{s=s.substring(1);let t=VO(s.length);for(let e=0;e<s.length;e++)t[e]=s.charCodeAt(e);return t}),BO=ut({utf8:Cy,"utf-8":Cy,hex:Ay.base16,latin1:zu,ascii:zu,binary:zu},Ay);function kO(s,t="utf8"){let e=BO[t];if(!e)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?rv(globalThis.Buffer.from(s,"utf-8")):e.decoder.decode(`${e.prefix}${s}`)}var nv="wc",KO=2,uh="core",kr=`${nv}@2:${uh}:`,GO={name:uh,logger:"error"},WO={database:":memory:"},JO="crypto",Ny="client_ed25519_seed",YO=le.ONE_DAY,XO="keychain",QO="0.3",ZO="messages",e6="0.3",t6=le.SIX_HOURS,r6="publisher",hh="irn",i6="error",sv="wss://relay.walletconnect.com",Ly="wss://relay.walletconnect.org",n6="relayer",st={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},s6="_subscription",Er={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},o6=le.ONE_SECOND;var a6="2.10.0",c6=1e4,u6="0.3",h6="WALLETCONNECT_CLIENT_ID",ir={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"};var l6="subscription",f6="0.3",p6=le.FIVE_SECONDS*1e3,d6="pairing",g6="0.3";var Gn={wc_pairingDelete:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:le.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:le.ONE_DAY,prompt:!1,tag:0},res:{ttl:le.ONE_DAY,prompt:!1,tag:0}}},rr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},y6="history",v6="0.3",m6="expirer",At={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},_6="0.3";var $u="verify-api",Jn="https://verify.walletconnect.com",Dy="https://verify.walletconnect.org",Xu=class{constructor(t,e){this.core=t,this.logger=e,this.keychain=new Map,this.name=XO,this.version=QO,this.initialized=!1,this.storagePrefix=kr,this.init=()=>m(this,null,function*(){if(!this.initialized){let i=yield this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}}),this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=(i,o)=>m(this,null,function*(){this.isInitialized(),this.keychain.set(i,o),yield this.persist()}),this.get=i=>{this.isInitialized();let o=this.keychain.get(i);if(typeof o>"u"){let{message:c}=V("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(c)}return o},this.del=i=>m(this,null,function*(){this.isInitialized(),this.keychain.delete(i),yield this.persist()}),this.core=t,this.logger=(0,fe.generateChildLogger)(e,this.name)}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}setKeyChain(t){return m(this,null,function*(){yield this.core.storage.setItem(this.storageKey,Pc(t))})}getKeyChain(){return m(this,null,function*(){let t=yield this.core.storage.getItem(this.storageKey);return typeof t<"u"?Rc(t):void 0})}persist(){return m(this,null,function*(){yield this.setKeyChain(this.keychain)})}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}},Qu=class{constructor(t,e,i){this.core=t,this.logger=e,this.name=JO,this.initialized=!1,this.init=()=>m(this,null,function*(){this.initialized||(yield this.keychain.init(),this.initialized=!0)}),this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=()=>m(this,null,function*(){this.isInitialized();let o=yield this.getClientSeed(),c=vu(o);return So(c.publicKey)}),this.generateKeyPair=()=>{this.isInitialized();let o=_p();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=o=>m(this,null,function*(){this.isInitialized();let c=yield this.getClientSeed(),h=vu(c),f=Gs();return yield vg(f,o,YO,h)}),this.generateSharedKey=(o,c,h)=>{this.isInitialized();let f=this.getPrivateKey(o),y=wp(f,c);return this.setSymKey(y,h)},this.setSymKey=(o,c)=>m(this,null,function*(){this.isInitialized();let h=c||bp(o);return yield this.keychain.set(h,o),h}),this.deleteKeyPair=o=>m(this,null,function*(){this.isInitialized(),yield this.keychain.del(o)}),this.deleteSymKey=o=>m(this,null,function*(){this.isInitialized(),yield this.keychain.del(o)}),this.encode=(o,c,h)=>m(this,null,function*(){this.isInitialized();let f=Pp(h),y=yr(c);if(Sc(f)){let x=f.senderPublicKey,T=f.receiverPublicKey;o=yield this.generateSharedKey(x,T)}let d=this.getSymKey(o),{type:w,senderPublicKey:S}=f;return xp({type:w,symKey:d,message:y,senderPublicKey:S})}),this.decode=(o,c,h)=>m(this,null,function*(){this.isInitialized();let f=Sp(c,h);if(Sc(f)){let y=f.receiverPublicKey,d=f.senderPublicKey;o=yield this.generateSharedKey(y,d)}try{let y=this.getSymKey(o),d=Ip({symKey:y,encoded:c});return ni(d)}catch(y){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${yield this.getClientId()}'`),this.logger.error(y)}}),this.getPayloadType=o=>{let c=Ic(o);return Ep(c.type)},this.getPayloadSenderPublicKey=o=>{let c=Ic(o);return c.senderPublicKey?Ni(c.senderPublicKey,mp):void 0},this.core=t,this.logger=(0,fe.generateChildLogger)(e,this.name),this.keychain=i||new Xu(this.core,this.logger)}get context(){return(0,fe.getLoggerContext)(this.logger)}setPrivateKey(t,e){return m(this,null,function*(){return yield this.keychain.set(t,e),t})}getPrivateKey(t){return this.keychain.get(t)}getClientSeed(){return m(this,null,function*(){let t="";try{t=this.keychain.get(Ny)}catch{t=Gs(),yield this.keychain.set(Ny,t)}return kO(t,"base16")})}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}},Zu=class extends go{constructor(t,e){super(t,e),this.logger=t,this.core=e,this.messages=new Map,this.name=ZO,this.version=e6,this.initialized=!1,this.storagePrefix=kr,this.init=()=>m(this,null,function*(){if(!this.initialized){this.logger.trace("Initialized");try{let i=yield this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}}),this.set=(i,o)=>m(this,null,function*(){this.isInitialized();let c=Fr(o),h=this.messages.get(i);return typeof h>"u"&&(h={}),typeof h[c]<"u"||(h[c]=o,this.messages.set(i,h),yield this.persist()),c}),this.get=i=>{this.isInitialized();let o=this.messages.get(i);return typeof o>"u"&&(o={}),o},this.has=(i,o)=>{this.isInitialized();let c=this.get(i),h=Fr(o);return typeof c[h]<"u"},this.del=i=>m(this,null,function*(){this.isInitialized(),this.messages.delete(i),yield this.persist()}),this.logger=(0,fe.generateChildLogger)(t,this.name),this.core=e}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}setRelayerMessages(t){return m(this,null,function*(){yield this.core.storage.setItem(this.storageKey,Pc(t))})}getRelayerMessages(){return m(this,null,function*(){let t=yield this.core.storage.getItem(this.storageKey);return typeof t<"u"?Rc(t):void 0})}persist(){return m(this,null,function*(){yield this.setRelayerMessages(this.messages)})}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}},eh=class extends yo{constructor(t,e){super(t,e),this.relayer=t,this.logger=e,this.events=new xr.EventEmitter,this.name=r6,this.queue=new Map,this.publishTimeout=(0,le.toMiliseconds)(le.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=(i,o,c)=>m(this,null,function*(){var h;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:o,opts:c}});try{let f=c?.ttl||t6,y=Xs(c),d=c?.prompt||!1,w=c?.tag||0,S=c?.id||zn().toString(),x={topic:i,message:o,opts:{ttl:f,relay:y,prompt:d,tag:w,id:S}},T=setTimeout(()=>this.queue.set(S,x),this.publishTimeout);try{yield yield Li(this.rpcPublish(i,o,f,y,d,w,S),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(S),this.relayer.events.emit(st.publish,x)}catch(A){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(h=c?.internal)!=null&&h.throwOnFailedPublish)throw this.removeRequestFromQueue(S),A;return}finally{clearTimeout(T)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:o,opts:c}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}}),this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.relayer=t,this.logger=(0,fe.generateChildLogger)(e,this.name),this.registerEventListeners()}get context(){return(0,fe.getLoggerContext)(this.logger)}rpcPublish(t,e,i,o,c,h,f){var y,d,w,S;let x={method:bn(o.protocol).publish,params:{topic:t,message:e,ttl:i,prompt:c,tag:h},id:f};return Xt((y=x.params)==null?void 0:y.prompt)&&((d=x.params)==null||delete d.prompt),Xt((w=x.params)==null?void 0:w.tag)&&((S=x.params)==null||delete S.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:x}),this.relayer.request(x)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(t=>m(this,null,function*(){let{topic:e,message:i,opts:o}=t;yield this.publish(e,i,o)}))}registerEventListeners(){this.relayer.core.heartbeat.on(pi.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(st.connection_stalled);return}this.checkQueue()}),this.relayer.on(st.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}},th=class{constructor(){this.map=new Map,this.set=(t,e)=>{let i=this.get(t);this.exists(t,e)||this.map.set(t,[...i,e])},this.get=t=>this.map.get(t)||[],this.exists=(t,e)=>this.get(t).includes(e),this.delete=(t,e)=>{if(typeof e>"u"){this.map.delete(t);return}if(!this.map.has(t))return;let i=this.get(t);if(!this.exists(t,e))return;let o=i.filter(c=>c!==e);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}},w6=Object.defineProperty,b6=Object.defineProperties,E6=Object.getOwnPropertyDescriptors,Fy=Object.getOwnPropertySymbols,x6=Object.prototype.hasOwnProperty,I6=Object.prototype.propertyIsEnumerable,jy=(s,t,e)=>t in s?w6(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,Wn=(s,t)=>{for(var e in t||(t={}))x6.call(t,e)&&jy(s,e,t[e]);if(Fy)for(var e of Fy(t))I6.call(t,e)&&jy(s,e,t[e]);return s},Hu=(s,t)=>b6(s,E6(t)),rh=class extends _o{constructor(t,e){super(t,e),this.relayer=t,this.logger=e,this.subscriptions=new Map,this.topicMap=new th,this.events=new xr.EventEmitter,this.name=l6,this.version=f6,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=kr,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=()=>m(this,null,function*(){this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=yield this.relayer.core.crypto.getClientId())}),this.subscribe=(i,o)=>m(this,null,function*(){yield this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:o}});try{let c=Xs(o),h={topic:i,relay:c};this.pending.set(i,h);let f=yield this.rpcSubscribe(i,c);return this.onSubscribe(f,h),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:o}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}}),this.unsubscribe=(i,o)=>m(this,null,function*(){yield this.restartToComplete(),this.isInitialized(),typeof o?.id<"u"?yield this.unsubscribeById(i,o.id,o):yield this.unsubscribeByTopic(i,o)}),this.isSubscribed=i=>m(this,null,function*(){return this.topics.includes(i)?!0:yield new Promise((o,c)=>{let h=new le.Watch;h.start(this.pendingSubscriptionWatchLabel);let f=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(f),h.stop(this.pendingSubscriptionWatchLabel),o(!0)),h.elapsed(this.pendingSubscriptionWatchLabel)>=p6&&(clearInterval(f),h.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)}),this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.restart=()=>m(this,null,function*(){this.restartInProgress=!0,yield this.restore(),yield this.reset(),this.restartInProgress=!1}),this.relayer=t,this.logger=(0,fe.generateChildLogger)(e,this.name),this.clientId=""}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,e){let i=!1;try{i=this.getSubscription(t).topic===e}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}unsubscribeByTopic(t,e){return m(this,null,function*(){let i=this.topicMap.get(t);yield Promise.all(i.map(o=>m(this,null,function*(){return yield this.unsubscribeById(t,o,e)})))})}unsubscribeById(t,e,i){return m(this,null,function*(){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:e,opts:i}});try{let o=Xs(i);yield this.rpcUnsubscribe(t,e,o);let c=Ze("USER_DISCONNECTED",`${this.name}, ${t}`);yield this.onUnsubscribe(t,e,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:e,opts:i}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}})}rpcSubscribe(t,e){return m(this,null,function*(){let i={method:bn(e.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{yield yield Li(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(st.connection_stalled)}return Fr(t+this.clientId)})}rpcBatchSubscribe(t){return m(this,null,function*(){if(!t.length)return;let e=t[0].relay,i={method:bn(e.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return yield yield Li(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(st.connection_stalled)}})}rpcUnsubscribe(t,e,i){let o={method:bn(i.protocol).unsubscribe,params:{topic:t,id:e}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,e){this.setSubscription(t,Hu(Wn({},e),{id:t})),this.pending.delete(e.topic)}onBatchSubscribe(t){t.length&&t.forEach(e=>{this.setSubscription(e.id,Wn({},e)),this.pending.delete(e.topic)})}onUnsubscribe(t,e,i){return m(this,null,function*(){this.events.removeAllListeners(e),this.hasSubscription(e,t)&&this.deleteSubscription(e,i),yield this.relayer.messages.del(t)})}setRelayerSubscriptions(t){return m(this,null,function*(){yield this.relayer.core.storage.setItem(this.storageKey,t)})}getRelayerSubscriptions(){return m(this,null,function*(){return yield this.relayer.core.storage.getItem(this.storageKey)})}setSubscription(t,e){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:e}),this.addSubscription(t,e))}addSubscription(t,e){this.subscriptions.set(t,Wn({},e)),this.topicMap.set(e.topic,t),this.events.emit(ir.created,e)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});let e=this.subscriptions.get(t);if(!e){let{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(i)}return e}deleteSubscription(t,e){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:e});let i=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(i.topic,t),this.events.emit(ir.deleted,Hu(Wn({},i),{reason:e}))}persist(){return m(this,null,function*(){yield this.setRelayerSubscriptions(this.values),this.events.emit(ir.sync)})}reset(){return m(this,null,function*(){if(this.cached.length){let t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let e=0;e<t;e++){let i=this.cached.splice(0,this.batchSubscribeTopicsLimit);yield this.batchSubscribe(i)}}this.events.emit(ir.resubscribed)})}restore(){return m(this,null,function*(){try{let t=yield this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){let{message:e}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}})}batchSubscribe(t){return m(this,null,function*(){if(!t.length)return;let e=yield this.rpcBatchSubscribe(t);gr(e)&&this.onBatchSubscribe(e.map((i,o)=>Hu(Wn({},t[o]),{id:i})))})}onConnect(){return m(this,null,function*(){this.restartInProgress||(yield this.restart(),this.onEnable())})}onDisconnect(){this.onDisable()}checkPending(){return m(this,null,function*(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;let t=[];this.pending.forEach(e=>{t.push(e)}),yield this.batchSubscribe(t)})}registerEventListeners(){this.relayer.core.heartbeat.on(pi.HEARTBEAT_EVENTS.pulse,()=>m(this,null,function*(){yield this.checkPending()})),this.relayer.on(st.connect,()=>m(this,null,function*(){yield this.onConnect()})),this.relayer.on(st.disconnect,()=>{this.onDisconnect()}),this.events.on(ir.created,t=>m(this,null,function*(){let e=ir.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),yield this.persist()})),this.events.on(ir.deleted,t=>m(this,null,function*(){let e=ir.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),yield this.persist()}))}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}restartToComplete(){return m(this,null,function*(){this.restartInProgress&&(yield new Promise(t=>{let e=setInterval(()=>{this.restartInProgress||(clearInterval(e),t())},this.pollingInterval)}))})}},S6=Object.defineProperty,qy=Object.getOwnPropertySymbols,P6=Object.prototype.hasOwnProperty,R6=Object.prototype.propertyIsEnumerable,My=(s,t,e)=>t in s?S6(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,O6=(s,t)=>{for(var e in t||(t={}))P6.call(t,e)&&My(s,e,t[e]);if(qy)for(var e of qy(t))R6.call(t,e)&&My(s,e,t[e]);return s},ih=class extends vo{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new xr.EventEmitter,this.name=n6,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=e=>m(this,null,function*(){this.logger.debug("Publishing Request Payload");try{return yield this.toEstablishConnection(),yield this.provider.request(e)}catch(i){throw this.logger.debug("Failed to Publish Request"),this.logger.error(i),i}}),this.onPayloadHandler=e=>{this.onProviderPayload(e)},this.onConnectHandler=()=>{this.events.emit(st.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=e=>{this.logger.error(e),this.events.emit(st.error,e)},this.registerProviderListeners=()=>{this.provider.on(Er.payload,this.onPayloadHandler),this.provider.on(Er.connect,this.onConnectHandler),this.provider.on(Er.disconnect,this.onDisconnectHandler),this.provider.on(Er.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?(0,fe.generateChildLogger)(t.logger,this.name):(0,fe.pino)((0,fe.getDefaultLoggerOptions)({level:t.logger||i6})),this.messages=new Zu(this.logger,t.core),this.subscriber=new rh(this,this.logger),this.publisher=new eh(this,this.logger),this.relayUrl=t?.relayUrl||sv,this.projectId=t.projectId,this.provider={}}init(){return m(this,null,function*(){this.logger.trace("Initialized"),this.registerEventListeners(),yield this.createProvider(),yield Promise.all([this.messages.init(),this.subscriber.init()]);try{yield this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Ly}...`),yield this.restartTransport(Ly)}this.initialized=!0,setTimeout(()=>m(this,null,function*(){this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),yield this.transportClose(),this.transportExplicitlyClosed=!1)}),c6)})}get context(){return(0,fe.getLoggerContext)(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}publish(t,e,i){return m(this,null,function*(){this.isInitialized(),yield this.publisher.publish(t,e,i),yield this.recordMessageEvent({topic:t,message:e,publishedAt:Date.now()})})}subscribe(t,e){return m(this,null,function*(){var i;this.isInitialized();let o=((i=this.subscriber.topicMap.get(t))==null?void 0:i[0])||"";return o||(yield Promise.all([new Promise(c=>{this.subscriber.once(ir.created,h=>{h.topic===t&&c()})}),new Promise(c=>m(this,null,function*(){o=yield this.subscriber.subscribe(t,e),c()}))]),o)})}unsubscribe(t,e){return m(this,null,function*(){this.isInitialized(),yield this.subscriber.unsubscribe(t,e)})}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}transportClose(){return m(this,null,function*(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?yield Li(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&(yield this.provider.disconnect())})}transportOpen(t){return m(this,null,function*(){if(this.transportExplicitlyClosed=!1,yield this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,yield this.transportClose(),yield this.createProvider()),this.connectionAttemptInProgress=!0;try{yield Promise.all([new Promise(e=>{if(!this.initialized)return e();this.subscriber.once(ir.resubscribed,()=>{e()})}),new Promise((e,i)=>m(this,null,function*(){try{yield Li(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){i(o);return}e()}))])}catch(e){this.logger.error(e);let i=e;if(!this.isConnectionStalled(i.message))throw e;this.provider.events.emit(Er.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}})}restartTransport(t){return m(this,null,function*(){yield this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,yield this.transportClose(),yield this.createProvider(),yield this.transportOpen())})}confirmOnlineStateOrThrow(){return m(this,null,function*(){if(!(yield Cc()))throw new Error("No internet connection detected. Please restart your network and try again.")})}isConnectionStalled(t){return this.staleConnectionErrors.some(e=>t.includes(e))}createProvider(){return m(this,null,function*(){this.provider.connection&&this.unregisterProviderListeners();let t=yield this.core.crypto.signJWT(this.relayUrl);this.provider=new zt(new Bg(Ap({sdkVersion:a6,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()})}recordMessageEvent(t){return m(this,null,function*(){let{topic:e,message:i}=t;yield this.messages.set(e,i)})}shouldIgnoreMessageEvent(t){return m(this,null,function*(){let{topic:e,message:i}=t;if(!i||i.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${i}`),!0;if(!(yield this.subscriber.isSubscribed(e)))return this.logger.debug(`Ignoring message for non-subscribed topic ${e}`),!0;let o=this.messages.has(e,i);return o&&this.logger.debug(`Ignoring duplicate message: ${i}`),o})}onProviderPayload(t){return m(this,null,function*(){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Ji(t)){if(!t.method.endsWith(s6))return;let e=t.params,{topic:i,message:o,publishedAt:c}=e.data,h={topic:i,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(O6({type:"event",event:e.id},h)),this.events.emit(e.id,h),yield this.acknowledgePayload(t),yield this.onMessageEvent(h)}else Hr(t)&&this.events.emit(st.message_ack,t)})}onMessageEvent(t){return m(this,null,function*(){(yield this.shouldIgnoreMessageEvent(t))||(this.events.emit(st.message,t),yield this.recordMessageEvent(t))})}acknowledgePayload(t){return m(this,null,function*(){let e=Gi(t.id,!0);yield this.provider.connection.send(e)})}unregisterProviderListeners(){this.provider.off(Er.payload,this.onPayloadHandler),this.provider.off(Er.connect,this.onConnectHandler),this.provider.off(Er.disconnect,this.onDisconnectHandler),this.provider.off(Er.error,this.onProviderErrorHandler)}registerEventListeners(){return m(this,null,function*(){this.events.on(st.connection_stalled,()=>{this.restartTransport().catch(e=>this.logger.error(e))});let t=yield Cc();Zp(e=>m(this,null,function*(){this.initialized&&t!==e&&(t=e,e?yield this.restartTransport().catch(i=>this.logger.error(i)):(this.hasExperiencedNetworkDisruption=!0,yield this.transportClose().catch(i=>this.logger.error(i))))}))})}onProviderDisconnect(){this.events.emit(st.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(()=>m(this,null,function*(){yield this.restartTransport().catch(t=>this.logger.error(t))}),(0,le.toMiliseconds)(o6)))}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}toEstablishConnection(){return m(this,null,function*(){if(yield this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return yield new Promise(t=>{let e=setInterval(()=>{this.connected&&(clearInterval(e),t())},this.connectionStatusPollingInterval)});yield this.restartTransport()}})}},T6=Object.defineProperty,Uy=Object.getOwnPropertySymbols,A6=Object.prototype.hasOwnProperty,C6=Object.prototype.propertyIsEnumerable,zy=(s,t,e)=>t in s?T6(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,$y=(s,t)=>{for(var e in t||(t={}))A6.call(t,e)&&zy(s,e,t[e]);if(Uy)for(var e of Uy(t))C6.call(t,e)&&zy(s,e,t[e]);return s},fi=class extends mo{constructor(t,e,i,o=kr,c=void 0){super(t,e,i,o),this.core=t,this.logger=e,this.name=i,this.map=new Map,this.version=u6,this.cached=[],this.initialized=!1,this.storagePrefix=kr,this.init=()=>m(this,null,function*(){this.initialized||(this.logger.trace("Initialized"),yield this.restore(),this.cached.forEach(h=>{this.getKey&&h!==null&&!Xt(h)?this.map.set(this.getKey(h),h):Up(h)?this.map.set(h.id,h):zp(h)&&this.map.set(h.topic,h)}),this.cached=[],this.initialized=!0)}),this.set=(h,f)=>m(this,null,function*(){this.isInitialized(),this.map.has(h)?yield this.update(h,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:h,value:f}),this.map.set(h,f),yield this.persist())}),this.get=h=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:h}),this.getData(h)),this.getAll=h=>(this.isInitialized(),h?this.values.filter(f=>Object.keys(h).every(y=>(0,Ky.default)(f[y],h[y]))):this.values),this.update=(h,f)=>m(this,null,function*(){this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:h,update:f});let y=$y($y({},this.getData(h)),f);this.map.set(h,y),yield this.persist()}),this.delete=(h,f)=>m(this,null,function*(){this.isInitialized(),this.map.has(h)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:h,reason:f}),this.map.delete(h),yield this.persist())}),this.logger=(0,fe.generateChildLogger)(e,this.name),this.storagePrefix=o,this.getKey=c}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}setDataStore(t){return m(this,null,function*(){yield this.core.storage.setItem(this.storageKey,t)})}getDataStore(){return m(this,null,function*(){return yield this.core.storage.getItem(this.storageKey)})}getData(t){let e=this.map.get(t);if(!e){let{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(i),new Error(i)}return e}persist(){return m(this,null,function*(){yield this.setDataStore(this.values)})}restore(){return m(this,null,function*(){try{let t=yield this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){let{message:e}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}})}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}},nh=class{constructor(t,e){this.core=t,this.logger=e,this.name=d6,this.version=g6,this.events=new xr.default,this.initialized=!1,this.storagePrefix=kr,this.ignoredPayloadTypes=[Ks],this.registeredMethods=[],this.init=()=>m(this,null,function*(){this.initialized||(yield this.pairings.init(),yield this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=()=>m(this,null,function*(){this.isInitialized();let i=Gs(),o=yield this.core.crypto.setSymKey(i),c=Tt(le.FIVE_MINUTES),h={protocol:hh},f={topic:o,expiry:c,relay:h,active:!1},y=Fp({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:i,relay:h});return yield this.pairings.set(o,f),yield this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:y}}),this.pair=i=>m(this,null,function*(){this.isInitialized(),this.isValidPair(i);let{topic:o,symKey:c,relay:h}=Dp(i.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);let f=Tt(le.FIVE_MINUTES),y={topic:o,relay:h,expiry:f,active:!1};return yield this.pairings.set(o,y),yield this.core.crypto.setSymKey(c,o),yield this.core.relayer.subscribe(o,{relay:h}),this.core.expirer.set(o,f),i.activatePairing&&(yield this.activate({topic:o})),y}),this.activate=o=>m(this,[o],function*({topic:i}){this.isInitialized();let c=Tt(le.THIRTY_DAYS);yield this.pairings.update(i,{active:!0,expiry:c}),this.core.expirer.set(i,c)}),this.ping=i=>m(this,null,function*(){this.isInitialized(),yield this.isValidPing(i);let{topic:o}=i;if(this.pairings.keys.includes(o)){let c=yield this.sendRequest(o,"wc_pairingPing",{}),{done:h,resolve:f,reject:y}=jr();this.events.once(ze("pairing_ping",c),({error:d})=>{d?y(d):f()}),yield h()}}),this.updateExpiry=c=>m(this,[c],function*({topic:i,expiry:o}){this.isInitialized(),yield this.pairings.update(i,{expiry:o})}),this.updateMetadata=c=>m(this,[c],function*({topic:i,metadata:o}){this.isInitialized(),yield this.pairings.update(i,{peerMetadata:o})}),this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=i=>m(this,null,function*(){this.isInitialized(),yield this.isValidDisconnect(i);let{topic:o}=i;this.pairings.keys.includes(o)&&(yield this.sendRequest(o,"wc_pairingDelete",Ze("USER_DISCONNECTED")),yield this.deletePairing(o))}),this.sendRequest=(i,o,c)=>m(this,null,function*(){let h=mr(o,c),f=yield this.core.crypto.encode(i,h),y=Gn[o].req;return this.core.history.set(i,h),this.core.relayer.publish(i,f,y),h.id}),this.sendResult=(i,o,c)=>m(this,null,function*(){let h=Gi(i,c),f=yield this.core.crypto.encode(o,h),y=yield this.core.history.get(o,i),d=Gn[y.request.method].res;yield this.core.relayer.publish(o,f,d),yield this.core.history.resolve(h)}),this.sendError=(i,o,c)=>m(this,null,function*(){let h=_r(i,c),f=yield this.core.crypto.encode(o,h),y=yield this.core.history.get(o,i),d=Gn[y.request.method]?Gn[y.request.method].res:Gn.unregistered_method.res;yield this.core.relayer.publish(o,f,d),yield this.core.history.resolve(h)}),this.deletePairing=(i,o)=>m(this,null,function*(){yield this.core.relayer.unsubscribe(i),yield Promise.all([this.pairings.delete(i,Ze("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),o?Promise.resolve():this.core.expirer.del(i)])}),this.cleanup=()=>m(this,null,function*(){let i=this.pairings.getAll().filter(o=>Yt(o.expiry));yield Promise.all(i.map(o=>this.deletePairing(o.topic)))}),this.onRelayEventRequest=i=>{let{topic:o,payload:c}=i;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=i=>m(this,null,function*(){let{topic:o,payload:c}=i,h=(yield this.core.history.get(o,c.id)).request.method;switch(h){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(h)}}),this.onPairingPingRequest=(i,o)=>m(this,null,function*(){let{id:c}=o;try{this.isValidPing({topic:i}),yield this.sendResult(c,i,!0),this.events.emit("pairing_ping",{id:c,topic:i})}catch(h){yield this.sendError(c,i,h),this.logger.error(h)}}),this.onPairingPingResponse=(i,o)=>{let{id:c}=o;setTimeout(()=>{Ut(o)?this.events.emit(ze("pairing_ping",c),{}):gt(o)&&this.events.emit(ze("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=(i,o)=>m(this,null,function*(){let{id:c}=o;try{this.isValidDisconnect({topic:i}),yield this.deletePairing(i),this.events.emit("pairing_delete",{id:c,topic:i})}catch(h){yield this.sendError(c,i,h),this.logger.error(h)}}),this.onUnknownRpcMethodRequest=(i,o)=>m(this,null,function*(){let{id:c,method:h}=o;try{if(this.registeredMethods.includes(h))return;let f=Ze("WC_METHOD_UNSUPPORTED",h);yield this.sendError(c,i,f),this.logger.error(f)}catch(f){yield this.sendError(c,i,f),this.logger.error(f)}}),this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Ze("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!ht(i)){let{message:o}=V("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(o)}if(!Mp(i.uri)){let{message:o}=V("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(o)}},this.isValidPing=i=>m(this,null,function*(){if(!ht(i)){let{message:c}=V("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(c)}let{topic:o}=i;yield this.isValidPairingTopic(o)}),this.isValidDisconnect=i=>m(this,null,function*(){if(!ht(i)){let{message:c}=V("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(c)}let{topic:o}=i;yield this.isValidPairingTopic(o)}),this.isValidPairingTopic=i=>m(this,null,function*(){if(!qr(i,!1)){let{message:o}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(o)}if(!this.pairings.keys.includes(i)){let{message:o}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(o)}if(Yt(this.pairings.get(i).expiry)){yield this.deletePairing(i);let{message:o}=V("EXPIRED",`pairing topic: ${i}`);throw new Error(o)}}),this.core=t,this.logger=(0,fe.generateChildLogger)(e,this.name),this.pairings=new fi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,fe.getLoggerContext)(this.logger)}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(st.message,t=>m(this,null,function*(){let{topic:e,message:i}=t;if(!this.pairings.keys.includes(e)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;let o=yield this.core.crypto.decode(e,i);try{Ji(o)?(this.core.history.set(e,o),this.onRelayEventRequest({topic:e,payload:o})):Hr(o)&&(yield this.core.history.resolve(o),yield this.onRelayEventResponse({topic:e,payload:o}),this.core.history.delete(e,o.id))}catch(c){this.logger.error(c)}}))}registerExpirerEvents(){this.core.expirer.on(At.expired,t=>m(this,null,function*(){let{topic:e}=Js(t.target);e&&this.pairings.keys.includes(e)&&(yield this.deletePairing(e,!0),this.events.emit("pairing_expire",{topic:e}))}))}},sh=class extends po{constructor(t,e){super(t,e),this.core=t,this.logger=e,this.records=new Map,this.events=new xr.EventEmitter,this.name=y6,this.version=v6,this.cached=[],this.initialized=!1,this.storagePrefix=kr,this.init=()=>m(this,null,function*(){this.initialized||(this.logger.trace("Initialized"),yield this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),this.set=(i,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:o,chainId:c}),this.records.has(o.id))return;let h={id:o.id,topic:i,request:{method:o.method,params:o.params||null},chainId:c,expiry:Tt(le.THIRTY_DAYS)};this.records.set(h.id,h),this.events.emit(rr.created,h)},this.resolve=i=>m(this,null,function*(){if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;let o=yield this.getRecord(i.id);typeof o.response>"u"&&(o.response=gt(i)?{error:i.error}:{result:i.result},this.records.set(o.id,o),this.events.emit(rr.updated,o))}),this.get=(i,o)=>m(this,null,function*(){return this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:o}),yield this.getRecord(o)}),this.delete=(i,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===i){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(rr.deleted,c)}})},this.exists=(i,o)=>m(this,null,function*(){return this.isInitialized(),this.records.has(o)?(yield this.getRecord(o)).topic===i:!1}),this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.logger=(0,fe.generateChildLogger)(e,this.name)}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let t=[];return this.values.forEach(e=>{if(typeof e.response<"u")return;let i={topic:e.topic,request:mr(e.request.method,e.request.params,e.id),chainId:e.chainId};return t.push(i)}),t}setJsonRpcRecords(t){return m(this,null,function*(){yield this.core.storage.setItem(this.storageKey,t)})}getJsonRpcRecords(){return m(this,null,function*(){return yield this.core.storage.getItem(this.storageKey)})}getRecord(t){this.isInitialized();let e=this.records.get(t);if(!e){let{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(i)}return e}persist(){return m(this,null,function*(){yield this.setJsonRpcRecords(this.values),this.events.emit(rr.sync)})}restore(){return m(this,null,function*(){try{let t=yield this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){let{message:e}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}})}registerEventListeners(){this.events.on(rr.created,t=>{let e=rr.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t}),this.persist()}),this.events.on(rr.updated,t=>{let e=rr.updated;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t}),this.persist()}),this.events.on(rr.deleted,t=>{let e=rr.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t}),this.persist()}),this.core.heartbeat.on(pi.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{(0,le.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}},oh=class extends wo{constructor(t,e){super(t,e),this.core=t,this.logger=e,this.expirations=new Map,this.events=new xr.EventEmitter,this.name=m6,this.version=_6,this.cached=[],this.initialized=!1,this.storagePrefix=kr,this.init=()=>m(this,null,function*(){this.initialized||(this.logger.trace("Initialized"),yield this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),this.has=i=>{try{let o=this.formatTarget(i);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(i,o)=>{this.isInitialized();let c=this.formatTarget(i),h={target:c,expiry:o};this.expirations.set(c,h),this.checkExpiry(c,h),this.events.emit(At.created,{target:c,expiration:h})},this.get=i=>{this.isInitialized();let o=this.formatTarget(i);return this.getExpiration(o)},this.del=i=>{if(this.isInitialized(),this.has(i)){let o=this.formatTarget(i),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(At.deleted,{target:o,expiration:c})}},this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.logger=(0,fe.generateChildLogger)(e,this.name)}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Cp(t);if(typeof t=="number")return Np(t);let{message:e}=V("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(e)}setExpirations(t){return m(this,null,function*(){yield this.core.storage.setItem(this.storageKey,t)})}getExpirations(){return m(this,null,function*(){return yield this.core.storage.getItem(this.storageKey)})}persist(){return m(this,null,function*(){yield this.setExpirations(this.values),this.events.emit(At.sync)})}restore(){return m(this,null,function*(){try{let t=yield this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){let{message:e}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}})}getExpiration(t){let e=this.expirations.get(t);if(!e){let{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(i),new Error(i)}return e}checkExpiry(t,e){let{expiry:i}=e;(0,le.toMiliseconds)(i)-Date.now()<=0&&this.expire(t,e)}expire(t,e){this.expirations.delete(t),this.events.emit(At.expired,{target:t,expiration:e})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,e)=>this.checkExpiry(e,t))}registerEventListeners(){this.core.heartbeat.on(pi.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(At.created,t=>{let e=At.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()}),this.events.on(At.expired,t=>{let e=At.expired;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()}),this.events.on(At.deleted,t=>{let e=At.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()})}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}},ah=class extends bo{constructor(t,e){super(t,e),this.projectId=t,this.logger=e,this.name=$u,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=i=>m(this,null,function*(){if(this.verifyDisabled||Op()||!Ws())return;let o=i?.verifyUrl||Jn;this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{yield this.createIframe()}catch(c){this.logger.warn(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.warn(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Dy;try{yield this.createIframe()}catch(c){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(c),this.verifyDisabled=!0}}}),this.register=i=>m(this,null,function*(){this.initialized?this.sendPost(i.attestationId):(this.addToQueue(i.attestationId),yield this.init())}),this.resolve=i=>m(this,null,function*(){if(this.isDevEnv)return"";let o=i?.verifyUrl||Jn,c="";try{c=yield this.fetchAttestation(i.attestationId,o)}catch(h){this.logger.warn(`failed to resolve attestation: ${i.attestationId} from url: ${o}`),this.logger.warn(h),c=yield this.fetchAttestation(i.attestationId,Dy)}return c}),this.fetchAttestation=(i,o)=>m(this,null,function*(){var c;this.logger.info(`resolving attestation: ${i} from url: ${o}`);let h=this.startAbortTimer(le.ONE_SECOND*2),f=yield fetch(`${o}/attestation/${i}`,{signal:this.abortController.signal});return clearTimeout(h),f.status===200?(c=yield f.json())==null?void 0:c.origin:""}),this.addToQueue=i=>{this.queue.push(i)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(i=>this.sendPost(i)),this.queue=[])},this.sendPost=i=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(i,"*"),this.logger.info(`postMessage sent: ${i} ${this.verifyUrl}`)}catch{}},this.createIframe=()=>m(this,null,function*(){let i,o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),i())};yield Promise.race([new Promise(c=>{if(document.getElementById($u))return c();window.addEventListener("message",o);let h=document.createElement("iframe");h.id=$u,h.src=`${this.verifyUrl}/${this.projectId}`,h.style.display="none",document.body.append(h),this.iframe=h,i=c}),new Promise((c,h)=>setTimeout(()=>{window.removeEventListener("message",o),h("verify iframe load timeout")},(0,le.toMiliseconds)(le.FIVE_SECONDS)))])}),this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=(0,fe.generateChildLogger)(e,this.name),this.verifyUrl=Jn,this.abortController=new AbortController,this.isDevEnv=Rp()&&process.env.IS_VITEST}get context(){return(0,fe.getLoggerContext)(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,le.toMiliseconds)(t))}},N6=Object.defineProperty,Hy=Object.getOwnPropertySymbols,L6=Object.prototype.hasOwnProperty,D6=Object.prototype.propertyIsEnumerable,Vy=(s,t,e)=>t in s?N6(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,By=(s,t)=>{for(var e in t||(t={}))L6.call(t,e)&&Vy(s,e,t[e]);if(Hy)for(var e of Hy(t))D6.call(t,e)&&Vy(s,e,t[e]);return s},ch=class s extends fo{constructor(t){super(t),this.protocol=nv,this.version=KO,this.name=uh,this.events=new xr.EventEmitter,this.initialized=!1,this.on=(i,o)=>this.events.on(i,o),this.once=(i,o)=>this.events.once(i,o),this.off=(i,o)=>this.events.off(i,o),this.removeListener=(i,o)=>this.events.removeListener(i,o),this.projectId=t?.projectId,this.relayUrl=t?.relayUrl||sv;let e=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:(0,fe.pino)((0,fe.getDefaultLoggerOptions)({level:t?.logger||GO.logger}));this.logger=(0,fe.generateChildLogger)(e,this.name),this.heartbeat=new pi.HeartBeat,this.crypto=new Qu(this,this.logger,t?.keychain),this.history=new sh(this,this.logger),this.expirer=new oh(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new ky.default(By(By({},WO),t?.storageOptions)),this.relayer=new ih({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new nh(this,this.logger),this.verify=new ah(this.projectId||"",this.logger)}static init(t){return m(this,null,function*(){let e=new s(t);yield e.initialize();let i=yield e.crypto.getClientId();return yield e.storage.setItem(h6,i),e})}get context(){return(0,fe.getLoggerContext)(this.logger)}start(){return m(this,null,function*(){this.initialized||(yield this.initialize())})}initialize(){return m(this,null,function*(){this.logger.trace("Initialized");try{yield this.crypto.init(),yield this.history.init(),yield this.expirer.init(),yield this.relayer.init(),yield this.heartbeat.init(),yield this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}})}},ov=ch;var Kr=Ue(lo());var Xo=Ue(Qt()),pe=Ue(wn());var hv="wc",lv=2,fv="client",vh=`${hv}@${lv}:${fv}:`,lh={name:fv,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"};var av="WALLETCONNECT_DEEPLINK_CHOICE";var F6="proposal";var mh="Proposal expired",j6="session",Jo=pe.SEVEN_DAYS,q6="engine",Xn={wc_sessionPropose:{req:{ttl:pe.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:pe.ONE_DAY,prompt:!1,tag:1104},res:{ttl:pe.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:pe.ONE_DAY,prompt:!1,tag:1106},res:{ttl:pe.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:pe.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:pe.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:pe.ONE_DAY,prompt:!1,tag:1112},res:{ttl:pe.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:pe.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:pe.THIRTY_SECONDS,prompt:!1,tag:1115}}},fh={min:pe.FIVE_MINUTES,max:pe.SEVEN_DAYS},Ir={idle:"IDLE",active:"ACTIVE"},M6="request",U6=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"],z6=Object.defineProperty,$6=Object.defineProperties,H6=Object.getOwnPropertyDescriptors,cv=Object.getOwnPropertySymbols,V6=Object.prototype.hasOwnProperty,B6=Object.prototype.propertyIsEnumerable,uv=(s,t,e)=>t in s?z6(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,bt=(s,t)=>{for(var e in t||(t={}))V6.call(t,e)&&uv(s,e,t[e]);if(cv)for(var e of cv(t))B6.call(t,e)&&uv(s,e,t[e]);return s},Qn=(s,t)=>$6(s,H6(t)),ph=class extends xo{constructor(t){super(t),this.name=q6,this.events=new Xo.default,this.initialized=!1,this.ignoredPayloadTypes=[Ks],this.requestQueue={state:Ir.idle,queue:[]},this.sessionRequestQueue={state:Ir.idle,queue:[]},this.requestQueueDelay=pe.ONE_SECOND,this.init=()=>m(this,null,function*(){this.initialized||(yield this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Xn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,pe.toMiliseconds)(this.requestQueueDelay)))}),this.connect=e=>m(this,null,function*(){yield this.isInitialized();let i=Qn(bt({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});yield this.isValidConnect(i);let{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:h,sessionProperties:f,relays:y}=i,d=o,w,S=!1;if(d&&(S=this.client.core.pairing.pairings.get(d).active),!d||!S){let{topic:H,uri:U}=yield this.client.core.pairing.create();d=H,w=U}let x=yield this.client.core.crypto.generateKeyPair(),T=bt({requiredNamespaces:c,optionalNamespaces:h,relays:y??[{protocol:hh}],proposer:{publicKey:x,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:A,resolve:z,done:K}=jr(pe.FIVE_MINUTES,mh);if(this.events.once(ze("session_connect"),ee=>m(this,[ee],function*({error:H,session:U}){if(H)A(H);else if(U){U.self.publicKey=x;let ne=Qn(bt({},U),{requiredNamespaces:U.requiredNamespaces,optionalNamespaces:U.optionalNamespaces});yield this.client.session.set(U.topic,ne),yield this.setExpiry(U.topic,U.expiry),d&&(yield this.client.core.pairing.updateMetadata({topic:d,metadata:U.peer.metadata})),z(ne)}})),!d){let{message:H}=V("NO_MATCHING_KEY",`connect() pairing topic: ${d}`);throw new Error(H)}let B=yield this.sendRequest({topic:d,method:"wc_sessionPropose",params:T}),Z=Tt(pe.FIVE_MINUTES);return yield this.setProposal(B,bt({id:B,expiry:Z},T)),{uri:w,approval:K}}),this.pair=e=>m(this,null,function*(){return yield this.isInitialized(),yield this.client.core.pairing.pair(e)}),this.approve=e=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidApprove(e);let{id:i,relayProtocol:o,namespaces:c,sessionProperties:h}=e,f=this.client.proposal.get(i),{pairingTopic:y,proposer:d,requiredNamespaces:w,optionalNamespaces:S}=f;y=y||"",Fi(w)||(w=jp(c,"approve()"));let x=yield this.client.core.crypto.generateKeyPair(),T=d.publicKey,A=yield this.client.core.crypto.generateSharedKey(x,T);y&&i&&(yield this.client.core.pairing.updateMetadata({topic:y,metadata:d.metadata}),yield this.sendResult({id:i,topic:y,result:{relay:{protocol:o??"irn"},responderPublicKey:x}}),yield this.client.proposal.delete(i,Ze("USER_DISCONNECTED")),yield this.client.core.pairing.activate({topic:y}));let z=bt({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:w,optionalNamespaces:S,pairingTopic:y,controller:{publicKey:x,metadata:this.client.metadata},expiry:Tt(Jo)},h&&{sessionProperties:h});yield this.client.core.relayer.subscribe(A),yield this.sendRequest({topic:A,method:"wc_sessionSettle",params:z,throwOnFailedPublish:!0});let K=Qn(bt({},z),{topic:A,pairingTopic:y,acknowledged:!1,self:z.controller,peer:{publicKey:d.publicKey,metadata:d.metadata},controller:x});return yield this.client.session.set(A,K),yield this.setExpiry(A,Tt(Jo)),{topic:A,acknowledged:()=>new Promise(B=>setTimeout(()=>B(this.client.session.get(A)),500))}}),this.reject=e=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidReject(e);let{id:i,reason:o}=e,{pairingTopic:c}=this.client.proposal.get(i);c&&(yield this.sendError(i,c,o),yield this.client.proposal.delete(i,Ze("USER_DISCONNECTED")))}),this.update=e=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidUpdate(e);let{topic:i,namespaces:o}=e,c=yield this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:h,resolve:f,reject:y}=jr();return this.events.once(ze("session_update",c),({error:d})=>{d?y(d):f()}),yield this.client.session.update(i,{namespaces:o}),{acknowledged:h}}),this.extend=e=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidExtend(e);let{topic:i}=e,o=yield this.sendRequest({topic:i,method:"wc_sessionExtend",params:{}}),{done:c,resolve:h,reject:f}=jr();return this.events.once(ze("session_extend",o),({error:y})=>{y?f(y):h()}),yield this.setExpiry(i,Tt(Jo)),{acknowledged:c}}),this.request=e=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidRequest(e);let{chainId:i,request:o,topic:c,expiry:h}=e,f=Un(),{done:y,resolve:d,reject:w}=jr(h);return this.events.once(ze("session_request",f),({error:S,result:x})=>{S?w(S):d(x)}),yield Promise.all([new Promise(S=>m(this,null,function*(){yield this.sendRequest({clientRpcId:f,topic:c,method:"wc_sessionRequest",params:{request:o,chainId:i},expiry:h,throwOnFailedPublish:!0}).catch(x=>w(x)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:i,id:f}),S()})),new Promise(S=>m(this,null,function*(){let x=yield this.client.core.storage.getItem(av);Lp({id:f,topic:c,wcDeepLink:x}),S()})),y()]).then(S=>S[2])}),this.respond=e=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidRespond(e);let{topic:i,response:o}=e,{id:c}=o;Ut(o)?yield this.sendResult({id:c,topic:i,result:o.result,throwOnFailedPublish:!0}):gt(o)&&(yield this.sendError(c,i,o.error)),this.cleanupAfterResponse(e)}),this.ping=e=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidPing(e);let{topic:i}=e;if(this.client.session.keys.includes(i)){let o=yield this.sendRequest({topic:i,method:"wc_sessionPing",params:{}}),{done:c,resolve:h,reject:f}=jr();this.events.once(ze("session_ping",o),({error:y})=>{y?f(y):h()}),yield c()}else this.client.core.pairing.pairings.keys.includes(i)&&(yield this.client.core.pairing.ping({topic:i}))}),this.emit=e=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidEmit(e);let{topic:i,event:o,chainId:c}=e;yield this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:o,chainId:c}})}),this.disconnect=e=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidDisconnect(e);let{topic:i}=e;this.client.session.keys.includes(i)?(yield this.sendRequest({topic:i,method:"wc_sessionDelete",params:Ze("USER_DISCONNECTED"),throwOnFailedPublish:!0}),yield this.deleteSession(i)):yield this.client.core.pairing.disconnect({topic:i})}),this.find=e=>(this.isInitialized(),this.client.session.getAll().filter(i=>qp(i,e))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=e=>m(this,null,function*(){if(e.pairingTopic)try{let i=this.client.core.pairing.pairings.get(e.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var h,f;return((h=c.peerMetadata)==null?void 0:h.url)&&((f=c.peerMetadata)==null?void 0:f.url)===e.peer.metadata.url&&c.topic&&c.topic!==i.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),yield Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}}),this.deleteSession=(e,i)=>m(this,null,function*(){let{self:o}=this.client.session.get(e);yield this.client.core.relayer.unsubscribe(e),this.client.session.delete(e,Ze("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&(yield this.client.core.crypto.deleteKeyPair(o.publicKey)),this.client.core.crypto.keychain.has(e)&&(yield this.client.core.crypto.deleteSymKey(e)),i||this.client.core.expirer.del(e),this.client.core.storage.removeItem(av).catch(c=>this.client.logger.warn(c))}),this.deleteProposal=(e,i)=>m(this,null,function*(){yield Promise.all([this.client.proposal.delete(e,Ze("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(e)])}),this.deletePendingSessionRequest=(e,i,o=!1)=>m(this,null,function*(){yield Promise.all([this.client.pendingRequest.delete(e,i),o?Promise.resolve():this.client.core.expirer.del(e)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==e),o&&(this.sessionRequestQueue.state=Ir.idle)}),this.setExpiry=(e,i)=>m(this,null,function*(){this.client.session.keys.includes(e)&&(yield this.client.session.update(e,{expiry:i})),this.client.core.expirer.set(e,i)}),this.setProposal=(e,i)=>m(this,null,function*(){yield this.client.proposal.set(e,i),this.client.core.expirer.set(e,i.expiry)}),this.setPendingSessionRequest=e=>m(this,null,function*(){let i=Xn.wc_sessionRequest.req.ttl,{id:o,topic:c,params:h}=e;yield this.client.pendingRequest.set(o,{id:o,topic:c,params:h}),i&&this.client.core.expirer.set(o,Tt(i))}),this.sendRequest=e=>m(this,null,function*(){let{topic:i,method:o,params:c,expiry:h,relayRpcId:f,clientRpcId:y,throwOnFailedPublish:d}=e,w=mr(o,c,y);if(Ws()&&U6.includes(o)){let T=Fr(JSON.stringify(w));this.client.core.verify.register({attestationId:T})}let S=yield this.client.core.crypto.encode(i,w),x=Xn[o].req;return h&&(x.ttl=h),f&&(x.id=f),this.client.core.history.set(i,w),d?(x.internal=Qn(bt({},x.internal),{throwOnFailedPublish:!0}),yield this.client.core.relayer.publish(i,S,x)):this.client.core.relayer.publish(i,S,x).catch(T=>this.client.logger.error(T)),w.id}),this.sendResult=e=>m(this,null,function*(){let{id:i,topic:o,result:c,throwOnFailedPublish:h}=e,f=Gi(i,c),y=yield this.client.core.crypto.encode(o,f),d=yield this.client.core.history.get(o,i),w=Xn[d.request.method].res;h?(w.internal=Qn(bt({},w.internal),{throwOnFailedPublish:!0}),yield this.client.core.relayer.publish(o,y,w)):this.client.core.relayer.publish(o,y,w).catch(S=>this.client.logger.error(S)),yield this.client.core.history.resolve(f)}),this.sendError=(e,i,o)=>m(this,null,function*(){let c=_r(e,o),h=yield this.client.core.crypto.encode(i,c),f=yield this.client.core.history.get(i,e),y=Xn[f.request.method].res;this.client.core.relayer.publish(i,h,y),yield this.client.core.history.resolve(c)}),this.cleanup=()=>m(this,null,function*(){let e=[],i=[];this.client.session.getAll().forEach(o=>{Yt(o.expiry)&&e.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Yt(o.expiry)&&i.push(o.id)}),yield Promise.all([...e.map(o=>this.deleteSession(o)),...i.map(o=>this.deleteProposal(o))])}),this.onRelayEventRequest=e=>m(this,null,function*(){this.requestQueue.queue.push(e),yield this.processRequestsQueue()}),this.processRequestsQueue=()=>m(this,null,function*(){if(this.requestQueue.state===Ir.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Ir.active;let e=this.requestQueue.queue.shift();if(e)try{this.processRequest(e),yield new Promise(i=>setTimeout(i,300))}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=Ir.idle}),this.processRequest=e=>{let{topic:i,payload:o}=e,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(i,o);case"wc_sessionSettle":return this.onSessionSettleRequest(i,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,o);case"wc_sessionExtend":return this.onSessionExtendRequest(i,o);case"wc_sessionPing":return this.onSessionPingRequest(i,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,o);case"wc_sessionRequest":return this.onSessionRequest(i,o);case"wc_sessionEvent":return this.onSessionEventRequest(i,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=e=>m(this,null,function*(){let{topic:i,payload:o}=e,c=(yield this.client.core.history.get(i,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(i,o);case"wc_sessionSettle":return this.onSessionSettleResponse(i,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,o);case"wc_sessionExtend":return this.onSessionExtendResponse(i,o);case"wc_sessionPing":return this.onSessionPingResponse(i,o);case"wc_sessionRequest":return this.onSessionRequestResponse(i,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}}),this.onRelayEventUnknownPayload=e=>{let{topic:i}=e,{message:o}=V("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=(e,i)=>m(this,null,function*(){let{params:o,id:c}=i;try{this.isValidConnect(bt({},i.params));let h=Tt(pe.FIVE_MINUTES),f=bt({id:c,pairingTopic:e,expiry:h},o);yield this.setProposal(c,f);let y=Fr(JSON.stringify(i)),d=yield this.getVerifyContext(y,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:d})}catch(h){yield this.sendError(c,e,h),this.client.logger.error(h)}}),this.onSessionProposeResponse=(e,i)=>m(this,null,function*(){let{id:o}=i;if(Ut(i)){let{result:c}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});let h=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:h});let f=h.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});let y=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:y});let d=yield this.client.core.crypto.generateSharedKey(f,y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:d});let w=yield this.client.core.relayer.subscribe(d);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:w}),yield this.client.core.pairing.activate({topic:e})}else gt(i)&&(yield this.client.proposal.delete(o,Ze("USER_DISCONNECTED")),this.events.emit(ze("session_connect"),{error:i.error}))}),this.onSessionSettleRequest=(e,i)=>m(this,null,function*(){let{id:o,params:c}=i;try{this.isValidSessionSettleRequest(c);let{relay:h,controller:f,expiry:y,namespaces:d,requiredNamespaces:w,optionalNamespaces:S,sessionProperties:x,pairingTopic:T}=i.params,A=bt({topic:e,relay:h,expiry:y,namespaces:d,acknowledged:!0,pairingTopic:T,requiredNamespaces:w,optionalNamespaces:S,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},x&&{sessionProperties:x});yield this.sendResult({id:i.id,topic:e,result:!0}),this.events.emit(ze("session_connect"),{session:A}),this.cleanupDuplicatePairings(A)}catch(h){yield this.sendError(o,e,h),this.client.logger.error(h)}}),this.onSessionSettleResponse=(e,i)=>m(this,null,function*(){let{id:o}=i;Ut(i)?(yield this.client.session.update(e,{acknowledged:!0}),this.events.emit(ze("session_approve",o),{})):gt(i)&&(yield this.client.session.delete(e,Ze("USER_DISCONNECTED")),this.events.emit(ze("session_approve",o),{error:i.error}))}),this.onSessionUpdateRequest=(e,i)=>m(this,null,function*(){let{params:o,id:c}=i;try{let h=`${e}_session_update`,f=En.get(h);if(f&&this.isRequestOutOfSync(f,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(bt({topic:e},o)),yield this.client.session.update(e,{namespaces:o.namespaces}),yield this.sendResult({id:c,topic:e,result:!0}),this.client.events.emit("session_update",{id:c,topic:e,params:o}),En.set(h,c)}catch(h){yield this.sendError(c,e,h),this.client.logger.error(h)}}),this.isRequestOutOfSync=(e,i)=>parseInt(i.toString().slice(0,-3))<=parseInt(e.toString().slice(0,-3)),this.onSessionUpdateResponse=(e,i)=>{let{id:o}=i;Ut(i)?this.events.emit(ze("session_update",o),{}):gt(i)&&this.events.emit(ze("session_update",o),{error:i.error})},this.onSessionExtendRequest=(e,i)=>m(this,null,function*(){let{id:o}=i;try{this.isValidExtend({topic:e}),yield this.setExpiry(e,Tt(Jo)),yield this.sendResult({id:o,topic:e,result:!0}),this.client.events.emit("session_extend",{id:o,topic:e})}catch(c){yield this.sendError(o,e,c),this.client.logger.error(c)}}),this.onSessionExtendResponse=(e,i)=>{let{id:o}=i;Ut(i)?this.events.emit(ze("session_extend",o),{}):gt(i)&&this.events.emit(ze("session_extend",o),{error:i.error})},this.onSessionPingRequest=(e,i)=>m(this,null,function*(){let{id:o}=i;try{this.isValidPing({topic:e}),yield this.sendResult({id:o,topic:e,result:!0}),this.client.events.emit("session_ping",{id:o,topic:e})}catch(c){yield this.sendError(o,e,c),this.client.logger.error(c)}}),this.onSessionPingResponse=(e,i)=>{let{id:o}=i;setTimeout(()=>{Ut(i)?this.events.emit(ze("session_ping",o),{}):gt(i)&&this.events.emit(ze("session_ping",o),{error:i.error})},500)},this.onSessionDeleteRequest=(e,i)=>m(this,null,function*(){let{id:o}=i;try{this.isValidDisconnect({topic:e,reason:i.params}),yield Promise.all([new Promise(c=>{this.client.core.relayer.once(st.publish,()=>m(this,null,function*(){c(yield this.deleteSession(e))}))}),this.sendResult({id:o,topic:e,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:e})}catch(c){this.client.logger.error(c)}}),this.onSessionRequest=(e,i)=>m(this,null,function*(){let{id:o,params:c}=i;try{this.isValidRequest(bt({topic:e},c)),yield this.setPendingSessionRequest({id:o,topic:e,params:c}),this.addSessionRequestToSessionRequestQueue({id:o,topic:e,params:c}),yield this.processSessionRequestQueue()}catch(h){yield this.sendError(o,e,h),this.client.logger.error(h)}}),this.onSessionRequestResponse=(e,i)=>{let{id:o}=i;Ut(i)?this.events.emit(ze("session_request",o),{result:i.result}):gt(i)&&this.events.emit(ze("session_request",o),{error:i.error})},this.onSessionEventRequest=(e,i)=>m(this,null,function*(){let{id:o,params:c}=i;try{let h=`${e}_session_event_${c.event.name}`,f=En.get(h);if(f&&this.isRequestOutOfSync(f,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(bt({topic:e},c)),this.client.events.emit("session_event",{id:o,topic:e,params:c}),En.set(h,o)}catch(h){yield this.sendError(o,e,h),this.client.logger.error(h)}}),this.addSessionRequestToSessionRequestQueue=e=>{this.sessionRequestQueue.queue.push(e)},this.cleanupAfterResponse=e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Ir.idle,this.processSessionRequestQueue()},(0,pe.toMiliseconds)(this.requestQueueDelay))},this.processSessionRequestQueue=()=>m(this,null,function*(){if(this.sessionRequestQueue.state===Ir.active){this.client.logger.info("session request queue is already active.");return}let e=this.sessionRequestQueue.queue[0];if(!e){this.client.logger.info("session request queue is empty.");return}try{let{id:i,topic:o,params:c}=e,h=Fr(JSON.stringify(mr("wc_sessionRequest",c,i))),f=this.client.session.get(o),y=yield this.getVerifyContext(h,f.peer.metadata);this.sessionRequestQueue.state=Ir.active,this.client.events.emit("session_request",{id:i,topic:o,params:c,verifyContext:y})}catch(i){this.client.logger.error(i)}}),this.isValidConnect=e=>m(this,null,function*(){if(!ht(e)){let{message:y}=V("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw new Error(y)}let{pairingTopic:i,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:h,relays:f}=e;if(Xt(i)||(yield this.isValidPairingTopic(i)),!Bp(f,!0)){let{message:y}=V("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(y)}!Xt(o)&&Fi(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!Xt(c)&&Fi(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),Xt(h)||this.validateSessionProps(h,"sessionProperties")}),this.validateNamespaces=(e,i)=>{let o=Hp(e,"connect()",i);if(o)throw new Error(o.message)},this.isValidApprove=e=>m(this,null,function*(){if(!ht(e))throw new Error(V("MISSING_OR_INVALID",`approve() params: ${e}`).message);let{id:i,namespaces:o,relayProtocol:c,sessionProperties:h}=e;yield this.isValidProposalId(i);let f=this.client.proposal.get(i),y=Qs(o,"approve()");if(y)throw new Error(y.message);let d=Ac(f.requiredNamespaces,o,"approve()");if(d)throw new Error(d.message);if(!qr(c,!0)){let{message:w}=V("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(w)}Xt(h)||this.validateSessionProps(h,"sessionProperties")}),this.isValidReject=e=>m(this,null,function*(){if(!ht(e)){let{message:c}=V("MISSING_OR_INVALID",`reject() params: ${e}`);throw new Error(c)}let{id:i,reason:o}=e;if(yield this.isValidProposalId(i),!Kp(o)){let{message:c}=V("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}}),this.isValidSessionSettleRequest=e=>{if(!ht(e)){let{message:d}=V("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw new Error(d)}let{relay:i,controller:o,namespaces:c,expiry:h}=e;if(!Vp(i)){let{message:d}=V("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(d)}let f=$p(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);let y=Qs(c,"onSessionSettleRequest()");if(y)throw new Error(y.message);if(Yt(h)){let{message:d}=V("EXPIRED","onSessionSettleRequest()");throw new Error(d)}},this.isValidUpdate=e=>m(this,null,function*(){if(!ht(e)){let{message:y}=V("MISSING_OR_INVALID",`update() params: ${e}`);throw new Error(y)}let{topic:i,namespaces:o}=e;yield this.isValidSessionTopic(i);let c=this.client.session.get(i),h=Qs(o,"update()");if(h)throw new Error(h.message);let f=Ac(c.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)}),this.isValidExtend=e=>m(this,null,function*(){if(!ht(e)){let{message:o}=V("MISSING_OR_INVALID",`extend() params: ${e}`);throw new Error(o)}let{topic:i}=e;yield this.isValidSessionTopic(i)}),this.isValidRequest=e=>m(this,null,function*(){if(!ht(e)){let{message:y}=V("MISSING_OR_INVALID",`request() params: ${e}`);throw new Error(y)}let{topic:i,request:o,chainId:c,expiry:h}=e;yield this.isValidSessionTopic(i);let{namespaces:f}=this.client.session.get(i);if(!Tc(f,c)){let{message:y}=V("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(y)}if(!Gp(o)){let{message:y}=V("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(y)}if(!Yp(f,c,o.method)){let{message:y}=V("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(y)}if(h&&!Qp(h,fh)){let{message:y}=V("MISSING_OR_INVALID",`request() expiry: ${h}. Expiry must be a number (in seconds) between ${fh.min} and ${fh.max}`);throw new Error(y)}}),this.isValidRespond=e=>m(this,null,function*(){if(!ht(e)){let{message:c}=V("MISSING_OR_INVALID",`respond() params: ${e}`);throw new Error(c)}let{topic:i,response:o}=e;if(yield this.isValidSessionTopic(i),!Wp(o)){let{message:c}=V("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(c)}}),this.isValidPing=e=>m(this,null,function*(){if(!ht(e)){let{message:o}=V("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(o)}let{topic:i}=e;yield this.isValidSessionOrPairingTopic(i)}),this.isValidEmit=e=>m(this,null,function*(){if(!ht(e)){let{message:f}=V("MISSING_OR_INVALID",`emit() params: ${e}`);throw new Error(f)}let{topic:i,event:o,chainId:c}=e;yield this.isValidSessionTopic(i);let{namespaces:h}=this.client.session.get(i);if(!Tc(h,c)){let{message:f}=V("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!Jp(o)){let{message:f}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!Xp(h,c,o.name)){let{message:f}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}}),this.isValidDisconnect=e=>m(this,null,function*(){if(!ht(e)){let{message:o}=V("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(o)}let{topic:i}=e;yield this.isValidSessionOrPairingTopic(i)}),this.getVerifyContext=(e,i)=>m(this,null,function*(){let o={verified:{verifyUrl:i.verifyUrl||Jn,validation:"UNKNOWN",origin:i.url||""}};try{let c=yield this.client.core.verify.resolve({attestationId:e,verifyUrl:i.verifyUrl});c&&(o.verified.origin=c,o.verified.validation=c===new URL(i.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.error(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o}),this.validateSessionProps=(e,i)=>{Object.values(e).forEach(o=>{if(!qr(o,!1)){let{message:c}=V("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}isInitialized(){return m(this,null,function*(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}yield this.client.core.relayer.confirmOnlineStateOrThrow()})}registerRelayerEvents(){this.client.core.relayer.on(st.message,t=>m(this,null,function*(){let{topic:e,message:i}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;let o=yield this.client.core.crypto.decode(e,i);try{Ji(o)?(this.client.core.history.set(e,o),this.onRelayEventRequest({topic:e,payload:o})):Hr(o)?(yield this.client.core.history.resolve(o),yield this.onRelayEventResponse({topic:e,payload:o}),this.client.core.history.delete(e,o.id)):this.onRelayEventUnknownPayload({topic:e,payload:o})}catch(c){this.client.logger.error(c)}}))}registerExpirerEvents(){this.client.core.expirer.on(At.expired,t=>m(this,null,function*(){let{topic:e,id:i}=Js(t.target);if(i&&this.client.pendingRequest.keys.includes(i))return yield this.deletePendingSessionRequest(i,V("EXPIRED"),!0);e?this.client.session.keys.includes(e)&&(yield this.deleteSession(e,!0),this.client.events.emit("session_expire",{topic:e})):i&&(yield this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))}))}isValidPairingTopic(t){if(!qr(t,!1)){let{message:e}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(e)}if(!this.client.core.pairing.pairings.keys.includes(t)){let{message:e}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(e)}if(Yt(this.client.core.pairing.pairings.get(t).expiry)){let{message:e}=V("EXPIRED",`pairing topic: ${t}`);throw new Error(e)}}isValidSessionTopic(t){return m(this,null,function*(){if(!qr(t,!1)){let{message:e}=V("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(e)}if(!this.client.session.keys.includes(t)){let{message:e}=V("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(e)}if(Yt(this.client.session.get(t).expiry)){yield this.deleteSession(t);let{message:e}=V("EXPIRED",`session topic: ${t}`);throw new Error(e)}})}isValidSessionOrPairingTopic(t){return m(this,null,function*(){if(this.client.session.keys.includes(t))yield this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(qr(t,!1)){let{message:e}=V("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(e)}else{let{message:e}=V("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(e)}})}isValidProposalId(t){return m(this,null,function*(){if(!kp(t)){let{message:e}=V("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(e)}if(!this.client.proposal.keys.includes(t)){let{message:e}=V("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(e)}if(Yt(this.client.proposal.get(t).expiry)){yield this.deleteProposal(t);let{message:e}=V("EXPIRED",`proposal id: ${t}`);throw new Error(e)}})}},dh=class extends fi{constructor(t,e){super(t,e,F6,vh),this.core=t,this.logger=e}},gh=class extends fi{constructor(t,e){super(t,e,j6,vh),this.core=t,this.logger=e}},yh=class extends fi{constructor(t,e){super(t,e,M6,vh,i=>i.id),this.core=t,this.logger=e}},Yo=class s extends Eo{constructor(t){super(t),this.protocol=hv,this.version=lv,this.name=lh.name,this.events=new Xo.EventEmitter,this.on=(i,o)=>this.events.on(i,o),this.once=(i,o)=>this.events.once(i,o),this.off=(i,o)=>this.events.off(i,o),this.removeListener=(i,o)=>this.events.removeListener(i,o),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=i=>m(this,null,function*(){try{return yield this.engine.connect(i)}catch(o){throw this.logger.error(o.message),o}}),this.pair=i=>m(this,null,function*(){try{return yield this.engine.pair(i)}catch(o){throw this.logger.error(o.message),o}}),this.approve=i=>m(this,null,function*(){try{return yield this.engine.approve(i)}catch(o){throw this.logger.error(o.message),o}}),this.reject=i=>m(this,null,function*(){try{return yield this.engine.reject(i)}catch(o){throw this.logger.error(o.message),o}}),this.update=i=>m(this,null,function*(){try{return yield this.engine.update(i)}catch(o){throw this.logger.error(o.message),o}}),this.extend=i=>m(this,null,function*(){try{return yield this.engine.extend(i)}catch(o){throw this.logger.error(o.message),o}}),this.request=i=>m(this,null,function*(){try{return yield this.engine.request(i)}catch(o){throw this.logger.error(o.message),o}}),this.respond=i=>m(this,null,function*(){try{return yield this.engine.respond(i)}catch(o){throw this.logger.error(o.message),o}}),this.ping=i=>m(this,null,function*(){try{return yield this.engine.ping(i)}catch(o){throw this.logger.error(o.message),o}}),this.emit=i=>m(this,null,function*(){try{return yield this.engine.emit(i)}catch(o){throw this.logger.error(o.message),o}}),this.disconnect=i=>m(this,null,function*(){try{return yield this.engine.disconnect(i)}catch(o){throw this.logger.error(o.message),o}}),this.find=i=>{try{return this.engine.find(i)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=t?.name||lh.name,this.metadata=t?.metadata||Tp();let e=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:(0,Kr.pino)((0,Kr.getDefaultLoggerOptions)({level:t?.logger||lh.logger}));this.core=t?.core||new ov(t),this.logger=(0,Kr.generateChildLogger)(e,this.name),this.session=new gh(this.core,this.logger),this.proposal=new dh(this.core,this.logger),this.pendingRequest=new yh(this.core,this.logger),this.engine=new ph(this)}static init(t){return m(this,null,function*(){let e=new s(t);return yield e.initialize(),e})}get context(){return(0,Kr.getLoggerContext)(this.logger)}get pairing(){return this.core.pairing.pairings}initialize(){return m(this,null,function*(){this.logger.trace("Initialized");try{yield this.core.start(),yield this.session.init(),yield this.proposal.init(),yield this.pendingRequest.init(),yield this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}})}};var ta=Ue(lo());var mv=Ue(Qt()),_h=Ue(gv());var k6={Accept:"application/json","Content-Type":"application/json"},K6="POST",yv={headers:k6,method:K6},vv=10,Zn=class{constructor(t,e=!1){if(this.url=t,this.disableProviderPing=e,this.events=new mv.EventEmitter,this.isAvailable=!1,this.registering=!1,!Fo(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}open(){return m(this,arguments,function*(t=this.url){yield this.register(t)})}close(){return m(this,null,function*(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()})}send(t,e){return m(this,null,function*(){this.isAvailable||(yield this.register());try{let i=yr(t),c=yield(yield(0,_h.default)(this.url,Object.assign(Object.assign({},yv),{body:i}))).json();this.onPayload({data:c})}catch(i){this.onError(t.id,i)}})}register(){return m(this,arguments,function*(t=this.url){if(!Fo(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){let e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((i,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));i()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){let e=yr({id:1,jsonrpc:"2.0",method:"test",params:[]});yield(0,_h.default)(t,Object.assign(Object.assign({},yv),{body:e}))}this.onOpen()}catch(e){let i=this.parseError(e);throw this.events.emit("register_error",i),this.onClose(),i}})}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;let e=typeof t.data=="string"?ni(t.data):t.data;this.events.emit("payload",e)}onError(t,e){let i=this.parseError(e),o=i.message||i.toString(),c=_r(t,o);this.events.emit("payload",c)}parseError(t,e=this.url){return qn(t,e,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>vv&&this.events.setMaxListeners(vv)}},_v=Zn;var di=_v;var Rv=Ue(Qt());var wv="error",G6="wss://relay.walletconnect.com",W6="wc",J6="universal_provider",bv=`${W6}@2:${J6}:`,Y6="https://rpc.walletconnect.com/v1",Gr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"},es=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},xh={exports:{}};(function(s,t){(function(){var e,i="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",f="Invalid `variable` option passed into `_.template`",y="__lodash_hash_undefined__",d=500,w="__lodash_placeholder__",S=1,x=2,T=4,A=1,z=2,K=1,B=2,Z=4,H=8,U=16,ee=32,ne=64,O=128,N=256,re=512,I=30,P="...",L=800,q=16,M=1,Y=2,_e=3,ke=1/0,et=9007199254740991,gi=17976931348623157e292,Re=0/0,ve=4294967295,Ke=ve-1,Ge=ve>>>1,$e=[["ary",O],["bind",K],["bindKey",B],["curry",H],["curryRight",U],["flip",re],["partial",ee],["partialRight",ne],["rearg",N]],Oe="[object Arguments]",De="[object Array]",We="[object AsyncFunction]",Ie="[object Boolean]",Ce="[object Date]",Je="[object DOMException]",Fe="[object Error]",Ne="[object Function]",Ye="[object GeneratorFunction]",we="[object Map]",qe="[object Number]",Fv="[object Null]",nr="[object Object]",qh="[object Promise]",jv="[object Proxy]",en="[object RegExp]",Ht="[object Set]",tn="[object String]",rs="[object Symbol]",qv="[object Undefined]",rn="[object WeakMap]",Mv="[object WeakSet]",nn="[object ArrayBuffer]",yi="[object DataView]",ia="[object Float32Array]",na="[object Float64Array]",sa="[object Int8Array]",oa="[object Int16Array]",aa="[object Int32Array]",ca="[object Uint8Array]",ua="[object Uint8ClampedArray]",ha="[object Uint16Array]",la="[object Uint32Array]",Uv=/\b__p \+= '';/g,zv=/\b(__p \+=) '' \+/g,$v=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Mh=/&(?:amp|lt|gt|quot|#39);/g,Uh=/[&<>"']/g,Hv=RegExp(Mh.source),Vv=RegExp(Uh.source),Bv=/<%-([\s\S]+?)%>/g,kv=/<%([\s\S]+?)%>/g,zh=/<%=([\s\S]+?)%>/g,Kv=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Gv=/^\w*$/,Wv=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,fa=/[\\^$.*+?()[\]{}|]/g,Jv=RegExp(fa.source),pa=/^\s+/,Yv=/\s/,Xv=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qv=/\{\n\/\* \[wrapped with (.+)\] \*/,Zv=/,? & /,em=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,tm=/[()=,{}\[\]\/\s]/,rm=/\\(\\)?/g,im=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,$h=/\w*$/,nm=/^[-+]0x[0-9a-f]+$/i,sm=/^0b[01]+$/i,om=/^\[object .+?Constructor\]$/,am=/^0o[0-7]+$/i,cm=/^(?:0|[1-9]\d*)$/,um=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,is=/($^)/,hm=/['\n\r\u2028\u2029\\]/g,ns="\\ud800-\\udfff",lm="\\u0300-\\u036f",fm="\\ufe20-\\ufe2f",pm="\\u20d0-\\u20ff",Hh=lm+fm+pm,Vh="\\u2700-\\u27bf",Bh="a-z\\xdf-\\xf6\\xf8-\\xff",dm="\\xac\\xb1\\xd7\\xf7",gm="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ym="\\u2000-\\u206f",vm=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",kh="A-Z\\xc0-\\xd6\\xd8-\\xde",Kh="\\ufe0e\\ufe0f",Gh=dm+gm+ym+vm,da="['\u2019]",mm="["+ns+"]",Wh="["+Gh+"]",ss="["+Hh+"]",Jh="\\d+",_m="["+Vh+"]",Yh="["+Bh+"]",Xh="[^"+ns+Gh+Jh+Vh+Bh+kh+"]",ga="\\ud83c[\\udffb-\\udfff]",wm="(?:"+ss+"|"+ga+")",Qh="[^"+ns+"]",ya="(?:\\ud83c[\\udde6-\\uddff]){2}",va="[\\ud800-\\udbff][\\udc00-\\udfff]",vi="["+kh+"]",Zh="\\u200d",el="(?:"+Yh+"|"+Xh+")",bm="(?:"+vi+"|"+Xh+")",tl="(?:"+da+"(?:d|ll|m|re|s|t|ve))?",rl="(?:"+da+"(?:D|LL|M|RE|S|T|VE))?",il=wm+"?",nl="["+Kh+"]?",Em="(?:"+Zh+"(?:"+[Qh,ya,va].join("|")+")"+nl+il+")*",xm="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Im="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",sl=nl+il+Em,Sm="(?:"+[_m,ya,va].join("|")+")"+sl,Pm="(?:"+[Qh+ss+"?",ss,ya,va,mm].join("|")+")",Rm=RegExp(da,"g"),Om=RegExp(ss,"g"),ma=RegExp(ga+"(?="+ga+")|"+Pm+sl,"g"),Tm=RegExp([vi+"?"+Yh+"+"+tl+"(?="+[Wh,vi,"$"].join("|")+")",bm+"+"+rl+"(?="+[Wh,vi+el,"$"].join("|")+")",vi+"?"+el+"+"+tl,vi+"+"+rl,Im,xm,Jh,Sm].join("|"),"g"),Am=RegExp("["+Zh+ns+Hh+Kh+"]"),Cm=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Nm=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Lm=-1,Te={};Te[ia]=Te[na]=Te[sa]=Te[oa]=Te[aa]=Te[ca]=Te[ua]=Te[ha]=Te[la]=!0,Te[Oe]=Te[De]=Te[nn]=Te[Ie]=Te[yi]=Te[Ce]=Te[Fe]=Te[Ne]=Te[we]=Te[qe]=Te[nr]=Te[en]=Te[Ht]=Te[tn]=Te[rn]=!1;var Se={};Se[Oe]=Se[De]=Se[nn]=Se[yi]=Se[Ie]=Se[Ce]=Se[ia]=Se[na]=Se[sa]=Se[oa]=Se[aa]=Se[we]=Se[qe]=Se[nr]=Se[en]=Se[Ht]=Se[tn]=Se[rs]=Se[ca]=Se[ua]=Se[ha]=Se[la]=!0,Se[Fe]=Se[Ne]=Se[rn]=!1;var Dm={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Fm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},jm={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},qm={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Mm=parseFloat,Um=parseInt,ol=typeof es=="object"&&es&&es.Object===Object&&es,zm=typeof self=="object"&&self&&self.Object===Object&&self,rt=ol||zm||Function("return this")(),_a=t&&!t.nodeType&&t,Wr=_a&&!0&&s&&!s.nodeType&&s,al=Wr&&Wr.exports===_a,wa=al&&ol.process,Ct=function(){try{var b=Wr&&Wr.require&&Wr.require("util").types;return b||wa&&wa.binding&&wa.binding("util")}catch{}}(),cl=Ct&&Ct.isArrayBuffer,ul=Ct&&Ct.isDate,hl=Ct&&Ct.isMap,ll=Ct&&Ct.isRegExp,fl=Ct&&Ct.isSet,pl=Ct&&Ct.isTypedArray;function Et(b,C,R){switch(R.length){case 0:return b.call(C);case 1:return b.call(C,R[0]);case 2:return b.call(C,R[0],R[1]);case 3:return b.call(C,R[0],R[1],R[2])}return b.apply(C,R)}function $m(b,C,R,k){for(var te=-1,de=b==null?0:b.length;++te<de;){var Xe=b[te];C(k,Xe,R(Xe),b)}return k}function Nt(b,C){for(var R=-1,k=b==null?0:b.length;++R<k&&C(b[R],R,b)!==!1;);return b}function Hm(b,C){for(var R=b==null?0:b.length;R--&&C(b[R],R,b)!==!1;);return b}function dl(b,C){for(var R=-1,k=b==null?0:b.length;++R<k;)if(!C(b[R],R,b))return!1;return!0}function Pr(b,C){for(var R=-1,k=b==null?0:b.length,te=0,de=[];++R<k;){var Xe=b[R];C(Xe,R,b)&&(de[te++]=Xe)}return de}function os(b,C){var R=b==null?0:b.length;return!!R&&mi(b,C,0)>-1}function ba(b,C,R){for(var k=-1,te=b==null?0:b.length;++k<te;)if(R(C,b[k]))return!0;return!1}function Le(b,C){for(var R=-1,k=b==null?0:b.length,te=Array(k);++R<k;)te[R]=C(b[R],R,b);return te}function Rr(b,C){for(var R=-1,k=C.length,te=b.length;++R<k;)b[te+R]=C[R];return b}function Ea(b,C,R,k){var te=-1,de=b==null?0:b.length;for(k&&de&&(R=b[++te]);++te<de;)R=C(R,b[te],te,b);return R}function Vm(b,C,R,k){var te=b==null?0:b.length;for(k&&te&&(R=b[--te]);te--;)R=C(R,b[te],te,b);return R}function xa(b,C){for(var R=-1,k=b==null?0:b.length;++R<k;)if(C(b[R],R,b))return!0;return!1}var Bm=Ia("length");function km(b){return b.split("")}function Km(b){return b.match(em)||[]}function gl(b,C,R){var k;return R(b,function(te,de,Xe){if(C(te,de,Xe))return k=de,!1}),k}function as(b,C,R,k){for(var te=b.length,de=R+(k?1:-1);k?de--:++de<te;)if(C(b[de],de,b))return de;return-1}function mi(b,C,R){return C===C?n_(b,C,R):as(b,yl,R)}function Gm(b,C,R,k){for(var te=R-1,de=b.length;++te<de;)if(k(b[te],C))return te;return-1}function yl(b){return b!==b}function vl(b,C){var R=b==null?0:b.length;return R?Pa(b,C)/R:Re}function Ia(b){return function(C){return C==null?e:C[b]}}function Sa(b){return function(C){return b==null?e:b[C]}}function ml(b,C,R,k,te){return te(b,function(de,Xe,xe){R=k?(k=!1,de):C(R,de,Xe,xe)}),R}function Wm(b,C){var R=b.length;for(b.sort(C);R--;)b[R]=b[R].value;return b}function Pa(b,C){for(var R,k=-1,te=b.length;++k<te;){var de=C(b[k]);de!==e&&(R=R===e?de:R+de)}return R}function Ra(b,C){for(var R=-1,k=Array(b);++R<b;)k[R]=C(R);return k}function Jm(b,C){return Le(C,function(R){return[R,b[R]]})}function _l(b){return b&&b.slice(0,xl(b)+1).replace(pa,"")}function xt(b){return function(C){return b(C)}}function Oa(b,C){return Le(C,function(R){return b[R]})}function sn(b,C){return b.has(C)}function wl(b,C){for(var R=-1,k=b.length;++R<k&&mi(C,b[R],0)>-1;);return R}function bl(b,C){for(var R=b.length;R--&&mi(C,b[R],0)>-1;);return R}function Ym(b,C){for(var R=b.length,k=0;R--;)b[R]===C&&++k;return k}var Xm=Sa(Dm),Qm=Sa(Fm);function Zm(b){return"\\"+qm[b]}function e_(b,C){return b==null?e:b[C]}function _i(b){return Am.test(b)}function t_(b){return Cm.test(b)}function r_(b){for(var C,R=[];!(C=b.next()).done;)R.push(C.value);return R}function Ta(b){var C=-1,R=Array(b.size);return b.forEach(function(k,te){R[++C]=[te,k]}),R}function El(b,C){return function(R){return b(C(R))}}function Or(b,C){for(var R=-1,k=b.length,te=0,de=[];++R<k;){var Xe=b[R];(Xe===C||Xe===w)&&(b[R]=w,de[te++]=R)}return de}function cs(b){var C=-1,R=Array(b.size);return b.forEach(function(k){R[++C]=k}),R}function i_(b){var C=-1,R=Array(b.size);return b.forEach(function(k){R[++C]=[k,k]}),R}function n_(b,C,R){for(var k=R-1,te=b.length;++k<te;)if(b[k]===C)return k;return-1}function s_(b,C,R){for(var k=R+1;k--;)if(b[k]===C)return k;return k}function wi(b){return _i(b)?a_(b):Bm(b)}function Vt(b){return _i(b)?c_(b):km(b)}function xl(b){for(var C=b.length;C--&&Yv.test(b.charAt(C)););return C}var o_=Sa(jm);function a_(b){for(var C=ma.lastIndex=0;ma.test(b);)++C;return C}function c_(b){return b.match(ma)||[]}function u_(b){return b.match(Tm)||[]}var h_=function b(C){C=C==null?rt:bi.defaults(rt.Object(),C,bi.pick(rt,Nm));var R=C.Array,k=C.Date,te=C.Error,de=C.Function,Xe=C.Math,xe=C.Object,Aa=C.RegExp,l_=C.String,Lt=C.TypeError,us=R.prototype,f_=de.prototype,Ei=xe.prototype,hs=C["__core-js_shared__"],ls=f_.toString,me=Ei.hasOwnProperty,p_=0,Il=function(){var r=/[^.]+$/.exec(hs&&hs.keys&&hs.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),fs=Ei.toString,d_=ls.call(xe),g_=rt._,y_=Aa("^"+ls.call(me).replace(fa,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ps=al?C.Buffer:e,Tr=C.Symbol,ds=C.Uint8Array,Sl=ps?ps.allocUnsafe:e,gs=El(xe.getPrototypeOf,xe),Pl=xe.create,Rl=Ei.propertyIsEnumerable,ys=us.splice,Ol=Tr?Tr.isConcatSpreadable:e,on=Tr?Tr.iterator:e,Jr=Tr?Tr.toStringTag:e,vs=function(){try{var r=ei(xe,"defineProperty");return r({},"",{}),r}catch{}}(),v_=C.clearTimeout!==rt.clearTimeout&&C.clearTimeout,m_=k&&k.now!==rt.Date.now&&k.now,__=C.setTimeout!==rt.setTimeout&&C.setTimeout,ms=Xe.ceil,_s=Xe.floor,Ca=xe.getOwnPropertySymbols,w_=ps?ps.isBuffer:e,Tl=C.isFinite,b_=us.join,E_=El(xe.keys,xe),Qe=Xe.max,at=Xe.min,x_=k.now,I_=C.parseInt,Al=Xe.random,S_=us.reverse,Na=ei(C,"DataView"),an=ei(C,"Map"),La=ei(C,"Promise"),xi=ei(C,"Set"),cn=ei(C,"WeakMap"),un=ei(xe,"create"),ws=cn&&new cn,Ii={},P_=ti(Na),R_=ti(an),O_=ti(La),T_=ti(xi),A_=ti(cn),bs=Tr?Tr.prototype:e,hn=bs?bs.valueOf:e,Cl=bs?bs.toString:e;function p(r){if(Me(r)&&!ie(r)&&!(r instanceof ue)){if(r instanceof Dt)return r;if(me.call(r,"__wrapped__"))return Lf(r)}return new Dt(r)}var Si=function(){function r(){}return function(n){if(!je(n))return{};if(Pl)return Pl(n);r.prototype=n;var a=new r;return r.prototype=e,a}}();function Es(){}function Dt(r,n){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=e}p.templateSettings={escape:Bv,evaluate:kv,interpolate:zh,variable:"",imports:{_:p}},p.prototype=Es.prototype,p.prototype.constructor=p,Dt.prototype=Si(Es.prototype),Dt.prototype.constructor=Dt;function ue(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ve,this.__views__=[]}function C_(){var r=new ue(this.__wrapped__);return r.__actions__=yt(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=yt(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=yt(this.__views__),r}function N_(){if(this.__filtered__){var r=new ue(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function L_(){var r=this.__wrapped__.value(),n=this.__dir__,a=ie(r),u=n<0,l=a?r.length:0,g=k0(0,l,this.__views__),v=g.start,_=g.end,E=_-v,D=u?_:v-1,F=this.__iteratees__,j=F.length,$=0,G=at(E,this.__takeCount__);if(!a||!u&&l==E&&G==E)return tf(r,this.__actions__);var X=[];e:for(;E--&&$<G;){D+=n;for(var oe=-1,Q=r[D];++oe<j;){var ce=F[oe],he=ce.iteratee,Pt=ce.type,pt=he(Q);if(Pt==Y)Q=pt;else if(!pt){if(Pt==M)continue e;break e}}X[$++]=Q}return X}ue.prototype=Si(Es.prototype),ue.prototype.constructor=ue;function Yr(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var u=r[n];this.set(u[0],u[1])}}function D_(){this.__data__=un?un(null):{},this.size=0}function F_(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n}function j_(r){var n=this.__data__;if(un){var a=n[r];return a===y?e:a}return me.call(n,r)?n[r]:e}function q_(r){var n=this.__data__;return un?n[r]!==e:me.call(n,r)}function M_(r,n){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=un&&n===e?y:n,this}Yr.prototype.clear=D_,Yr.prototype.delete=F_,Yr.prototype.get=j_,Yr.prototype.has=q_,Yr.prototype.set=M_;function sr(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var u=r[n];this.set(u[0],u[1])}}function U_(){this.__data__=[],this.size=0}function z_(r){var n=this.__data__,a=xs(n,r);if(a<0)return!1;var u=n.length-1;return a==u?n.pop():ys.call(n,a,1),--this.size,!0}function $_(r){var n=this.__data__,a=xs(n,r);return a<0?e:n[a][1]}function H_(r){return xs(this.__data__,r)>-1}function V_(r,n){var a=this.__data__,u=xs(a,r);return u<0?(++this.size,a.push([r,n])):a[u][1]=n,this}sr.prototype.clear=U_,sr.prototype.delete=z_,sr.prototype.get=$_,sr.prototype.has=H_,sr.prototype.set=V_;function or(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var u=r[n];this.set(u[0],u[1])}}function B_(){this.size=0,this.__data__={hash:new Yr,map:new(an||sr),string:new Yr}}function k_(r){var n=Fs(this,r).delete(r);return this.size-=n?1:0,n}function K_(r){return Fs(this,r).get(r)}function G_(r){return Fs(this,r).has(r)}function W_(r,n){var a=Fs(this,r),u=a.size;return a.set(r,n),this.size+=a.size==u?0:1,this}or.prototype.clear=B_,or.prototype.delete=k_,or.prototype.get=K_,or.prototype.has=G_,or.prototype.set=W_;function Xr(r){var n=-1,a=r==null?0:r.length;for(this.__data__=new or;++n<a;)this.add(r[n])}function J_(r){return this.__data__.set(r,y),this}function Y_(r){return this.__data__.has(r)}Xr.prototype.add=Xr.prototype.push=J_,Xr.prototype.has=Y_;function Bt(r){var n=this.__data__=new sr(r);this.size=n.size}function X_(){this.__data__=new sr,this.size=0}function Q_(r){var n=this.__data__,a=n.delete(r);return this.size=n.size,a}function Z_(r){return this.__data__.get(r)}function e0(r){return this.__data__.has(r)}function t0(r,n){var a=this.__data__;if(a instanceof sr){var u=a.__data__;if(!an||u.length<o-1)return u.push([r,n]),this.size=++a.size,this;a=this.__data__=new or(u)}return a.set(r,n),this.size=a.size,this}Bt.prototype.clear=X_,Bt.prototype.delete=Q_,Bt.prototype.get=Z_,Bt.prototype.has=e0,Bt.prototype.set=t0;function Nl(r,n){var a=ie(r),u=!a&&ri(r),l=!a&&!u&&Dr(r),g=!a&&!u&&!l&&Ti(r),v=a||u||l||g,_=v?Ra(r.length,l_):[],E=_.length;for(var D in r)(n||me.call(r,D))&&!(v&&(D=="length"||l&&(D=="offset"||D=="parent")||g&&(D=="buffer"||D=="byteLength"||D=="byteOffset")||hr(D,E)))&&_.push(D);return _}function Ll(r){var n=r.length;return n?r[Ba(0,n-1)]:e}function r0(r,n){return js(yt(r),Qr(n,0,r.length))}function i0(r){return js(yt(r))}function Da(r,n,a){(a!==e&&!kt(r[n],a)||a===e&&!(n in r))&&ar(r,n,a)}function ln(r,n,a){var u=r[n];(!(me.call(r,n)&&kt(u,a))||a===e&&!(n in r))&&ar(r,n,a)}function xs(r,n){for(var a=r.length;a--;)if(kt(r[a][0],n))return a;return-1}function n0(r,n,a,u){return Ar(r,function(l,g,v){n(u,l,a(l),v)}),u}function Dl(r,n){return r&&Wt(n,tt(n),r)}function s0(r,n){return r&&Wt(n,mt(n),r)}function ar(r,n,a){n=="__proto__"&&vs?vs(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}function Fa(r,n){for(var a=-1,u=n.length,l=R(u),g=r==null;++a<u;)l[a]=g?e:gc(r,n[a]);return l}function Qr(r,n,a){return r===r&&(a!==e&&(r=r<=a?r:a),n!==e&&(r=r>=n?r:n)),r}function Ft(r,n,a,u,l,g){var v,_=n&S,E=n&x,D=n&T;if(a&&(v=l?a(r,u,l,g):a(r)),v!==e)return v;if(!je(r))return r;var F=ie(r);if(F){if(v=G0(r),!_)return yt(r,v)}else{var j=ct(r),$=j==Ne||j==Ye;if(Dr(r))return sf(r,_);if(j==nr||j==Oe||$&&!l){if(v=E||$?{}:If(r),!_)return E?j0(r,s0(v,r)):F0(r,Dl(v,r))}else{if(!Se[j])return l?r:{};v=W0(r,j,_)}}g||(g=new Bt);var G=g.get(r);if(G)return G;g.set(r,v),Zf(r)?r.forEach(function(Q){v.add(Ft(Q,n,a,Q,r,g))}):Xf(r)&&r.forEach(function(Q,ce){v.set(ce,Ft(Q,n,a,ce,r,g))});var X=D?E?tc:ec:E?mt:tt,oe=F?e:X(r);return Nt(oe||r,function(Q,ce){oe&&(ce=Q,Q=r[ce]),ln(v,ce,Ft(Q,n,a,ce,r,g))}),v}function o0(r){var n=tt(r);return function(a){return Fl(a,r,n)}}function Fl(r,n,a){var u=a.length;if(r==null)return!u;for(r=xe(r);u--;){var l=a[u],g=n[l],v=r[l];if(v===e&&!(l in r)||!g(v))return!1}return!0}function jl(r,n,a){if(typeof r!="function")throw new Lt(h);return mn(function(){r.apply(e,a)},n)}function fn(r,n,a,u){var l=-1,g=os,v=!0,_=r.length,E=[],D=n.length;if(!_)return E;a&&(n=Le(n,xt(a))),u?(g=ba,v=!1):n.length>=o&&(g=sn,v=!1,n=new Xr(n));e:for(;++l<_;){var F=r[l],j=a==null?F:a(F);if(F=u||F!==0?F:0,v&&j===j){for(var $=D;$--;)if(n[$]===j)continue e;E.push(F)}else g(n,j,u)||E.push(F)}return E}var Ar=hf(Gt),ql=hf(qa,!0);function a0(r,n){var a=!0;return Ar(r,function(u,l,g){return a=!!n(u,l,g),a}),a}function Is(r,n,a){for(var u=-1,l=r.length;++u<l;){var g=r[u],v=n(g);if(v!=null&&(_===e?v===v&&!St(v):a(v,_)))var _=v,E=g}return E}function c0(r,n,a,u){var l=r.length;for(a=se(a),a<0&&(a=-a>l?0:l+a),u=u===e||u>l?l:se(u),u<0&&(u+=l),u=a>u?0:tp(u);a<u;)r[a++]=n;return r}function Ml(r,n){var a=[];return Ar(r,function(u,l,g){n(u,l,g)&&a.push(u)}),a}function it(r,n,a,u,l){var g=-1,v=r.length;for(a||(a=Y0),l||(l=[]);++g<v;){var _=r[g];n>0&&a(_)?n>1?it(_,n-1,a,u,l):Rr(l,_):u||(l[l.length]=_)}return l}var ja=lf(),Ul=lf(!0);function Gt(r,n){return r&&ja(r,n,tt)}function qa(r,n){return r&&Ul(r,n,tt)}function Ss(r,n){return Pr(n,function(a){return lr(r[a])})}function Zr(r,n){n=Nr(n,r);for(var a=0,u=n.length;r!=null&&a<u;)r=r[Jt(n[a++])];return a&&a==u?r:e}function zl(r,n,a){var u=n(r);return ie(r)?u:Rr(u,a(r))}function lt(r){return r==null?r===e?qv:Fv:Jr&&Jr in xe(r)?B0(r):iw(r)}function Ma(r,n){return r>n}function u0(r,n){return r!=null&&me.call(r,n)}function h0(r,n){return r!=null&&n in xe(r)}function l0(r,n,a){return r>=at(n,a)&&r<Qe(n,a)}function Ua(r,n,a){for(var u=a?ba:os,l=r[0].length,g=r.length,v=g,_=R(g),E=1/0,D=[];v--;){var F=r[v];v&&n&&(F=Le(F,xt(n))),E=at(F.length,E),_[v]=!a&&(n||l>=120&&F.length>=120)?new Xr(v&&F):e}F=r[0];var j=-1,$=_[0];e:for(;++j<l&&D.length<E;){var G=F[j],X=n?n(G):G;if(G=a||G!==0?G:0,!($?sn($,X):u(D,X,a))){for(v=g;--v;){var oe=_[v];if(!(oe?sn(oe,X):u(r[v],X,a)))continue e}$&&$.push(X),D.push(G)}}return D}function f0(r,n,a,u){return Gt(r,function(l,g,v){n(u,a(l),g,v)}),u}function pn(r,n,a){n=Nr(n,r),r=Of(r,n);var u=r==null?r:r[Jt(qt(n))];return u==null?e:Et(u,r,a)}function $l(r){return Me(r)&&lt(r)==Oe}function p0(r){return Me(r)&&lt(r)==nn}function d0(r){return Me(r)&&lt(r)==Ce}function dn(r,n,a,u,l){return r===n?!0:r==null||n==null||!Me(r)&&!Me(n)?r!==r&&n!==n:g0(r,n,a,u,dn,l)}function g0(r,n,a,u,l,g){var v=ie(r),_=ie(n),E=v?De:ct(r),D=_?De:ct(n);E=E==Oe?nr:E,D=D==Oe?nr:D;var F=E==nr,j=D==nr,$=E==D;if($&&Dr(r)){if(!Dr(n))return!1;v=!0,F=!1}if($&&!F)return g||(g=new Bt),v||Ti(r)?bf(r,n,a,u,l,g):H0(r,n,E,a,u,l,g);if(!(a&A)){var G=F&&me.call(r,"__wrapped__"),X=j&&me.call(n,"__wrapped__");if(G||X){var oe=G?r.value():r,Q=X?n.value():n;return g||(g=new Bt),l(oe,Q,a,u,g)}}return $?(g||(g=new Bt),V0(r,n,a,u,l,g)):!1}function y0(r){return Me(r)&&ct(r)==we}function za(r,n,a,u){var l=a.length,g=l,v=!u;if(r==null)return!g;for(r=xe(r);l--;){var _=a[l];if(v&&_[2]?_[1]!==r[_[0]]:!(_[0]in r))return!1}for(;++l<g;){_=a[l];var E=_[0],D=r[E],F=_[1];if(v&&_[2]){if(D===e&&!(E in r))return!1}else{var j=new Bt;if(u)var $=u(D,F,E,r,n,j);if(!($===e?dn(F,D,A|z,u,j):$))return!1}}return!0}function Hl(r){if(!je(r)||Q0(r))return!1;var n=lr(r)?y_:om;return n.test(ti(r))}function v0(r){return Me(r)&&lt(r)==en}function m0(r){return Me(r)&&ct(r)==Ht}function _0(r){return Me(r)&&Hs(r.length)&&!!Te[lt(r)]}function Vl(r){return typeof r=="function"?r:r==null?_t:typeof r=="object"?ie(r)?Kl(r[0],r[1]):kl(r):fp(r)}function $a(r){if(!vn(r))return E_(r);var n=[];for(var a in xe(r))me.call(r,a)&&a!="constructor"&&n.push(a);return n}function w0(r){if(!je(r))return rw(r);var n=vn(r),a=[];for(var u in r)u=="constructor"&&(n||!me.call(r,u))||a.push(u);return a}function Ha(r,n){return r<n}function Bl(r,n){var a=-1,u=vt(r)?R(r.length):[];return Ar(r,function(l,g,v){u[++a]=n(l,g,v)}),u}function kl(r){var n=ic(r);return n.length==1&&n[0][2]?Pf(n[0][0],n[0][1]):function(a){return a===r||za(a,r,n)}}function Kl(r,n){return sc(r)&&Sf(n)?Pf(Jt(r),n):function(a){var u=gc(a,r);return u===e&&u===n?yc(a,r):dn(n,u,A|z)}}function Ps(r,n,a,u,l){r!==n&&ja(n,function(g,v){if(l||(l=new Bt),je(g))b0(r,n,v,a,Ps,u,l);else{var _=u?u(ac(r,v),g,v+"",r,n,l):e;_===e&&(_=g),Da(r,v,_)}},mt)}function b0(r,n,a,u,l,g,v){var _=ac(r,a),E=ac(n,a),D=v.get(E);if(D){Da(r,a,D);return}var F=g?g(_,E,a+"",r,n,v):e,j=F===e;if(j){var $=ie(E),G=!$&&Dr(E),X=!$&&!G&&Ti(E);F=E,$||G||X?ie(_)?F=_:He(_)?F=yt(_):G?(j=!1,F=sf(E,!0)):X?(j=!1,F=of(E,!0)):F=[]:_n(E)||ri(E)?(F=_,ri(_)?F=rp(_):(!je(_)||lr(_))&&(F=If(E))):j=!1}j&&(v.set(E,F),l(F,E,u,g,v),v.delete(E)),Da(r,a,F)}function Gl(r,n){var a=r.length;if(a)return n+=n<0?a:0,hr(n,a)?r[n]:e}function Wl(r,n,a){n.length?n=Le(n,function(g){return ie(g)?function(v){return Zr(v,g.length===1?g[0]:g)}:g}):n=[_t];var u=-1;n=Le(n,xt(J()));var l=Bl(r,function(g,v,_){var E=Le(n,function(D){return D(g)});return{criteria:E,index:++u,value:g}});return Wm(l,function(g,v){return D0(g,v,a)})}function E0(r,n){return Jl(r,n,function(a,u){return yc(r,u)})}function Jl(r,n,a){for(var u=-1,l=n.length,g={};++u<l;){var v=n[u],_=Zr(r,v);a(_,v)&&gn(g,Nr(v,r),_)}return g}function x0(r){return function(n){return Zr(n,r)}}function Va(r,n,a,u){var l=u?Gm:mi,g=-1,v=n.length,_=r;for(r===n&&(n=yt(n)),a&&(_=Le(r,xt(a)));++g<v;)for(var E=0,D=n[g],F=a?a(D):D;(E=l(_,F,E,u))>-1;)_!==r&&ys.call(_,E,1),ys.call(r,E,1);return r}function Yl(r,n){for(var a=r?n.length:0,u=a-1;a--;){var l=n[a];if(a==u||l!==g){var g=l;hr(l)?ys.call(r,l,1):Ga(r,l)}}return r}function Ba(r,n){return r+_s(Al()*(n-r+1))}function I0(r,n,a,u){for(var l=-1,g=Qe(ms((n-r)/(a||1)),0),v=R(g);g--;)v[u?g:++l]=r,r+=a;return v}function ka(r,n){var a="";if(!r||n<1||n>et)return a;do n%2&&(a+=r),n=_s(n/2),n&&(r+=r);while(n);return a}function ae(r,n){return cc(Rf(r,n,_t),r+"")}function S0(r){return Ll(Ai(r))}function P0(r,n){var a=Ai(r);return js(a,Qr(n,0,a.length))}function gn(r,n,a,u){if(!je(r))return r;n=Nr(n,r);for(var l=-1,g=n.length,v=g-1,_=r;_!=null&&++l<g;){var E=Jt(n[l]),D=a;if(E==="__proto__"||E==="constructor"||E==="prototype")return r;if(l!=v){var F=_[E];D=u?u(F,E,_):e,D===e&&(D=je(F)?F:hr(n[l+1])?[]:{})}ln(_,E,D),_=_[E]}return r}var Xl=ws?function(r,n){return ws.set(r,n),r}:_t,R0=vs?function(r,n){return vs(r,"toString",{configurable:!0,enumerable:!1,value:mc(n),writable:!0})}:_t;function O0(r){return js(Ai(r))}function jt(r,n,a){var u=-1,l=r.length;n<0&&(n=-n>l?0:l+n),a=a>l?l:a,a<0&&(a+=l),l=n>a?0:a-n>>>0,n>>>=0;for(var g=R(l);++u<l;)g[u]=r[u+n];return g}function T0(r,n){var a;return Ar(r,function(u,l,g){return a=n(u,l,g),!a}),!!a}function Rs(r,n,a){var u=0,l=r==null?u:r.length;if(typeof n=="number"&&n===n&&l<=Ge){for(;u<l;){var g=u+l>>>1,v=r[g];v!==null&&!St(v)&&(a?v<=n:v<n)?u=g+1:l=g}return l}return Ka(r,n,_t,a)}function Ka(r,n,a,u){var l=0,g=r==null?0:r.length;if(g===0)return 0;n=a(n);for(var v=n!==n,_=n===null,E=St(n),D=n===e;l<g;){var F=_s((l+g)/2),j=a(r[F]),$=j!==e,G=j===null,X=j===j,oe=St(j);if(v)var Q=u||X;else D?Q=X&&(u||$):_?Q=X&&$&&(u||!G):E?Q=X&&$&&!G&&(u||!oe):G||oe?Q=!1:Q=u?j<=n:j<n;Q?l=F+1:g=F}return at(g,Ke)}function Ql(r,n){for(var a=-1,u=r.length,l=0,g=[];++a<u;){var v=r[a],_=n?n(v):v;if(!a||!kt(_,E)){var E=_;g[l++]=v===0?0:v}}return g}function Zl(r){return typeof r=="number"?r:St(r)?Re:+r}function It(r){if(typeof r=="string")return r;if(ie(r))return Le(r,It)+"";if(St(r))return Cl?Cl.call(r):"";var n=r+"";return n=="0"&&1/r==-ke?"-0":n}function Cr(r,n,a){var u=-1,l=os,g=r.length,v=!0,_=[],E=_;if(a)v=!1,l=ba;else if(g>=o){var D=n?null:z0(r);if(D)return cs(D);v=!1,l=sn,E=new Xr}else E=n?[]:_;e:for(;++u<g;){var F=r[u],j=n?n(F):F;if(F=a||F!==0?F:0,v&&j===j){for(var $=E.length;$--;)if(E[$]===j)continue e;n&&E.push(j),_.push(F)}else l(E,j,a)||(E!==_&&E.push(j),_.push(F))}return _}function Ga(r,n){return n=Nr(n,r),r=Of(r,n),r==null||delete r[Jt(qt(n))]}function ef(r,n,a,u){return gn(r,n,a(Zr(r,n)),u)}function Os(r,n,a,u){for(var l=r.length,g=u?l:-1;(u?g--:++g<l)&&n(r[g],g,r););return a?jt(r,u?0:g,u?g+1:l):jt(r,u?g+1:0,u?l:g)}function tf(r,n){var a=r;return a instanceof ue&&(a=a.value()),Ea(n,function(u,l){return l.func.apply(l.thisArg,Rr([u],l.args))},a)}function Wa(r,n,a){var u=r.length;if(u<2)return u?Cr(r[0]):[];for(var l=-1,g=R(u);++l<u;)for(var v=r[l],_=-1;++_<u;)_!=l&&(g[l]=fn(g[l]||v,r[_],n,a));return Cr(it(g,1),n,a)}function rf(r,n,a){for(var u=-1,l=r.length,g=n.length,v={};++u<l;){var _=u<g?n[u]:e;a(v,r[u],_)}return v}function Ja(r){return He(r)?r:[]}function Ya(r){return typeof r=="function"?r:_t}function Nr(r,n){return ie(r)?r:sc(r,n)?[r]:Nf(ge(r))}var A0=ae;function Lr(r,n,a){var u=r.length;return a=a===e?u:a,!n&&a>=u?r:jt(r,n,a)}var nf=v_||function(r){return rt.clearTimeout(r)};function sf(r,n){if(n)return r.slice();var a=r.length,u=Sl?Sl(a):new r.constructor(a);return r.copy(u),u}function Xa(r){var n=new r.constructor(r.byteLength);return new ds(n).set(new ds(r)),n}function C0(r,n){var a=n?Xa(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function N0(r){var n=new r.constructor(r.source,$h.exec(r));return n.lastIndex=r.lastIndex,n}function L0(r){return hn?xe(hn.call(r)):{}}function of(r,n){var a=n?Xa(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function af(r,n){if(r!==n){var a=r!==e,u=r===null,l=r===r,g=St(r),v=n!==e,_=n===null,E=n===n,D=St(n);if(!_&&!D&&!g&&r>n||g&&v&&E&&!_&&!D||u&&v&&E||!a&&E||!l)return 1;if(!u&&!g&&!D&&r<n||D&&a&&l&&!u&&!g||_&&a&&l||!v&&l||!E)return-1}return 0}function D0(r,n,a){for(var u=-1,l=r.criteria,g=n.criteria,v=l.length,_=a.length;++u<v;){var E=af(l[u],g[u]);if(E){if(u>=_)return E;var D=a[u];return E*(D=="desc"?-1:1)}}return r.index-n.index}function cf(r,n,a,u){for(var l=-1,g=r.length,v=a.length,_=-1,E=n.length,D=Qe(g-v,0),F=R(E+D),j=!u;++_<E;)F[_]=n[_];for(;++l<v;)(j||l<g)&&(F[a[l]]=r[l]);for(;D--;)F[_++]=r[l++];return F}function uf(r,n,a,u){for(var l=-1,g=r.length,v=-1,_=a.length,E=-1,D=n.length,F=Qe(g-_,0),j=R(F+D),$=!u;++l<F;)j[l]=r[l];for(var G=l;++E<D;)j[G+E]=n[E];for(;++v<_;)($||l<g)&&(j[G+a[v]]=r[l++]);return j}function yt(r,n){var a=-1,u=r.length;for(n||(n=R(u));++a<u;)n[a]=r[a];return n}function Wt(r,n,a,u){var l=!a;a||(a={});for(var g=-1,v=n.length;++g<v;){var _=n[g],E=u?u(a[_],r[_],_,a,r):e;E===e&&(E=r[_]),l?ar(a,_,E):ln(a,_,E)}return a}function F0(r,n){return Wt(r,nc(r),n)}function j0(r,n){return Wt(r,Ef(r),n)}function Ts(r,n){return function(a,u){var l=ie(a)?$m:n0,g=n?n():{};return l(a,r,J(u,2),g)}}function Pi(r){return ae(function(n,a){var u=-1,l=a.length,g=l>1?a[l-1]:e,v=l>2?a[2]:e;for(g=r.length>3&&typeof g=="function"?(l--,g):e,v&&ft(a[0],a[1],v)&&(g=l<3?e:g,l=1),n=xe(n);++u<l;){var _=a[u];_&&r(n,_,u,g)}return n})}function hf(r,n){return function(a,u){if(a==null)return a;if(!vt(a))return r(a,u);for(var l=a.length,g=n?l:-1,v=xe(a);(n?g--:++g<l)&&u(v[g],g,v)!==!1;);return a}}function lf(r){return function(n,a,u){for(var l=-1,g=xe(n),v=u(n),_=v.length;_--;){var E=v[r?_:++l];if(a(g[E],E,g)===!1)break}return n}}function q0(r,n,a){var u=n&K,l=yn(r);function g(){var v=this&&this!==rt&&this instanceof g?l:r;return v.apply(u?a:this,arguments)}return g}function ff(r){return function(n){n=ge(n);var a=_i(n)?Vt(n):e,u=a?a[0]:n.charAt(0),l=a?Lr(a,1).join(""):n.slice(1);return u[r]()+l}}function Ri(r){return function(n){return Ea(hp(up(n).replace(Rm,"")),r,"")}}function yn(r){return function(){var n=arguments;switch(n.length){case 0:return new r;case 1:return new r(n[0]);case 2:return new r(n[0],n[1]);case 3:return new r(n[0],n[1],n[2]);case 4:return new r(n[0],n[1],n[2],n[3]);case 5:return new r(n[0],n[1],n[2],n[3],n[4]);case 6:return new r(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new r(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=Si(r.prototype),u=r.apply(a,n);return je(u)?u:a}}function M0(r,n,a){var u=yn(r);function l(){for(var g=arguments.length,v=R(g),_=g,E=Oi(l);_--;)v[_]=arguments[_];var D=g<3&&v[0]!==E&&v[g-1]!==E?[]:Or(v,E);if(g-=D.length,g<a)return vf(r,n,As,l.placeholder,e,v,D,e,e,a-g);var F=this&&this!==rt&&this instanceof l?u:r;return Et(F,this,v)}return l}function pf(r){return function(n,a,u){var l=xe(n);if(!vt(n)){var g=J(a,3);n=tt(n),a=function(_){return g(l[_],_,l)}}var v=r(n,a,u);return v>-1?l[g?n[v]:v]:e}}function df(r){return ur(function(n){var a=n.length,u=a,l=Dt.prototype.thru;for(r&&n.reverse();u--;){var g=n[u];if(typeof g!="function")throw new Lt(h);if(l&&!v&&Ds(g)=="wrapper")var v=new Dt([],!0)}for(u=v?u:a;++u<a;){g=n[u];var _=Ds(g),E=_=="wrapper"?rc(g):e;E&&oc(E[0])&&E[1]==(O|H|ee|N)&&!E[4].length&&E[9]==1?v=v[Ds(E[0])].apply(v,E[3]):v=g.length==1&&oc(g)?v[_]():v.thru(g)}return function(){var D=arguments,F=D[0];if(v&&D.length==1&&ie(F))return v.plant(F).value();for(var j=0,$=a?n[j].apply(this,D):F;++j<a;)$=n[j].call(this,$);return $}})}function As(r,n,a,u,l,g,v,_,E,D){var F=n&O,j=n&K,$=n&B,G=n&(H|U),X=n&re,oe=$?e:yn(r);function Q(){for(var ce=arguments.length,he=R(ce),Pt=ce;Pt--;)he[Pt]=arguments[Pt];if(G)var pt=Oi(Q),Rt=Ym(he,pt);if(u&&(he=cf(he,u,l,G)),g&&(he=uf(he,g,v,G)),ce-=Rt,G&&ce<D){var Ve=Or(he,pt);return vf(r,n,As,Q.placeholder,a,he,Ve,_,E,D-ce)}var Kt=j?a:this,pr=$?Kt[r]:r;return ce=he.length,_?he=nw(he,_):X&&ce>1&&he.reverse(),F&&E<ce&&(he.length=E),this&&this!==rt&&this instanceof Q&&(pr=oe||yn(pr)),pr.apply(Kt,he)}return Q}function gf(r,n){return function(a,u){return f0(a,r,n(u),{})}}function Cs(r,n){return function(a,u){var l;if(a===e&&u===e)return n;if(a!==e&&(l=a),u!==e){if(l===e)return u;typeof a=="string"||typeof u=="string"?(a=It(a),u=It(u)):(a=Zl(a),u=Zl(u)),l=r(a,u)}return l}}function Qa(r){return ur(function(n){return n=Le(n,xt(J())),ae(function(a){var u=this;return r(n,function(l){return Et(l,u,a)})})})}function Ns(r,n){n=n===e?" ":It(n);var a=n.length;if(a<2)return a?ka(n,r):n;var u=ka(n,ms(r/wi(n)));return _i(n)?Lr(Vt(u),0,r).join(""):u.slice(0,r)}function U0(r,n,a,u){var l=n&K,g=yn(r);function v(){for(var _=-1,E=arguments.length,D=-1,F=u.length,j=R(F+E),$=this&&this!==rt&&this instanceof v?g:r;++D<F;)j[D]=u[D];for(;E--;)j[D++]=arguments[++_];return Et($,l?a:this,j)}return v}function yf(r){return function(n,a,u){return u&&typeof u!="number"&&ft(n,a,u)&&(a=u=e),n=fr(n),a===e?(a=n,n=0):a=fr(a),u=u===e?n<a?1:-1:fr(u),I0(n,a,u,r)}}function Ls(r){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=Mt(n),a=Mt(a)),r(n,a)}}function vf(r,n,a,u,l,g,v,_,E,D){var F=n&H,j=F?v:e,$=F?e:v,G=F?g:e,X=F?e:g;n|=F?ee:ne,n&=~(F?ne:ee),n&Z||(n&=~(K|B));var oe=[r,n,l,G,j,X,$,_,E,D],Q=a.apply(e,oe);return oc(r)&&Tf(Q,oe),Q.placeholder=u,Af(Q,r,n)}function Za(r){var n=Xe[r];return function(a,u){if(a=Mt(a),u=u==null?0:at(se(u),292),u&&Tl(a)){var l=(ge(a)+"e").split("e"),g=n(l[0]+"e"+(+l[1]+u));return l=(ge(g)+"e").split("e"),+(l[0]+"e"+(+l[1]-u))}return n(a)}}var z0=xi&&1/cs(new xi([,-0]))[1]==ke?function(r){return new xi(r)}:bc;function mf(r){return function(n){var a=ct(n);return a==we?Ta(n):a==Ht?i_(n):Jm(n,r(n))}}function cr(r,n,a,u,l,g,v,_){var E=n&B;if(!E&&typeof r!="function")throw new Lt(h);var D=u?u.length:0;if(D||(n&=~(ee|ne),u=l=e),v=v===e?v:Qe(se(v),0),_=_===e?_:se(_),D-=l?l.length:0,n&ne){var F=u,j=l;u=l=e}var $=E?e:rc(r),G=[r,n,a,u,l,F,j,g,v,_];if($&&tw(G,$),r=G[0],n=G[1],a=G[2],u=G[3],l=G[4],_=G[9]=G[9]===e?E?0:r.length:Qe(G[9]-D,0),!_&&n&(H|U)&&(n&=~(H|U)),!n||n==K)var X=q0(r,n,a);else n==H||n==U?X=M0(r,n,_):(n==ee||n==(K|ee))&&!l.length?X=U0(r,n,a,u):X=As.apply(e,G);var oe=$?Xl:Tf;return Af(oe(X,G),r,n)}function _f(r,n,a,u){return r===e||kt(r,Ei[a])&&!me.call(u,a)?n:r}function wf(r,n,a,u,l,g){return je(r)&&je(n)&&(g.set(n,r),Ps(r,n,e,wf,g),g.delete(n)),r}function $0(r){return _n(r)?e:r}function bf(r,n,a,u,l,g){var v=a&A,_=r.length,E=n.length;if(_!=E&&!(v&&E>_))return!1;var D=g.get(r),F=g.get(n);if(D&&F)return D==n&&F==r;var j=-1,$=!0,G=a&z?new Xr:e;for(g.set(r,n),g.set(n,r);++j<_;){var X=r[j],oe=n[j];if(u)var Q=v?u(oe,X,j,n,r,g):u(X,oe,j,r,n,g);if(Q!==e){if(Q)continue;$=!1;break}if(G){if(!xa(n,function(ce,he){if(!sn(G,he)&&(X===ce||l(X,ce,a,u,g)))return G.push(he)})){$=!1;break}}else if(!(X===oe||l(X,oe,a,u,g))){$=!1;break}}return g.delete(r),g.delete(n),$}function H0(r,n,a,u,l,g,v){switch(a){case yi:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case nn:return!(r.byteLength!=n.byteLength||!g(new ds(r),new ds(n)));case Ie:case Ce:case qe:return kt(+r,+n);case Fe:return r.name==n.name&&r.message==n.message;case en:case tn:return r==n+"";case we:var _=Ta;case Ht:var E=u&A;if(_||(_=cs),r.size!=n.size&&!E)return!1;var D=v.get(r);if(D)return D==n;u|=z,v.set(r,n);var F=bf(_(r),_(n),u,l,g,v);return v.delete(r),F;case rs:if(hn)return hn.call(r)==hn.call(n)}return!1}function V0(r,n,a,u,l,g){var v=a&A,_=ec(r),E=_.length,D=ec(n),F=D.length;if(E!=F&&!v)return!1;for(var j=E;j--;){var $=_[j];if(!(v?$ in n:me.call(n,$)))return!1}var G=g.get(r),X=g.get(n);if(G&&X)return G==n&&X==r;var oe=!0;g.set(r,n),g.set(n,r);for(var Q=v;++j<E;){$=_[j];var ce=r[$],he=n[$];if(u)var Pt=v?u(he,ce,$,n,r,g):u(ce,he,$,r,n,g);if(!(Pt===e?ce===he||l(ce,he,a,u,g):Pt)){oe=!1;break}Q||(Q=$=="constructor")}if(oe&&!Q){var pt=r.constructor,Rt=n.constructor;pt!=Rt&&"constructor"in r&&"constructor"in n&&!(typeof pt=="function"&&pt instanceof pt&&typeof Rt=="function"&&Rt instanceof Rt)&&(oe=!1)}return g.delete(r),g.delete(n),oe}function ur(r){return cc(Rf(r,e,jf),r+"")}function ec(r){return zl(r,tt,nc)}function tc(r){return zl(r,mt,Ef)}var rc=ws?function(r){return ws.get(r)}:bc;function Ds(r){for(var n=r.name+"",a=Ii[n],u=me.call(Ii,n)?a.length:0;u--;){var l=a[u],g=l.func;if(g==null||g==r)return l.name}return n}function Oi(r){var n=me.call(p,"placeholder")?p:r;return n.placeholder}function J(){var r=p.iteratee||_c;return r=r===_c?Vl:r,arguments.length?r(arguments[0],arguments[1]):r}function Fs(r,n){var a=r.__data__;return X0(n)?a[typeof n=="string"?"string":"hash"]:a.map}function ic(r){for(var n=tt(r),a=n.length;a--;){var u=n[a],l=r[u];n[a]=[u,l,Sf(l)]}return n}function ei(r,n){var a=e_(r,n);return Hl(a)?a:e}function B0(r){var n=me.call(r,Jr),a=r[Jr];try{r[Jr]=e;var u=!0}catch{}var l=fs.call(r);return u&&(n?r[Jr]=a:delete r[Jr]),l}var nc=Ca?function(r){return r==null?[]:(r=xe(r),Pr(Ca(r),function(n){return Rl.call(r,n)}))}:Ec,Ef=Ca?function(r){for(var n=[];r;)Rr(n,nc(r)),r=gs(r);return n}:Ec,ct=lt;(Na&&ct(new Na(new ArrayBuffer(1)))!=yi||an&&ct(new an)!=we||La&&ct(La.resolve())!=qh||xi&&ct(new xi)!=Ht||cn&&ct(new cn)!=rn)&&(ct=function(r){var n=lt(r),a=n==nr?r.constructor:e,u=a?ti(a):"";if(u)switch(u){case P_:return yi;case R_:return we;case O_:return qh;case T_:return Ht;case A_:return rn}return n});function k0(r,n,a){for(var u=-1,l=a.length;++u<l;){var g=a[u],v=g.size;switch(g.type){case"drop":r+=v;break;case"dropRight":n-=v;break;case"take":n=at(n,r+v);break;case"takeRight":r=Qe(r,n-v);break}}return{start:r,end:n}}function K0(r){var n=r.match(Qv);return n?n[1].split(Zv):[]}function xf(r,n,a){n=Nr(n,r);for(var u=-1,l=n.length,g=!1;++u<l;){var v=Jt(n[u]);if(!(g=r!=null&&a(r,v)))break;r=r[v]}return g||++u!=l?g:(l=r==null?0:r.length,!!l&&Hs(l)&&hr(v,l)&&(ie(r)||ri(r)))}function G0(r){var n=r.length,a=new r.constructor(n);return n&&typeof r[0]=="string"&&me.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function If(r){return typeof r.constructor=="function"&&!vn(r)?Si(gs(r)):{}}function W0(r,n,a){var u=r.constructor;switch(n){case nn:return Xa(r);case Ie:case Ce:return new u(+r);case yi:return C0(r,a);case ia:case na:case sa:case oa:case aa:case ca:case ua:case ha:case la:return of(r,a);case we:return new u;case qe:case tn:return new u(r);case en:return N0(r);case Ht:return new u;case rs:return L0(r)}}function J0(r,n){var a=n.length;if(!a)return r;var u=a-1;return n[u]=(a>1?"& ":"")+n[u],n=n.join(a>2?", ":" "),r.replace(Xv,`{
/* [wrapped with `+n+`] */
`)}function Y0(r){return ie(r)||ri(r)||!!(Ol&&r&&r[Ol])}function hr(r,n){var a=typeof r;return n=n??et,!!n&&(a=="number"||a!="symbol"&&cm.test(r))&&r>-1&&r%1==0&&r<n}function ft(r,n,a){if(!je(a))return!1;var u=typeof n;return(u=="number"?vt(a)&&hr(n,a.length):u=="string"&&n in a)?kt(a[n],r):!1}function sc(r,n){if(ie(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||St(r)?!0:Gv.test(r)||!Kv.test(r)||n!=null&&r in xe(n)}function X0(r){var n=typeof r;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?r!=="__proto__":r===null}function oc(r){var n=Ds(r),a=p[n];if(typeof a!="function"||!(n in ue.prototype))return!1;if(r===a)return!0;var u=rc(a);return!!u&&r===u[0]}function Q0(r){return!!Il&&Il in r}var Z0=hs?lr:xc;function vn(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||Ei;return r===a}function Sf(r){return r===r&&!je(r)}function Pf(r,n){return function(a){return a==null?!1:a[r]===n&&(n!==e||r in xe(a))}}function ew(r){var n=zs(r,function(u){return a.size===d&&a.clear(),u}),a=n.cache;return n}function tw(r,n){var a=r[1],u=n[1],l=a|u,g=l<(K|B|O),v=u==O&&a==H||u==O&&a==N&&r[7].length<=n[8]||u==(O|N)&&n[7].length<=n[8]&&a==H;if(!(g||v))return r;u&K&&(r[2]=n[2],l|=a&K?0:Z);var _=n[3];if(_){var E=r[3];r[3]=E?cf(E,_,n[4]):_,r[4]=E?Or(r[3],w):n[4]}return _=n[5],_&&(E=r[5],r[5]=E?uf(E,_,n[6]):_,r[6]=E?Or(r[5],w):n[6]),_=n[7],_&&(r[7]=_),u&O&&(r[8]=r[8]==null?n[8]:at(r[8],n[8])),r[9]==null&&(r[9]=n[9]),r[0]=n[0],r[1]=l,r}function rw(r){var n=[];if(r!=null)for(var a in xe(r))n.push(a);return n}function iw(r){return fs.call(r)}function Rf(r,n,a){return n=Qe(n===e?r.length-1:n,0),function(){for(var u=arguments,l=-1,g=Qe(u.length-n,0),v=R(g);++l<g;)v[l]=u[n+l];l=-1;for(var _=R(n+1);++l<n;)_[l]=u[l];return _[n]=a(v),Et(r,this,_)}}function Of(r,n){return n.length<2?r:Zr(r,jt(n,0,-1))}function nw(r,n){for(var a=r.length,u=at(n.length,a),l=yt(r);u--;){var g=n[u];r[u]=hr(g,a)?l[g]:e}return r}function ac(r,n){if(!(n==="constructor"&&typeof r[n]=="function")&&n!="__proto__")return r[n]}var Tf=Cf(Xl),mn=__||function(r,n){return rt.setTimeout(r,n)},cc=Cf(R0);function Af(r,n,a){var u=n+"";return cc(r,J0(u,sw(K0(u),a)))}function Cf(r){var n=0,a=0;return function(){var u=x_(),l=q-(u-a);if(a=u,l>0){if(++n>=L)return arguments[0]}else n=0;return r.apply(e,arguments)}}function js(r,n){var a=-1,u=r.length,l=u-1;for(n=n===e?u:n;++a<n;){var g=Ba(a,l),v=r[g];r[g]=r[a],r[a]=v}return r.length=n,r}var Nf=ew(function(r){var n=[];return r.charCodeAt(0)===46&&n.push(""),r.replace(Wv,function(a,u,l,g){n.push(l?g.replace(rm,"$1"):u||a)}),n});function Jt(r){if(typeof r=="string"||St(r))return r;var n=r+"";return n=="0"&&1/r==-ke?"-0":n}function ti(r){if(r!=null){try{return ls.call(r)}catch{}try{return r+""}catch{}}return""}function sw(r,n){return Nt($e,function(a){var u="_."+a[0];n&a[1]&&!os(r,u)&&r.push(u)}),r.sort()}function Lf(r){if(r instanceof ue)return r.clone();var n=new Dt(r.__wrapped__,r.__chain__);return n.__actions__=yt(r.__actions__),n.__index__=r.__index__,n.__values__=r.__values__,n}function ow(r,n,a){(a?ft(r,n,a):n===e)?n=1:n=Qe(se(n),0);var u=r==null?0:r.length;if(!u||n<1)return[];for(var l=0,g=0,v=R(ms(u/n));l<u;)v[g++]=jt(r,l,l+=n);return v}function aw(r){for(var n=-1,a=r==null?0:r.length,u=0,l=[];++n<a;){var g=r[n];g&&(l[u++]=g)}return l}function cw(){var r=arguments.length;if(!r)return[];for(var n=R(r-1),a=arguments[0],u=r;u--;)n[u-1]=arguments[u];return Rr(ie(a)?yt(a):[a],it(n,1))}var uw=ae(function(r,n){return He(r)?fn(r,it(n,1,He,!0)):[]}),hw=ae(function(r,n){var a=qt(n);return He(a)&&(a=e),He(r)?fn(r,it(n,1,He,!0),J(a,2)):[]}),lw=ae(function(r,n){var a=qt(n);return He(a)&&(a=e),He(r)?fn(r,it(n,1,He,!0),e,a):[]});function fw(r,n,a){var u=r==null?0:r.length;return u?(n=a||n===e?1:se(n),jt(r,n<0?0:n,u)):[]}function pw(r,n,a){var u=r==null?0:r.length;return u?(n=a||n===e?1:se(n),n=u-n,jt(r,0,n<0?0:n)):[]}function dw(r,n){return r&&r.length?Os(r,J(n,3),!0,!0):[]}function gw(r,n){return r&&r.length?Os(r,J(n,3),!0):[]}function yw(r,n,a,u){var l=r==null?0:r.length;return l?(a&&typeof a!="number"&&ft(r,n,a)&&(a=0,u=l),c0(r,n,a,u)):[]}function Df(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var l=a==null?0:se(a);return l<0&&(l=Qe(u+l,0)),as(r,J(n,3),l)}function Ff(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var l=u-1;return a!==e&&(l=se(a),l=a<0?Qe(u+l,0):at(l,u-1)),as(r,J(n,3),l,!0)}function jf(r){var n=r==null?0:r.length;return n?it(r,1):[]}function vw(r){var n=r==null?0:r.length;return n?it(r,ke):[]}function mw(r,n){var a=r==null?0:r.length;return a?(n=n===e?1:se(n),it(r,n)):[]}function _w(r){for(var n=-1,a=r==null?0:r.length,u={};++n<a;){var l=r[n];u[l[0]]=l[1]}return u}function qf(r){return r&&r.length?r[0]:e}function ww(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var l=a==null?0:se(a);return l<0&&(l=Qe(u+l,0)),mi(r,n,l)}function bw(r){var n=r==null?0:r.length;return n?jt(r,0,-1):[]}var Ew=ae(function(r){var n=Le(r,Ja);return n.length&&n[0]===r[0]?Ua(n):[]}),xw=ae(function(r){var n=qt(r),a=Le(r,Ja);return n===qt(a)?n=e:a.pop(),a.length&&a[0]===r[0]?Ua(a,J(n,2)):[]}),Iw=ae(function(r){var n=qt(r),a=Le(r,Ja);return n=typeof n=="function"?n:e,n&&a.pop(),a.length&&a[0]===r[0]?Ua(a,e,n):[]});function Sw(r,n){return r==null?"":b_.call(r,n)}function qt(r){var n=r==null?0:r.length;return n?r[n-1]:e}function Pw(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var l=u;return a!==e&&(l=se(a),l=l<0?Qe(u+l,0):at(l,u-1)),n===n?s_(r,n,l):as(r,yl,l,!0)}function Rw(r,n){return r&&r.length?Gl(r,se(n)):e}var Ow=ae(Mf);function Mf(r,n){return r&&r.length&&n&&n.length?Va(r,n):r}function Tw(r,n,a){return r&&r.length&&n&&n.length?Va(r,n,J(a,2)):r}function Aw(r,n,a){return r&&r.length&&n&&n.length?Va(r,n,e,a):r}var Cw=ur(function(r,n){var a=r==null?0:r.length,u=Fa(r,n);return Yl(r,Le(n,function(l){return hr(l,a)?+l:l}).sort(af)),u});function Nw(r,n){var a=[];if(!(r&&r.length))return a;var u=-1,l=[],g=r.length;for(n=J(n,3);++u<g;){var v=r[u];n(v,u,r)&&(a.push(v),l.push(u))}return Yl(r,l),a}function uc(r){return r==null?r:S_.call(r)}function Lw(r,n,a){var u=r==null?0:r.length;return u?(a&&typeof a!="number"&&ft(r,n,a)?(n=0,a=u):(n=n==null?0:se(n),a=a===e?u:se(a)),jt(r,n,a)):[]}function Dw(r,n){return Rs(r,n)}function Fw(r,n,a){return Ka(r,n,J(a,2))}function jw(r,n){var a=r==null?0:r.length;if(a){var u=Rs(r,n);if(u<a&&kt(r[u],n))return u}return-1}function qw(r,n){return Rs(r,n,!0)}function Mw(r,n,a){return Ka(r,n,J(a,2),!0)}function Uw(r,n){var a=r==null?0:r.length;if(a){var u=Rs(r,n,!0)-1;if(kt(r[u],n))return u}return-1}function zw(r){return r&&r.length?Ql(r):[]}function $w(r,n){return r&&r.length?Ql(r,J(n,2)):[]}function Hw(r){var n=r==null?0:r.length;return n?jt(r,1,n):[]}function Vw(r,n,a){return r&&r.length?(n=a||n===e?1:se(n),jt(r,0,n<0?0:n)):[]}function Bw(r,n,a){var u=r==null?0:r.length;return u?(n=a||n===e?1:se(n),n=u-n,jt(r,n<0?0:n,u)):[]}function kw(r,n){return r&&r.length?Os(r,J(n,3),!1,!0):[]}function Kw(r,n){return r&&r.length?Os(r,J(n,3)):[]}var Gw=ae(function(r){return Cr(it(r,1,He,!0))}),Ww=ae(function(r){var n=qt(r);return He(n)&&(n=e),Cr(it(r,1,He,!0),J(n,2))}),Jw=ae(function(r){var n=qt(r);return n=typeof n=="function"?n:e,Cr(it(r,1,He,!0),e,n)});function Yw(r){return r&&r.length?Cr(r):[]}function Xw(r,n){return r&&r.length?Cr(r,J(n,2)):[]}function Qw(r,n){return n=typeof n=="function"?n:e,r&&r.length?Cr(r,e,n):[]}function hc(r){if(!(r&&r.length))return[];var n=0;return r=Pr(r,function(a){if(He(a))return n=Qe(a.length,n),!0}),Ra(n,function(a){return Le(r,Ia(a))})}function Uf(r,n){if(!(r&&r.length))return[];var a=hc(r);return n==null?a:Le(a,function(u){return Et(n,e,u)})}var Zw=ae(function(r,n){return He(r)?fn(r,n):[]}),eb=ae(function(r){return Wa(Pr(r,He))}),tb=ae(function(r){var n=qt(r);return He(n)&&(n=e),Wa(Pr(r,He),J(n,2))}),rb=ae(function(r){var n=qt(r);return n=typeof n=="function"?n:e,Wa(Pr(r,He),e,n)}),ib=ae(hc);function nb(r,n){return rf(r||[],n||[],ln)}function sb(r,n){return rf(r||[],n||[],gn)}var ob=ae(function(r){var n=r.length,a=n>1?r[n-1]:e;return a=typeof a=="function"?(r.pop(),a):e,Uf(r,a)});function zf(r){var n=p(r);return n.__chain__=!0,n}function ab(r,n){return n(r),r}function qs(r,n){return n(r)}var cb=ur(function(r){var n=r.length,a=n?r[0]:0,u=this.__wrapped__,l=function(g){return Fa(g,r)};return n>1||this.__actions__.length||!(u instanceof ue)||!hr(a)?this.thru(l):(u=u.slice(a,+a+(n?1:0)),u.__actions__.push({func:qs,args:[l],thisArg:e}),new Dt(u,this.__chain__).thru(function(g){return n&&!g.length&&g.push(e),g}))});function ub(){return zf(this)}function hb(){return new Dt(this.value(),this.__chain__)}function lb(){this.__values__===e&&(this.__values__=ep(this.value()));var r=this.__index__>=this.__values__.length,n=r?e:this.__values__[this.__index__++];return{done:r,value:n}}function fb(){return this}function pb(r){for(var n,a=this;a instanceof Es;){var u=Lf(a);u.__index__=0,u.__values__=e,n?l.__wrapped__=u:n=u;var l=u;a=a.__wrapped__}return l.__wrapped__=r,n}function db(){var r=this.__wrapped__;if(r instanceof ue){var n=r;return this.__actions__.length&&(n=new ue(this)),n=n.reverse(),n.__actions__.push({func:qs,args:[uc],thisArg:e}),new Dt(n,this.__chain__)}return this.thru(uc)}function gb(){return tf(this.__wrapped__,this.__actions__)}var yb=Ts(function(r,n,a){me.call(r,a)?++r[a]:ar(r,a,1)});function vb(r,n,a){var u=ie(r)?dl:a0;return a&&ft(r,n,a)&&(n=e),u(r,J(n,3))}function mb(r,n){var a=ie(r)?Pr:Ml;return a(r,J(n,3))}var _b=pf(Df),wb=pf(Ff);function bb(r,n){return it(Ms(r,n),1)}function Eb(r,n){return it(Ms(r,n),ke)}function xb(r,n,a){return a=a===e?1:se(a),it(Ms(r,n),a)}function $f(r,n){var a=ie(r)?Nt:Ar;return a(r,J(n,3))}function Hf(r,n){var a=ie(r)?Hm:ql;return a(r,J(n,3))}var Ib=Ts(function(r,n,a){me.call(r,a)?r[a].push(n):ar(r,a,[n])});function Sb(r,n,a,u){r=vt(r)?r:Ai(r),a=a&&!u?se(a):0;var l=r.length;return a<0&&(a=Qe(l+a,0)),Vs(r)?a<=l&&r.indexOf(n,a)>-1:!!l&&mi(r,n,a)>-1}var Pb=ae(function(r,n,a){var u=-1,l=typeof n=="function",g=vt(r)?R(r.length):[];return Ar(r,function(v){g[++u]=l?Et(n,v,a):pn(v,n,a)}),g}),Rb=Ts(function(r,n,a){ar(r,a,n)});function Ms(r,n){var a=ie(r)?Le:Bl;return a(r,J(n,3))}function Ob(r,n,a,u){return r==null?[]:(ie(n)||(n=n==null?[]:[n]),a=u?e:a,ie(a)||(a=a==null?[]:[a]),Wl(r,n,a))}var Tb=Ts(function(r,n,a){r[a?0:1].push(n)},function(){return[[],[]]});function Ab(r,n,a){var u=ie(r)?Ea:ml,l=arguments.length<3;return u(r,J(n,4),a,l,Ar)}function Cb(r,n,a){var u=ie(r)?Vm:ml,l=arguments.length<3;return u(r,J(n,4),a,l,ql)}function Nb(r,n){var a=ie(r)?Pr:Ml;return a(r,$s(J(n,3)))}function Lb(r){var n=ie(r)?Ll:S0;return n(r)}function Db(r,n,a){(a?ft(r,n,a):n===e)?n=1:n=se(n);var u=ie(r)?r0:P0;return u(r,n)}function Fb(r){var n=ie(r)?i0:O0;return n(r)}function jb(r){if(r==null)return 0;if(vt(r))return Vs(r)?wi(r):r.length;var n=ct(r);return n==we||n==Ht?r.size:$a(r).length}function qb(r,n,a){var u=ie(r)?xa:T0;return a&&ft(r,n,a)&&(n=e),u(r,J(n,3))}var Mb=ae(function(r,n){if(r==null)return[];var a=n.length;return a>1&&ft(r,n[0],n[1])?n=[]:a>2&&ft(n[0],n[1],n[2])&&(n=[n[0]]),Wl(r,it(n,1),[])}),Us=m_||function(){return rt.Date.now()};function Ub(r,n){if(typeof n!="function")throw new Lt(h);return r=se(r),function(){if(--r<1)return n.apply(this,arguments)}}function Vf(r,n,a){return n=a?e:n,n=r&&n==null?r.length:n,cr(r,O,e,e,e,e,n)}function Bf(r,n){var a;if(typeof n!="function")throw new Lt(h);return r=se(r),function(){return--r>0&&(a=n.apply(this,arguments)),r<=1&&(n=e),a}}var lc=ae(function(r,n,a){var u=K;if(a.length){var l=Or(a,Oi(lc));u|=ee}return cr(r,u,n,a,l)}),kf=ae(function(r,n,a){var u=K|B;if(a.length){var l=Or(a,Oi(kf));u|=ee}return cr(n,u,r,a,l)});function Kf(r,n,a){n=a?e:n;var u=cr(r,H,e,e,e,e,e,n);return u.placeholder=Kf.placeholder,u}function Gf(r,n,a){n=a?e:n;var u=cr(r,U,e,e,e,e,e,n);return u.placeholder=Gf.placeholder,u}function Wf(r,n,a){var u,l,g,v,_,E,D=0,F=!1,j=!1,$=!0;if(typeof r!="function")throw new Lt(h);n=Mt(n)||0,je(a)&&(F=!!a.leading,j="maxWait"in a,g=j?Qe(Mt(a.maxWait)||0,n):g,$="trailing"in a?!!a.trailing:$);function G(Ve){var Kt=u,pr=l;return u=l=e,D=Ve,v=r.apply(pr,Kt),v}function X(Ve){return D=Ve,_=mn(ce,n),F?G(Ve):v}function oe(Ve){var Kt=Ve-E,pr=Ve-D,pp=n-Kt;return j?at(pp,g-pr):pp}function Q(Ve){var Kt=Ve-E,pr=Ve-D;return E===e||Kt>=n||Kt<0||j&&pr>=g}function ce(){var Ve=Us();if(Q(Ve))return he(Ve);_=mn(ce,oe(Ve))}function he(Ve){return _=e,$&&u?G(Ve):(u=l=e,v)}function Pt(){_!==e&&nf(_),D=0,u=E=l=_=e}function pt(){return _===e?v:he(Us())}function Rt(){var Ve=Us(),Kt=Q(Ve);if(u=arguments,l=this,E=Ve,Kt){if(_===e)return X(E);if(j)return nf(_),_=mn(ce,n),G(E)}return _===e&&(_=mn(ce,n)),v}return Rt.cancel=Pt,Rt.flush=pt,Rt}var zb=ae(function(r,n){return jl(r,1,n)}),$b=ae(function(r,n,a){return jl(r,Mt(n)||0,a)});function Hb(r){return cr(r,re)}function zs(r,n){if(typeof r!="function"||n!=null&&typeof n!="function")throw new Lt(h);var a=function(){var u=arguments,l=n?n.apply(this,u):u[0],g=a.cache;if(g.has(l))return g.get(l);var v=r.apply(this,u);return a.cache=g.set(l,v)||g,v};return a.cache=new(zs.Cache||or),a}zs.Cache=or;function $s(r){if(typeof r!="function")throw new Lt(h);return function(){var n=arguments;switch(n.length){case 0:return!r.call(this);case 1:return!r.call(this,n[0]);case 2:return!r.call(this,n[0],n[1]);case 3:return!r.call(this,n[0],n[1],n[2])}return!r.apply(this,n)}}function Vb(r){return Bf(2,r)}var Bb=A0(function(r,n){n=n.length==1&&ie(n[0])?Le(n[0],xt(J())):Le(it(n,1),xt(J()));var a=n.length;return ae(function(u){for(var l=-1,g=at(u.length,a);++l<g;)u[l]=n[l].call(this,u[l]);return Et(r,this,u)})}),fc=ae(function(r,n){var a=Or(n,Oi(fc));return cr(r,ee,e,n,a)}),Jf=ae(function(r,n){var a=Or(n,Oi(Jf));return cr(r,ne,e,n,a)}),kb=ur(function(r,n){return cr(r,N,e,e,e,n)});function Kb(r,n){if(typeof r!="function")throw new Lt(h);return n=n===e?n:se(n),ae(r,n)}function Gb(r,n){if(typeof r!="function")throw new Lt(h);return n=n==null?0:Qe(se(n),0),ae(function(a){var u=a[n],l=Lr(a,0,n);return u&&Rr(l,u),Et(r,this,l)})}function Wb(r,n,a){var u=!0,l=!0;if(typeof r!="function")throw new Lt(h);return je(a)&&(u="leading"in a?!!a.leading:u,l="trailing"in a?!!a.trailing:l),Wf(r,n,{leading:u,maxWait:n,trailing:l})}function Jb(r){return Vf(r,1)}function Yb(r,n){return fc(Ya(n),r)}function Xb(){if(!arguments.length)return[];var r=arguments[0];return ie(r)?r:[r]}function Qb(r){return Ft(r,T)}function Zb(r,n){return n=typeof n=="function"?n:e,Ft(r,T,n)}function e1(r){return Ft(r,S|T)}function t1(r,n){return n=typeof n=="function"?n:e,Ft(r,S|T,n)}function r1(r,n){return n==null||Fl(r,n,tt(n))}function kt(r,n){return r===n||r!==r&&n!==n}var i1=Ls(Ma),n1=Ls(function(r,n){return r>=n}),ri=$l(function(){return arguments}())?$l:function(r){return Me(r)&&me.call(r,"callee")&&!Rl.call(r,"callee")},ie=R.isArray,s1=cl?xt(cl):p0;function vt(r){return r!=null&&Hs(r.length)&&!lr(r)}function He(r){return Me(r)&&vt(r)}function o1(r){return r===!0||r===!1||Me(r)&&lt(r)==Ie}var Dr=w_||xc,a1=ul?xt(ul):d0;function c1(r){return Me(r)&&r.nodeType===1&&!_n(r)}function u1(r){if(r==null)return!0;if(vt(r)&&(ie(r)||typeof r=="string"||typeof r.splice=="function"||Dr(r)||Ti(r)||ri(r)))return!r.length;var n=ct(r);if(n==we||n==Ht)return!r.size;if(vn(r))return!$a(r).length;for(var a in r)if(me.call(r,a))return!1;return!0}function h1(r,n){return dn(r,n)}function l1(r,n,a){a=typeof a=="function"?a:e;var u=a?a(r,n):e;return u===e?dn(r,n,e,a):!!u}function pc(r){if(!Me(r))return!1;var n=lt(r);return n==Fe||n==Je||typeof r.message=="string"&&typeof r.name=="string"&&!_n(r)}function f1(r){return typeof r=="number"&&Tl(r)}function lr(r){if(!je(r))return!1;var n=lt(r);return n==Ne||n==Ye||n==We||n==jv}function Yf(r){return typeof r=="number"&&r==se(r)}function Hs(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=et}function je(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}function Me(r){return r!=null&&typeof r=="object"}var Xf=hl?xt(hl):y0;function p1(r,n){return r===n||za(r,n,ic(n))}function d1(r,n,a){return a=typeof a=="function"?a:e,za(r,n,ic(n),a)}function g1(r){return Qf(r)&&r!=+r}function y1(r){if(Z0(r))throw new te(c);return Hl(r)}function v1(r){return r===null}function m1(r){return r==null}function Qf(r){return typeof r=="number"||Me(r)&&lt(r)==qe}function _n(r){if(!Me(r)||lt(r)!=nr)return!1;var n=gs(r);if(n===null)return!0;var a=me.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&ls.call(a)==d_}var dc=ll?xt(ll):v0;function _1(r){return Yf(r)&&r>=-et&&r<=et}var Zf=fl?xt(fl):m0;function Vs(r){return typeof r=="string"||!ie(r)&&Me(r)&&lt(r)==tn}function St(r){return typeof r=="symbol"||Me(r)&&lt(r)==rs}var Ti=pl?xt(pl):_0;function w1(r){return r===e}function b1(r){return Me(r)&&ct(r)==rn}function E1(r){return Me(r)&&lt(r)==Mv}var x1=Ls(Ha),I1=Ls(function(r,n){return r<=n});function ep(r){if(!r)return[];if(vt(r))return Vs(r)?Vt(r):yt(r);if(on&&r[on])return r_(r[on]());var n=ct(r),a=n==we?Ta:n==Ht?cs:Ai;return a(r)}function fr(r){if(!r)return r===0?r:0;if(r=Mt(r),r===ke||r===-ke){var n=r<0?-1:1;return n*gi}return r===r?r:0}function se(r){var n=fr(r),a=n%1;return n===n?a?n-a:n:0}function tp(r){return r?Qr(se(r),0,ve):0}function Mt(r){if(typeof r=="number")return r;if(St(r))return Re;if(je(r)){var n=typeof r.valueOf=="function"?r.valueOf():r;r=je(n)?n+"":n}if(typeof r!="string")return r===0?r:+r;r=_l(r);var a=sm.test(r);return a||am.test(r)?Um(r.slice(2),a?2:8):nm.test(r)?Re:+r}function rp(r){return Wt(r,mt(r))}function S1(r){return r?Qr(se(r),-et,et):r===0?r:0}function ge(r){return r==null?"":It(r)}var P1=Pi(function(r,n){if(vn(n)||vt(n)){Wt(n,tt(n),r);return}for(var a in n)me.call(n,a)&&ln(r,a,n[a])}),ip=Pi(function(r,n){Wt(n,mt(n),r)}),Bs=Pi(function(r,n,a,u){Wt(n,mt(n),r,u)}),R1=Pi(function(r,n,a,u){Wt(n,tt(n),r,u)}),O1=ur(Fa);function T1(r,n){var a=Si(r);return n==null?a:Dl(a,n)}var A1=ae(function(r,n){r=xe(r);var a=-1,u=n.length,l=u>2?n[2]:e;for(l&&ft(n[0],n[1],l)&&(u=1);++a<u;)for(var g=n[a],v=mt(g),_=-1,E=v.length;++_<E;){var D=v[_],F=r[D];(F===e||kt(F,Ei[D])&&!me.call(r,D))&&(r[D]=g[D])}return r}),C1=ae(function(r){return r.push(e,wf),Et(np,e,r)});function N1(r,n){return gl(r,J(n,3),Gt)}function L1(r,n){return gl(r,J(n,3),qa)}function D1(r,n){return r==null?r:ja(r,J(n,3),mt)}function F1(r,n){return r==null?r:Ul(r,J(n,3),mt)}function j1(r,n){return r&&Gt(r,J(n,3))}function q1(r,n){return r&&qa(r,J(n,3))}function M1(r){return r==null?[]:Ss(r,tt(r))}function U1(r){return r==null?[]:Ss(r,mt(r))}function gc(r,n,a){var u=r==null?e:Zr(r,n);return u===e?a:u}function z1(r,n){return r!=null&&xf(r,n,u0)}function yc(r,n){return r!=null&&xf(r,n,h0)}var $1=gf(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=fs.call(n)),r[n]=a},mc(_t)),H1=gf(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=fs.call(n)),me.call(r,n)?r[n].push(a):r[n]=[a]},J),V1=ae(pn);function tt(r){return vt(r)?Nl(r):$a(r)}function mt(r){return vt(r)?Nl(r,!0):w0(r)}function B1(r,n){var a={};return n=J(n,3),Gt(r,function(u,l,g){ar(a,n(u,l,g),u)}),a}function k1(r,n){var a={};return n=J(n,3),Gt(r,function(u,l,g){ar(a,l,n(u,l,g))}),a}var K1=Pi(function(r,n,a){Ps(r,n,a)}),np=Pi(function(r,n,a,u){Ps(r,n,a,u)}),G1=ur(function(r,n){var a={};if(r==null)return a;var u=!1;n=Le(n,function(g){return g=Nr(g,r),u||(u=g.length>1),g}),Wt(r,tc(r),a),u&&(a=Ft(a,S|x|T,$0));for(var l=n.length;l--;)Ga(a,n[l]);return a});function W1(r,n){return sp(r,$s(J(n)))}var J1=ur(function(r,n){return r==null?{}:E0(r,n)});function sp(r,n){if(r==null)return{};var a=Le(tc(r),function(u){return[u]});return n=J(n),Jl(r,a,function(u,l){return n(u,l[0])})}function Y1(r,n,a){n=Nr(n,r);var u=-1,l=n.length;for(l||(l=1,r=e);++u<l;){var g=r==null?e:r[Jt(n[u])];g===e&&(u=l,g=a),r=lr(g)?g.call(r):g}return r}function X1(r,n,a){return r==null?r:gn(r,n,a)}function Q1(r,n,a,u){return u=typeof u=="function"?u:e,r==null?r:gn(r,n,a,u)}var op=mf(tt),ap=mf(mt);function Z1(r,n,a){var u=ie(r),l=u||Dr(r)||Ti(r);if(n=J(n,4),a==null){var g=r&&r.constructor;l?a=u?new g:[]:je(r)?a=lr(g)?Si(gs(r)):{}:a={}}return(l?Nt:Gt)(r,function(v,_,E){return n(a,v,_,E)}),a}function eE(r,n){return r==null?!0:Ga(r,n)}function tE(r,n,a){return r==null?r:ef(r,n,Ya(a))}function rE(r,n,a,u){return u=typeof u=="function"?u:e,r==null?r:ef(r,n,Ya(a),u)}function Ai(r){return r==null?[]:Oa(r,tt(r))}function iE(r){return r==null?[]:Oa(r,mt(r))}function nE(r,n,a){return a===e&&(a=n,n=e),a!==e&&(a=Mt(a),a=a===a?a:0),n!==e&&(n=Mt(n),n=n===n?n:0),Qr(Mt(r),n,a)}function sE(r,n,a){return n=fr(n),a===e?(a=n,n=0):a=fr(a),r=Mt(r),l0(r,n,a)}function oE(r,n,a){if(a&&typeof a!="boolean"&&ft(r,n,a)&&(n=a=e),a===e&&(typeof n=="boolean"?(a=n,n=e):typeof r=="boolean"&&(a=r,r=e)),r===e&&n===e?(r=0,n=1):(r=fr(r),n===e?(n=r,r=0):n=fr(n)),r>n){var u=r;r=n,n=u}if(a||r%1||n%1){var l=Al();return at(r+l*(n-r+Mm("1e-"+((l+"").length-1))),n)}return Ba(r,n)}var aE=Ri(function(r,n,a){return n=n.toLowerCase(),r+(a?cp(n):n)});function cp(r){return vc(ge(r).toLowerCase())}function up(r){return r=ge(r),r&&r.replace(um,Xm).replace(Om,"")}function cE(r,n,a){r=ge(r),n=It(n);var u=r.length;a=a===e?u:Qr(se(a),0,u);var l=a;return a-=n.length,a>=0&&r.slice(a,l)==n}function uE(r){return r=ge(r),r&&Vv.test(r)?r.replace(Uh,Qm):r}function hE(r){return r=ge(r),r&&Jv.test(r)?r.replace(fa,"\\$&"):r}var lE=Ri(function(r,n,a){return r+(a?"-":"")+n.toLowerCase()}),fE=Ri(function(r,n,a){return r+(a?" ":"")+n.toLowerCase()}),pE=ff("toLowerCase");function dE(r,n,a){r=ge(r),n=se(n);var u=n?wi(r):0;if(!n||u>=n)return r;var l=(n-u)/2;return Ns(_s(l),a)+r+Ns(ms(l),a)}function gE(r,n,a){r=ge(r),n=se(n);var u=n?wi(r):0;return n&&u<n?r+Ns(n-u,a):r}function yE(r,n,a){r=ge(r),n=se(n);var u=n?wi(r):0;return n&&u<n?Ns(n-u,a)+r:r}function vE(r,n,a){return a||n==null?n=0:n&&(n=+n),I_(ge(r).replace(pa,""),n||0)}function mE(r,n,a){return(a?ft(r,n,a):n===e)?n=1:n=se(n),ka(ge(r),n)}function _E(){var r=arguments,n=ge(r[0]);return r.length<3?n:n.replace(r[1],r[2])}var wE=Ri(function(r,n,a){return r+(a?"_":"")+n.toLowerCase()});function bE(r,n,a){return a&&typeof a!="number"&&ft(r,n,a)&&(n=a=e),a=a===e?ve:a>>>0,a?(r=ge(r),r&&(typeof n=="string"||n!=null&&!dc(n))&&(n=It(n),!n&&_i(r))?Lr(Vt(r),0,a):r.split(n,a)):[]}var EE=Ri(function(r,n,a){return r+(a?" ":"")+vc(n)});function xE(r,n,a){return r=ge(r),a=a==null?0:Qr(se(a),0,r.length),n=It(n),r.slice(a,a+n.length)==n}function IE(r,n,a){var u=p.templateSettings;a&&ft(r,n,a)&&(n=e),r=ge(r),n=Bs({},n,u,_f);var l=Bs({},n.imports,u.imports,_f),g=tt(l),v=Oa(l,g),_,E,D=0,F=n.interpolate||is,j="__p += '",$=Aa((n.escape||is).source+"|"+F.source+"|"+(F===zh?im:is).source+"|"+(n.evaluate||is).source+"|$","g"),G="//# sourceURL="+(me.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Lm+"]")+`
`;r.replace($,function(Q,ce,he,Pt,pt,Rt){return he||(he=Pt),j+=r.slice(D,Rt).replace(hm,Zm),ce&&(_=!0,j+=`' +
__e(`+ce+`) +
'`),pt&&(E=!0,j+=`';
`+pt+`;
__p += '`),he&&(j+=`' +
((__t = (`+he+`)) == null ? '' : __t) +
'`),D=Rt+Q.length,Q}),j+=`';
`;var X=me.call(n,"variable")&&n.variable;if(!X)j=`with (obj) {
`+j+`
}
`;else if(tm.test(X))throw new te(f);j=(E?j.replace(Uv,""):j).replace(zv,"$1").replace($v,"$1;"),j="function("+(X||"obj")+`) {
`+(X?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_?", __e = _.escape":"")+(E?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+j+`return __p
}`;var oe=lp(function(){return de(g,G+"return "+j).apply(e,v)});if(oe.source=j,pc(oe))throw oe;return oe}function SE(r){return ge(r).toLowerCase()}function PE(r){return ge(r).toUpperCase()}function RE(r,n,a){if(r=ge(r),r&&(a||n===e))return _l(r);if(!r||!(n=It(n)))return r;var u=Vt(r),l=Vt(n),g=wl(u,l),v=bl(u,l)+1;return Lr(u,g,v).join("")}function OE(r,n,a){if(r=ge(r),r&&(a||n===e))return r.slice(0,xl(r)+1);if(!r||!(n=It(n)))return r;var u=Vt(r),l=bl(u,Vt(n))+1;return Lr(u,0,l).join("")}function TE(r,n,a){if(r=ge(r),r&&(a||n===e))return r.replace(pa,"");if(!r||!(n=It(n)))return r;var u=Vt(r),l=wl(u,Vt(n));return Lr(u,l).join("")}function AE(r,n){var a=I,u=P;if(je(n)){var l="separator"in n?n.separator:l;a="length"in n?se(n.length):a,u="omission"in n?It(n.omission):u}r=ge(r);var g=r.length;if(_i(r)){var v=Vt(r);g=v.length}if(a>=g)return r;var _=a-wi(u);if(_<1)return u;var E=v?Lr(v,0,_).join(""):r.slice(0,_);if(l===e)return E+u;if(v&&(_+=E.length-_),dc(l)){if(r.slice(_).search(l)){var D,F=E;for(l.global||(l=Aa(l.source,ge($h.exec(l))+"g")),l.lastIndex=0;D=l.exec(F);)var j=D.index;E=E.slice(0,j===e?_:j)}}else if(r.indexOf(It(l),_)!=_){var $=E.lastIndexOf(l);$>-1&&(E=E.slice(0,$))}return E+u}function CE(r){return r=ge(r),r&&Hv.test(r)?r.replace(Mh,o_):r}var NE=Ri(function(r,n,a){return r+(a?" ":"")+n.toUpperCase()}),vc=ff("toUpperCase");function hp(r,n,a){return r=ge(r),n=a?e:n,n===e?t_(r)?u_(r):Km(r):r.match(n)||[]}var lp=ae(function(r,n){try{return Et(r,e,n)}catch(a){return pc(a)?a:new te(a)}}),LE=ur(function(r,n){return Nt(n,function(a){a=Jt(a),ar(r,a,lc(r[a],r))}),r});function DE(r){var n=r==null?0:r.length,a=J();return r=n?Le(r,function(u){if(typeof u[1]!="function")throw new Lt(h);return[a(u[0]),u[1]]}):[],ae(function(u){for(var l=-1;++l<n;){var g=r[l];if(Et(g[0],this,u))return Et(g[1],this,u)}})}function FE(r){return o0(Ft(r,S))}function mc(r){return function(){return r}}function jE(r,n){return r==null||r!==r?n:r}var qE=df(),ME=df(!0);function _t(r){return r}function _c(r){return Vl(typeof r=="function"?r:Ft(r,S))}function UE(r){return kl(Ft(r,S))}function zE(r,n){return Kl(r,Ft(n,S))}var $E=ae(function(r,n){return function(a){return pn(a,r,n)}}),HE=ae(function(r,n){return function(a){return pn(r,a,n)}});function wc(r,n,a){var u=tt(n),l=Ss(n,u);a==null&&!(je(n)&&(l.length||!u.length))&&(a=n,n=r,r=this,l=Ss(n,tt(n)));var g=!(je(a)&&"chain"in a)||!!a.chain,v=lr(r);return Nt(l,function(_){var E=n[_];r[_]=E,v&&(r.prototype[_]=function(){var D=this.__chain__;if(g||D){var F=r(this.__wrapped__),j=F.__actions__=yt(this.__actions__);return j.push({func:E,args:arguments,thisArg:r}),F.__chain__=D,F}return E.apply(r,Rr([this.value()],arguments))})}),r}function VE(){return rt._===this&&(rt._=g_),this}function bc(){}function BE(r){return r=se(r),ae(function(n){return Gl(n,r)})}var kE=Qa(Le),KE=Qa(dl),GE=Qa(xa);function fp(r){return sc(r)?Ia(Jt(r)):x0(r)}function WE(r){return function(n){return r==null?e:Zr(r,n)}}var JE=yf(),YE=yf(!0);function Ec(){return[]}function xc(){return!1}function XE(){return{}}function QE(){return""}function ZE(){return!0}function ex(r,n){if(r=se(r),r<1||r>et)return[];var a=ve,u=at(r,ve);n=J(n),r-=ve;for(var l=Ra(u,n);++a<r;)n(a);return l}function tx(r){return ie(r)?Le(r,Jt):St(r)?[r]:yt(Nf(ge(r)))}function rx(r){var n=++p_;return ge(r)+n}var ix=Cs(function(r,n){return r+n},0),nx=Za("ceil"),sx=Cs(function(r,n){return r/n},1),ox=Za("floor");function ax(r){return r&&r.length?Is(r,_t,Ma):e}function cx(r,n){return r&&r.length?Is(r,J(n,2),Ma):e}function ux(r){return vl(r,_t)}function hx(r,n){return vl(r,J(n,2))}function lx(r){return r&&r.length?Is(r,_t,Ha):e}function fx(r,n){return r&&r.length?Is(r,J(n,2),Ha):e}var px=Cs(function(r,n){return r*n},1),dx=Za("round"),gx=Cs(function(r,n){return r-n},0);function yx(r){return r&&r.length?Pa(r,_t):0}function vx(r,n){return r&&r.length?Pa(r,J(n,2)):0}return p.after=Ub,p.ary=Vf,p.assign=P1,p.assignIn=ip,p.assignInWith=Bs,p.assignWith=R1,p.at=O1,p.before=Bf,p.bind=lc,p.bindAll=LE,p.bindKey=kf,p.castArray=Xb,p.chain=zf,p.chunk=ow,p.compact=aw,p.concat=cw,p.cond=DE,p.conforms=FE,p.constant=mc,p.countBy=yb,p.create=T1,p.curry=Kf,p.curryRight=Gf,p.debounce=Wf,p.defaults=A1,p.defaultsDeep=C1,p.defer=zb,p.delay=$b,p.difference=uw,p.differenceBy=hw,p.differenceWith=lw,p.drop=fw,p.dropRight=pw,p.dropRightWhile=dw,p.dropWhile=gw,p.fill=yw,p.filter=mb,p.flatMap=bb,p.flatMapDeep=Eb,p.flatMapDepth=xb,p.flatten=jf,p.flattenDeep=vw,p.flattenDepth=mw,p.flip=Hb,p.flow=qE,p.flowRight=ME,p.fromPairs=_w,p.functions=M1,p.functionsIn=U1,p.groupBy=Ib,p.initial=bw,p.intersection=Ew,p.intersectionBy=xw,p.intersectionWith=Iw,p.invert=$1,p.invertBy=H1,p.invokeMap=Pb,p.iteratee=_c,p.keyBy=Rb,p.keys=tt,p.keysIn=mt,p.map=Ms,p.mapKeys=B1,p.mapValues=k1,p.matches=UE,p.matchesProperty=zE,p.memoize=zs,p.merge=K1,p.mergeWith=np,p.method=$E,p.methodOf=HE,p.mixin=wc,p.negate=$s,p.nthArg=BE,p.omit=G1,p.omitBy=W1,p.once=Vb,p.orderBy=Ob,p.over=kE,p.overArgs=Bb,p.overEvery=KE,p.overSome=GE,p.partial=fc,p.partialRight=Jf,p.partition=Tb,p.pick=J1,p.pickBy=sp,p.property=fp,p.propertyOf=WE,p.pull=Ow,p.pullAll=Mf,p.pullAllBy=Tw,p.pullAllWith=Aw,p.pullAt=Cw,p.range=JE,p.rangeRight=YE,p.rearg=kb,p.reject=Nb,p.remove=Nw,p.rest=Kb,p.reverse=uc,p.sampleSize=Db,p.set=X1,p.setWith=Q1,p.shuffle=Fb,p.slice=Lw,p.sortBy=Mb,p.sortedUniq=zw,p.sortedUniqBy=$w,p.split=bE,p.spread=Gb,p.tail=Hw,p.take=Vw,p.takeRight=Bw,p.takeRightWhile=kw,p.takeWhile=Kw,p.tap=ab,p.throttle=Wb,p.thru=qs,p.toArray=ep,p.toPairs=op,p.toPairsIn=ap,p.toPath=tx,p.toPlainObject=rp,p.transform=Z1,p.unary=Jb,p.union=Gw,p.unionBy=Ww,p.unionWith=Jw,p.uniq=Yw,p.uniqBy=Xw,p.uniqWith=Qw,p.unset=eE,p.unzip=hc,p.unzipWith=Uf,p.update=tE,p.updateWith=rE,p.values=Ai,p.valuesIn=iE,p.without=Zw,p.words=hp,p.wrap=Yb,p.xor=eb,p.xorBy=tb,p.xorWith=rb,p.zip=ib,p.zipObject=nb,p.zipObjectDeep=sb,p.zipWith=ob,p.entries=op,p.entriesIn=ap,p.extend=ip,p.extendWith=Bs,wc(p,p),p.add=ix,p.attempt=lp,p.camelCase=aE,p.capitalize=cp,p.ceil=nx,p.clamp=nE,p.clone=Qb,p.cloneDeep=e1,p.cloneDeepWith=t1,p.cloneWith=Zb,p.conformsTo=r1,p.deburr=up,p.defaultTo=jE,p.divide=sx,p.endsWith=cE,p.eq=kt,p.escape=uE,p.escapeRegExp=hE,p.every=vb,p.find=_b,p.findIndex=Df,p.findKey=N1,p.findLast=wb,p.findLastIndex=Ff,p.findLastKey=L1,p.floor=ox,p.forEach=$f,p.forEachRight=Hf,p.forIn=D1,p.forInRight=F1,p.forOwn=j1,p.forOwnRight=q1,p.get=gc,p.gt=i1,p.gte=n1,p.has=z1,p.hasIn=yc,p.head=qf,p.identity=_t,p.includes=Sb,p.indexOf=ww,p.inRange=sE,p.invoke=V1,p.isArguments=ri,p.isArray=ie,p.isArrayBuffer=s1,p.isArrayLike=vt,p.isArrayLikeObject=He,p.isBoolean=o1,p.isBuffer=Dr,p.isDate=a1,p.isElement=c1,p.isEmpty=u1,p.isEqual=h1,p.isEqualWith=l1,p.isError=pc,p.isFinite=f1,p.isFunction=lr,p.isInteger=Yf,p.isLength=Hs,p.isMap=Xf,p.isMatch=p1,p.isMatchWith=d1,p.isNaN=g1,p.isNative=y1,p.isNil=m1,p.isNull=v1,p.isNumber=Qf,p.isObject=je,p.isObjectLike=Me,p.isPlainObject=_n,p.isRegExp=dc,p.isSafeInteger=_1,p.isSet=Zf,p.isString=Vs,p.isSymbol=St,p.isTypedArray=Ti,p.isUndefined=w1,p.isWeakMap=b1,p.isWeakSet=E1,p.join=Sw,p.kebabCase=lE,p.last=qt,p.lastIndexOf=Pw,p.lowerCase=fE,p.lowerFirst=pE,p.lt=x1,p.lte=I1,p.max=ax,p.maxBy=cx,p.mean=ux,p.meanBy=hx,p.min=lx,p.minBy=fx,p.stubArray=Ec,p.stubFalse=xc,p.stubObject=XE,p.stubString=QE,p.stubTrue=ZE,p.multiply=px,p.nth=Rw,p.noConflict=VE,p.noop=bc,p.now=Us,p.pad=dE,p.padEnd=gE,p.padStart=yE,p.parseInt=vE,p.random=oE,p.reduce=Ab,p.reduceRight=Cb,p.repeat=mE,p.replace=_E,p.result=Y1,p.round=dx,p.runInContext=b,p.sample=Lb,p.size=jb,p.snakeCase=wE,p.some=qb,p.sortedIndex=Dw,p.sortedIndexBy=Fw,p.sortedIndexOf=jw,p.sortedLastIndex=qw,p.sortedLastIndexBy=Mw,p.sortedLastIndexOf=Uw,p.startCase=EE,p.startsWith=xE,p.subtract=gx,p.sum=yx,p.sumBy=vx,p.template=IE,p.times=ex,p.toFinite=fr,p.toInteger=se,p.toLength=tp,p.toLower=SE,p.toNumber=Mt,p.toSafeInteger=S1,p.toString=ge,p.toUpper=PE,p.trim=RE,p.trimEnd=OE,p.trimStart=TE,p.truncate=AE,p.unescape=CE,p.uniqueId=rx,p.upperCase=NE,p.upperFirst=vc,p.each=$f,p.eachRight=Hf,p.first=qf,wc(p,function(){var r={};return Gt(p,function(n,a){me.call(p.prototype,a)||(r[a]=n)}),r}(),{chain:!1}),p.VERSION=i,Nt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){p[r].placeholder=p}),Nt(["drop","take"],function(r,n){ue.prototype[r]=function(a){a=a===e?1:Qe(se(a),0);var u=this.__filtered__&&!n?new ue(this):this.clone();return u.__filtered__?u.__takeCount__=at(a,u.__takeCount__):u.__views__.push({size:at(a,ve),type:r+(u.__dir__<0?"Right":"")}),u},ue.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Nt(["filter","map","takeWhile"],function(r,n){var a=n+1,u=a==M||a==_e;ue.prototype[r]=function(l){var g=this.clone();return g.__iteratees__.push({iteratee:J(l,3),type:a}),g.__filtered__=g.__filtered__||u,g}}),Nt(["head","last"],function(r,n){var a="take"+(n?"Right":"");ue.prototype[r]=function(){return this[a](1).value()[0]}}),Nt(["initial","tail"],function(r,n){var a="drop"+(n?"":"Right");ue.prototype[r]=function(){return this.__filtered__?new ue(this):this[a](1)}}),ue.prototype.compact=function(){return this.filter(_t)},ue.prototype.find=function(r){return this.filter(r).head()},ue.prototype.findLast=function(r){return this.reverse().find(r)},ue.prototype.invokeMap=ae(function(r,n){return typeof r=="function"?new ue(this):this.map(function(a){return pn(a,r,n)})}),ue.prototype.reject=function(r){return this.filter($s(J(r)))},ue.prototype.slice=function(r,n){r=se(r);var a=this;return a.__filtered__&&(r>0||n<0)?new ue(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),n!==e&&(n=se(n),a=n<0?a.dropRight(-n):a.take(n-r)),a)},ue.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},ue.prototype.toArray=function(){return this.take(ve)},Gt(ue.prototype,function(r,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),u=/^(?:head|last)$/.test(n),l=p[u?"take"+(n=="last"?"Right":""):n],g=u||/^find/.test(n);l&&(p.prototype[n]=function(){var v=this.__wrapped__,_=u?[1]:arguments,E=v instanceof ue,D=_[0],F=E||ie(v),j=function(ce){var he=l.apply(p,Rr([ce],_));return u&&$?he[0]:he};F&&a&&typeof D=="function"&&D.length!=1&&(E=F=!1);var $=this.__chain__,G=!!this.__actions__.length,X=g&&!$,oe=E&&!G;if(!g&&F){v=oe?v:new ue(this);var Q=r.apply(v,_);return Q.__actions__.push({func:qs,args:[j],thisArg:e}),new Dt(Q,$)}return X&&oe?r.apply(this,_):(Q=this.thru(j),X?u?Q.value()[0]:Q.value():Q)})}),Nt(["pop","push","shift","sort","splice","unshift"],function(r){var n=us[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",u=/^(?:pop|shift)$/.test(r);p.prototype[r]=function(){var l=arguments;if(u&&!this.__chain__){var g=this.value();return n.apply(ie(g)?g:[],l)}return this[a](function(v){return n.apply(ie(v)?v:[],l)})}}),Gt(ue.prototype,function(r,n){var a=p[n];if(a){var u=a.name+"";me.call(Ii,u)||(Ii[u]=[]),Ii[u].push({name:n,func:a})}}),Ii[As(e,B).name]=[{name:"wrapper",func:e}],ue.prototype.clone=C_,ue.prototype.reverse=N_,ue.prototype.value=L_,p.prototype.at=cb,p.prototype.chain=ub,p.prototype.commit=hb,p.prototype.next=lb,p.prototype.plant=pb,p.prototype.reverse=db,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=gb,p.prototype.first=p.prototype.head,on&&(p.prototype[on]=fb),p},bi=h_();Wr?((Wr.exports=bi)._=bi,_a._=bi):rt._=bi}).call(es)})(xh,xh.exports);var X6=Object.defineProperty,Q6=Object.defineProperties,Z6=Object.getOwnPropertyDescriptors,Ev=Object.getOwnPropertySymbols,eT=Object.prototype.hasOwnProperty,tT=Object.prototype.propertyIsEnumerable,xv=(s,t,e)=>t in s?X6(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,Zo=(s,t)=>{for(var e in t||(t={}))eT.call(t,e)&&xv(s,e,t[e]);if(Ev)for(var e of Ev(t))tT.call(t,e)&&xv(s,e,t[e]);return s},rT=(s,t)=>Q6(s,Z6(t));function $t(s,t,e){let i,o=Ih(s);return t.rpcMap&&(i=t.rpcMap[o]),i||(i=`${Y6}?chainId=eip155:${o}&projectId=${e}`),i}function Ih(s){return s.includes("eip155")?Number(s.split(":")[1]):Number(s)}function Ov(s){return s.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function iT(s,t){let e=Object.keys(t.namespaces).filter(o=>o.includes(s));if(!e.length)return[];let i=[];return e.forEach(o=>{let c=t.namespaces[o].accounts;i.push(...c)}),i}function nT(s={},t={}){let e=Iv(s),i=Iv(t);return xh.exports.merge(e,i)}function Iv(s){var t,e,i,o;let c={};if(!Fi(s))return c;for(let[h,f]of Object.entries(s)){let y=Oc(h)?[h]:f.chains,d=f.methods||[],w=f.events||[],S=f.rpcMap||{},x=Di(h);c[x]=rT(Zo(Zo({},c[x]),f),{chains:Ys(y,(t=c[x])==null?void 0:t.chains),methods:Ys(d,(e=c[x])==null?void 0:e.methods),events:Ys(w,(i=c[x])==null?void 0:i.events),rpcMap:Zo(Zo({},S),(o=c[x])==null?void 0:o.rpcMap)})}return c}function sT(s){return s.includes(":")?s.split(":")[2]:s}function oT(s){let t={};for(let[e,i]of Object.entries(s)){let o=i.methods||[],c=i.events||[],h=i.accounts||[],f=Oc(e)?[e]:i.chains?i.chains:Ov(i.accounts);t[e]={chains:f,methods:o,events:c,accounts:h}}return t}function wh(s){return typeof s=="number"?s:s.includes("0x")?parseInt(s,16):s.includes(":")?Number(s.split(":")[1]):Number(s)}var Tv={},Be=s=>Tv[s],bh=(s,t)=>{Tv[s]=t},Sh=class{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Be("events"),this.client=Be("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(this.chainId=t,!this.httpProviders[t]){let i=e||$t(`${this.name}:${t}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,i)}this.events.emit(Gr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let t=this.namespace.accounts;return t?t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]:[]}createHttpProviders(){let t={};return this.namespace.chains.forEach(e=>{var i;t[e]=this.createHttpProvider(e,(i=this.namespace.rpcMap)==null?void 0:i[e])}),t}getHttpProvider(){let t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){let i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProvider(t,e){let i=e||$t(t,this.namespace);return typeof i>"u"?void 0:new zt(new di(i,Be("disableProviderPing")))}},Ph=class{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Be("events"),this.client=Be("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}request(t){return m(this,null,function*(){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return yield this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?yield this.client.request(t):this.getHttpProvider().request(t.request)})}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,e){let i=Ih(t);if(!this.httpProviders[i]){let o=e||$t(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,o)}this.chainId=i,this.events.emit(Gr.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,e){let i=e||$t(`${this.name}:${t}`,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new zt(new Zn(i,Be("disableProviderPing")))}setHttpProvider(t,e){let i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProviders(){let t={};return this.namespace.chains.forEach(e=>{var i;let o=Ih(e);t[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[e])}),t}getAccounts(){let t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(){let t=this.chainId,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}handleSwitchChain(t){return m(this,null,function*(){var e,i;let o=t.request.params?(e=t.request.params[0])==null?void 0:e.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;let c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))yield this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:o}]},chainId:(i=this.namespace.chains)==null?void 0:i[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null})}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}},Rh=class{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Be("events"),this.client=Be("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(!this.httpProviders[t]){let i=e||$t(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,i)}this.chainId=t,this.events.emit(Gr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){let t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let t={};return this.namespace.chains.forEach(e=>{var i;t[e]=this.createHttpProvider(e,(i=this.namespace.rpcMap)==null?void 0:i[e])}),t}getHttpProvider(){let t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){let i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProvider(t,e){let i=e||$t(t,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new zt(new di(i,Be("disableProviderPing")))}},Oh=class{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Be("events"),this.client=Be("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(this.chainId=t,!this.httpProviders[t]){let i=e||$t(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,i)}this.events.emit(Gr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let t={};return this.namespace.chains.forEach(e=>{var i;t[e]=this.createHttpProvider(e,(i=this.namespace.rpcMap)==null?void 0:i[e])}),t}getHttpProvider(){let t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){let i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProvider(t,e){let i=e||$t(t,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new zt(new di(i,Be("disableProviderPing")))}},Th=class{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Be("events"),this.client=Be("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(this.chainId=t,!this.httpProviders[t]){let i=e||this.getCardanoRPCUrl(t);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,i)}this.events.emit(Gr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let t={};return this.namespace.chains.forEach(e=>{let i=this.getCardanoRPCUrl(e);t[e]=this.createHttpProvider(e,i)}),t}getHttpProvider(){let t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}getCardanoRPCUrl(t){let e=this.namespace.rpcMap;if(e)return e[t]}setHttpProvider(t,e){let i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProvider(t,e){let i=e||this.getCardanoRPCUrl(t);return typeof i>"u"?void 0:new zt(new di(i,Be("disableProviderPing")))}},Ah=class{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Be("events"),this.client=Be("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(!this.httpProviders[t]){let i=e||$t(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,i)}this.chainId=t,this.events.emit(Gr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){let t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let t={};return this.namespace.chains.forEach(e=>{var i;t[e]=this.createHttpProvider(e,(i=this.namespace.rpcMap)==null?void 0:i[e])}),t}getHttpProvider(){let t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){let i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProvider(t,e){let i=e||$t(t,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new zt(new di(i,Be("disableProviderPing")))}},Ch=class{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Be("events"),this.client=Be("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(!this.httpProviders[t]){let i=e||$t(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,i)}this.chainId=t,this.events.emit(Gr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){let t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let t={};return this.namespace.chains.forEach(e=>{var i;t[e]=this.createHttpProvider(e,(i=this.namespace.rpcMap)==null?void 0:i[e])}),t}getHttpProvider(){let t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){let i=this.createHttpProvider(t,e);i&&(this.httpProviders[t]=i)}createHttpProvider(t,e){let i=e||$t(t,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new zt(new di(i,Be("disableProviderPing")))}},aT=Object.defineProperty,cT=Object.defineProperties,uT=Object.getOwnPropertyDescriptors,Sv=Object.getOwnPropertySymbols,hT=Object.prototype.hasOwnProperty,lT=Object.prototype.propertyIsEnumerable,Pv=(s,t,e)=>t in s?aT(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,ea=(s,t)=>{for(var e in t||(t={}))hT.call(t,e)&&Pv(s,e,t[e]);if(Sv)for(var e of Sv(t))lT.call(t,e)&&Pv(s,e,t[e]);return s},Eh=(s,t)=>cT(s,uT(t)),Nh=class s{constructor(t){this.events=new Rv.default,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:(0,ta.pino)((0,ta.getDefaultLoggerOptions)({level:t?.logger||wv})),this.disableProviderPing=t?.disableProviderPing||!1}static init(t){return m(this,null,function*(){let e=new s(t);return yield e.initialize(),e})}request(t,e){return m(this,null,function*(){let[i,o]=this.validateChain(e);if(!this.session)throw new Error("Please call connect() before request()");return yield this.getProvider(i).request({request:ea({},t),chainId:`${i}:${o}`,topic:this.session.topic})})}sendAsync(t,e,i){this.request(t,i).then(o=>e(null,o)).catch(o=>e(o,void 0))}enable(){return m(this,null,function*(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||(yield this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties})),yield this.requestAccounts()})}disconnect(){return m(this,null,function*(){var t;if(!this.session)throw new Error("Please call connect() before enable()");yield this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Ze("USER_DISCONNECTED")}),yield this.cleanup()})}connect(t){return m(this,null,function*(){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),yield this.cleanupPendingPairings(),!t.skipPairing)return yield this.pair(t.pairingTopic)})}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}removeListener(t,e){this.events.removeListener(t,e)}off(t,e){this.events.off(t,e)}get isWalletConnect(){return!0}pair(t){return m(this,null,function*(){this.shouldAbortPairingAttempt=!1;let e=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(e>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");let{uri:i,approval:o}=yield this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});i&&(this.uri=i,this.events.emit("display_uri",i)),yield o().then(c=>{this.session=c,this.namespaces||(this.namespaces=oT(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==mh)throw c;e++})}while(!this.session);return this.onConnect(),this.session})}setDefaultChain(t,e){try{if(!this.session)return;let[i,o]=this.validateChain(t);this.getProvider(i).setDefaultChain(o,e)}catch(i){if(!/Please call connect/.test(i.message))throw i}}cleanupPendingPairings(){return m(this,arguments,function*(t={}){this.logger.info("Cleaning up inactive pairings...");let e=this.client.pairing.getAll();if(gr(e)){for(let i of e)t.deletePairings?this.client.core.expirer.set(i.topic,0):yield this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${e.length}`)}})}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}checkStorage(){return m(this,null,function*(){if(this.namespaces=yield this.getFromStore("namespaces"),this.optionalNamespaces=(yield this.getFromStore("optionalNamespaces"))||{},this.client.session.length){let t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}})}initialize(){return m(this,null,function*(){this.logger.trace("Initialized"),yield this.createClient(),yield this.checkStorage(),this.registerEventListeners()})}createClient(){return m(this,null,function*(){this.client=this.providerOpts.client||(yield Yo.init({logger:this.providerOpts.logger||wv,relayUrl:this.providerOpts.relayUrl||G6,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name})),this.logger.trace("SignClient Initialized")})}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");let t=[...new Set(Object.keys(this.session.namespaces).map(e=>Di(e)))];bh("client",this.client),bh("events",this.events),bh("disableProviderPing",this.disableProviderPing),t.forEach(e=>{if(!this.session)return;let i=iT(e,this.session),o=Ov(i),c=nT(this.namespaces,this.optionalNamespaces),h=Eh(ea({},c[e]),{accounts:i,chains:o});switch(e){case"eip155":this.rpcProviders[e]=new Ph({namespace:h});break;case"solana":this.rpcProviders[e]=new Rh({namespace:h});break;case"cosmos":this.rpcProviders[e]=new Oh({namespace:h});break;case"polkadot":this.rpcProviders[e]=new Sh({namespace:h});break;case"cip34":this.rpcProviders[e]=new Th({namespace:h});break;case"elrond":this.rpcProviders[e]=new Ah({namespace:h});break;case"multiversx":this.rpcProviders[e]=new Ch({namespace:h});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{let{params:e}=t,{event:i}=e;if(i.name==="accountsChanged"){let o=i.data;o&&gr(o)&&this.events.emit("accountsChanged",o.map(sT))}else if(i.name==="chainChanged"){let o=e.chainId,c=e.event.data,h=Di(o),f=wh(o)!==wh(c)?`${h}:${wh(c)}`:o;this.onChainChanged(f)}else this.events.emit(i.name,i.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:e})=>{var i;let{namespaces:o}=e,c=(i=this.client)==null?void 0:i.session.get(t);this.session=Eh(ea({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:e})}),this.client.on("session_delete",t=>m(this,null,function*(){yield this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Eh(ea({},Ze("USER_DISCONNECTED")),{data:t.topic}))})),this.on(Gr.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var e;this.getProvider(t).updateNamespace((e=this.session)==null?void 0:e.namespaces[t])})}setNamespaces(t){let{namespaces:e,optionalNamespaces:i,sessionProperties:o}=t;e&&Object.keys(e).length&&(this.namespaces=e),i&&Object.keys(i).length&&(this.optionalNamespaces=i),this.sessionProperties=o,this.persist("namespaces",e),this.persist("optionalNamespaces",i)}validateChain(t){let[e,i]=t?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[e,i];if(e&&!Object.keys(this.namespaces||{}).map(h=>Di(h)).includes(e))throw new Error(`Namespace '${e}' is not configured. Please call connect() first with namespace config.`);if(e&&i)return[e,i];let o=Di(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}requestAccounts(){return m(this,null,function*(){let[t]=this.validateChain();return yield this.getProvider(t).requestAccounts()})}onChainChanged(t,e=!1){var i;if(!this.namespaces)return;let[o,c]=this.validateChain(t);e||this.getProvider(o).setDefaultChain(c),((i=this.namespaces[o])!=null?i:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}cleanup(){return m(this,null,function*(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),yield this.cleanupPendingPairings({deletePairings:!0})})}persist(t,e){this.client.core.storage.setItem(`${bv}/${t}`,e)}getFromStore(t){return m(this,null,function*(){return yield this.client.core.storage.getItem(`${bv}/${t}`)})}},Av=Nh;var fT="wc",pT="ethereum_provider",dT=`${fT}@2:${pT}:`,gT="https://rpc.walletconnect.com/v1/",Dh=["eth_sendTransaction","personal_sign"],yT=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Fh=["chainChanged","accountsChanged"],vT=["message","disconnect","connect"],mT=Object.defineProperty,_T=Object.defineProperties,wT=Object.getOwnPropertyDescriptors,Cv=Object.getOwnPropertySymbols,bT=Object.prototype.hasOwnProperty,ET=Object.prototype.propertyIsEnumerable,Nv=(s,t,e)=>t in s?mT(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,ts=(s,t)=>{for(var e in t||(t={}))bT.call(t,e)&&Nv(s,e,t[e]);if(Cv)for(var e of Cv(t))ET.call(t,e)&&Nv(s,e,t[e]);return s},Lv=(s,t)=>_T(s,wT(t));function ra(s){return Number(s[0].split(":")[1])}function Lh(s){return`0x${s.toString(16)}`}function xT(s){let{chains:t,optionalChains:e,methods:i,optionalMethods:o,events:c,optionalEvents:h,rpcMap:f}=s;if(!gr(t))throw new Error("Invalid chains");let y={chains:t,methods:i||Dh,events:c||Fh,rpcMap:ts({},t.length?{[ra(t)]:f[ra(t)]}:{})},d=c?.filter(T=>!Fh.includes(T)),w=i?.filter(T=>!Dh.includes(T));if(!e&&!h&&!o&&!(d!=null&&d.length)&&!(w!=null&&w.length))return{required:t.length?y:void 0};let S=d?.length&&w?.length||!e,x={chains:[...new Set(S?y.chains.concat(e||[]):e)],methods:[...new Set(y.methods.concat(o!=null&&o.length?o:yT))],events:[...new Set(y.events.concat(h||vT))],rpcMap:f};return{required:t.length?y:void 0,optional:e.length?x:void 0}}var jh=class s{constructor(){this.events=new Dv.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=dT,this.on=(t,e)=>(this.events.on(t,e),this),this.once=(t,e)=>(this.events.once(t,e),this),this.removeListener=(t,e)=>(this.events.removeListener(t,e),this),this.off=(t,e)=>(this.events.off(t,e),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static init(t){return m(this,null,function*(){let e=new s;return yield e.initialize(t),e})}request(t){return m(this,null,function*(){return yield this.signer.request(t,this.formatChainId(this.chainId))})}sendAsync(t,e){this.signer.sendAsync(t,e,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}enable(){return m(this,null,function*(){return this.session||(yield this.connect()),yield this.request({method:"eth_requestAccounts"})})}connect(t){return m(this,null,function*(){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);let{required:e,optional:i}=xT(this.rpc);try{let o=yield new Promise((h,f)=>m(this,null,function*(){var y;this.rpc.showQrModal&&((y=this.modal)==null||y.subscribeModal(d=>{!d.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),yield this.signer.connect(Lv(ts({namespaces:ts({},e&&{[this.namespace]:e})},i&&{optionalNamespaces:{[this.namespace]:i}}),{pairingTopic:t?.pairingTopic})).then(d=>{h(d)}).catch(d=>{f(new Error(d.message))})}));if(!o)return;let c=vp(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:Lh(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}})}disconnect(){return m(this,null,function*(){this.session&&(yield this.signer.disconnect()),this.reset()})}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{let{params:e}=t,{event:i}=e;i.name==="accountsChanged"?(this.accounts=this.parseAccounts(i.data),this.events.emit("accountsChanged",this.accounts)):i.name==="chainChanged"?this.setChainId(this.formatChainId(i.data)):this.events.emit(i.name,i.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{let e=parseInt(t);this.chainId=e,this.events.emit("chainChanged",Lh(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Lv(ts({},Ze("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var e,i;this.rpc.showQrModal&&((e=this.modal)==null||e.closeModal(),(i=this.modal)==null||i.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){let e=t.filter(i=>this.isCompatibleChainId(i)).map(i=>this.parseChainId(i));e.length&&(this.chainId=e[0],this.events.emit("chainChanged",Lh(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){let e=this.parseChainId(t);this.chainId=e,this.switchEthereumChain(e)}}parseAccountId(t){let[e,i,o]=t.split(":");return{chainId:`${e}:${i}`,address:o}}setAccounts(t){this.accounts=t.filter(e=>this.parseChainId(this.parseAccountId(e).chainId)===this.chainId).map(e=>this.parseAccountId(e).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var e,i;let o=(e=t?.chains)!=null?e:[],c=(i=t?.optionalChains)!=null?i:[],h=o.concat(c);if(!h.length)throw new Error("No chains specified in either `chains` or `optionalChains`");let f=o.length?t?.methods||Dh:[],y=o.length?t?.events||Fh:[],d=t?.optionalMethods||[],w=t?.optionalEvents||[],S=t?.rpcMap||this.buildRpcMap(h,t.projectId),x=t?.qrModalOptions||void 0;return{chains:o?.map(T=>this.formatChainId(T)),optionalChains:c.map(T=>this.formatChainId(T)),methods:f,events:y,optionalMethods:d,optionalEvents:w,rpcMap:S,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:x,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,e){let i={};return t.forEach(o=>{i[o]=this.getRpcUrl(o,e)}),i}initialize(t){return m(this,null,function*(){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?ra(this.rpc.chains):ra(this.rpc.optionalChains),this.signer=yield Av.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),yield this.loadPersistedSession(),this.rpc.showQrModal){let e;try{let{WalletConnectModal:i}=yield import("./chunk-5CY6XVBF.js");e=i}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(e)try{this.modal=new e(ts({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(i){throw this.signer.logger.error(i),new Error("Could not generate WalletConnectModal Instance")}}})}loadConnectOpts(t){if(!t)return;let{chains:e,optionalChains:i,rpcMap:o}=t;e&&gr(e)&&(this.rpc.chains=e.map(c=>this.formatChainId(c)),e.forEach(c=>{this.rpc.rpcMap[c]=o?.[c]||this.getRpcUrl(c)})),i&&gr(i)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=i?.map(c=>this.formatChainId(c)),i.forEach(c=>{this.rpc.rpcMap[c]=o?.[c]||this.getRpcUrl(c)}))}getRpcUrl(t,e){var i;return((i=this.rpc.rpcMap)==null?void 0:i[t])||`${gT}?chainId=eip155:${t}&projectId=${e||this.rpc.projectId}`}loadPersistedSession(){return m(this,null,function*(){if(!this.session)return;let t=yield this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),e=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:e?.accounts),this.setAccounts(e?.accounts)})}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(e=>this.parseAccount(e))}},qA=jh;export{qA as EthereumProvider,vT as OPTIONAL_EVENTS,yT as OPTIONAL_METHODS,Fh as REQUIRED_EVENTS,Dh as REQUIRED_METHODS,jh as default};
